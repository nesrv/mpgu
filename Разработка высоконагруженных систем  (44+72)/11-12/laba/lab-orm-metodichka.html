<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–∞–∫—Ç–∏–∫–∞: SQLAlchemy ORM —Å JSON</title>
    <style media="print">
        body { font-family: Arial, sans-serif; font-size: 12px; }
        .container { box-shadow: none; background: white; }
        .header { background: white !important; color: black !important; }
        .save-btn { display: none !important; }
        .section { page-break-inside: avoid; }
        input, textarea { border: 1px solid #ccc; background: white; color: black; }
        .code-block { background: white !important; color: black !important; border: 1px solid #ccc; }
    </style>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: white;
            margin-top: 20px;
            margin-bottom: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .header {
            text-align: center;
            padding: 30px 0;
            background: linear-gradient(135deg, #4A90E2 0%, #357ABD 100%);
            color: white;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .student-info {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #4A90E2;
        }

        .form-group input, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus, .form-group textarea:focus {
            outline: none;
            border-color: #4A90E2;
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
        }

        .form-group textarea {
            min-height: auto;
            resize: vertical;
        }

        .section textarea.code-textarea {
            min-height: 300px;
        }

        .code-textarea {
            font-family: 'Courier New', monospace;
            background: #2d3748;
            color: #e2e8f0;
            white-space: pre;
        }

        .section {
            margin-bottom: 40px;
            padding: 25px;
            background: #fff;
            border-left: 5px solid #4A90E2;
            border-radius: 0 10px 10px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .section h2 {
            color: #4A90E2;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .section h3 {
            color: #357ABD;
            margin: 20px 0 10px 0;
            font-size: 1.3em;
        }

        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            white-space: pre;
        }

        .code-block .keyword { color: #ff79c6; font-weight: bold; }
        .code-block .string { color: #f1fa8c; }
        .code-block .function { color: #50fa7b; }
        .code-block .class { color: #8be9fd; }
        .code-block .decorator { color: #ff79c6; }
        .code-block .comment { color: #6272a4; font-style: italic; }
        .code-block .number { color: #bd93f9; }
        .code-block .operator { color: #ff79c6; }

        .checkbox-item {
            margin: 15px 0;
            padding: 15px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .checkbox-item:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .checkbox-item input[type="checkbox"] {
            appearance: none;
            width: 24px;
            height: 24px;
            border: 3px solid white;
            border-radius: 6px;
            margin-right: 15px;
            cursor: pointer;
            position: relative;
            background: transparent;
            transition: all 0.3s;
        }

        .checkbox-item input[type="checkbox"]:checked {
            background: white;
        }

        .checkbox-item input[type="checkbox"]:checked::after {
            content: '‚úì';
            position: absolute;
            top: -2px;
            left: 4px;
            font-size: 18px;
            color: #667eea;
            font-weight: bold;
        }

        .checkbox-item label {
            color: white;
            font-weight: 500;
            cursor: pointer;
            user-select: none;
        }

        .save-btn {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 10px;
            cursor: pointer;
            display: block;
            margin: 30px auto;
            transition: transform 0.3s;
        }

        .save-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.3);
        }

        ul {
            list-style: none;
            padding-left: 0;
        }

        ul li {
            padding: 8px 0 8px 30px;
            position: relative;
        }

        ul li::before {
            content: '‚ñ∏';
            position: absolute;
            left: 0;
            color: #4A90E2;
            font-size: 18px;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .student-info {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üóÑÔ∏è –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞</h1>
            <h2>SQLAlchemy ORM —Å JSON</h2>
            <p>–†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö open-source –ø—Ä–æ–µ–∫—Ç–æ–≤</p>
        </div>

        <div class="student-info">
            <div class="form-group">
                <label for="student-name">–§–ò–û —Å—Ç—É–¥–µ–Ω—Ç–∞:</label>
                <input type="text" id="student-name" placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á">
            </div>
            <div class="form-group">
                <label for="group">–ì—Ä—É–ø–ø–∞:</label>
                <input type="text" id="group" placeholder="–ò–°–¢-401">
            </div>
            <div class="form-group">
                <label for="date">–î–∞—Ç–∞:</label>
                <input type="date" id="date">
            </div>
        </div>

        <div class="section">
            <h2>üìã –û–ø–∏—Å–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö</h2>
            
            <h3>–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ</h3>
            <p>–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è:</p>
            <ul>
                <li>–£—á–µ—Ç–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ open-source –ø—Ä–æ–µ–∫—Ç–æ–≤</li>
                <li>–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤</li>
                <li>–ê–Ω–∞–ª–∏–∑–∞ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤</li>
                <li>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ —è–∑—ã–∫–∞–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º</li>
                <li>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤–∫–ª–∞–¥–∞ –∫–∞–∂–¥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –≤ –ø—Ä–æ–µ–∫—Ç—ã</li>
            </ul>

            <h3>–¢–∞–±–ª–∏—Ü—ã</h3>
            
            <h4>contributors</h4>
            <p>–£—á–∞—Å—Ç–Ω–∏–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤</p>
            <ul>
                <li><strong>user_id</strong> (PK) - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä</li>
                <li><strong>username</strong> - –Ω–∏–∫–Ω–µ–π–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</li>
                <li><strong>full_name</strong> - –ø–æ–ª–Ω–æ–µ –∏–º—è</li>
            </ul>

            <h4>repositories</h4>
            <p>–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤</p>
            <ul>
                <li><strong>repo_id</strong> (PK) - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä</li>
                <li><strong>name</strong> - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è</li>
                <li><strong>description</strong> - –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞</li>
                <li><strong>stars</strong> - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–≤–µ–∑–¥</li>
                <li><strong>repo_metadata</strong> (JSON) - –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç–∞</li>
            </ul>

            <h4>contributions</h4>
            <p>–í–∫–ª–∞–¥—ã —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤ –ø—Ä–æ–µ–∫—Ç—ã (—Å–≤—è–∑—É—é—â–∞—è —Ç–∞–±–ª–∏—Ü–∞)</p>
            <ul>
                <li><strong>user_id</strong> (PK, FK) - —Å—Å—ã–ª–∫–∞ –Ω–∞ —É—á–∞—Å—Ç–Ω–∏–∫–∞</li>
                <li><strong>repo_id</strong> (PK, FK) - —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π</li>
                <li><strong>commits_count</strong> - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–º–∏—Ç–æ–≤</li>
                <li><strong>last_activity</strong> - –¥–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</li>
            </ul>

            <h3>–î–∏–∞–≥—Ä–∞–º–º–∞ —Å–≤—è–∑–µ–π</h3>
            <div class="code-block">contributors (1) ----< contributions >---- (1) repositories
    user_id              user_id, repo_id              repo_id</div>

            <h3>JSON –ø–æ–ª–µ repo_metadata</h3>
            <p>–°–æ–¥–µ—Ä–∂–∏—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–µ–∫—Ç–µ:</p>
            <div class="code-block">{
  <span class="string">"language"</span>: <span class="string">"Python"</span>,
  <span class="string">"framework"</span>: <span class="string">"FastAPI"</span>, 
  <span class="string">"tags"</span>: [<span class="string">"web"</span>, <span class="string">"api"</span>],
  <span class="string">"libraries"</span>: [<span class="string">"pandas"</span>, <span class="string">"sklearn"</span>],
  <span class="string">"difficulty"</span>: <span class="string">"beginner"</span>,
  <span class="string">"type"</span>: <span class="string">"library"</span>,
  <span class="string">"platforms"</span>: [<span class="string">"linux"</span>, <span class="string">"windows"</span>]
}</div>
        </div>

        <div class="section">
            <h2>üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –≤ –±–¥</h2>
            
            <div class="code-block"><span class="keyword">from</span> datetime <span class="keyword">import</span> date
<span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> create_engine, select, func, text, ForeignKey, JSON
<span class="keyword">from</span> sqlalchemy.orm <span class="keyword">import</span> DeclarativeBase, Mapped, mapped_column, Session

<span class="comment"># –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å</span>
<span class="keyword">class</span> <span class="class">Base</span>(<span class="class">DeclarativeBase</span>):
    <span class="keyword">pass</span>

<span class="comment"># –ú–æ–¥–µ–ª–∏</span>
<span class="keyword">class</span> <span class="class">Contributor</span>(<span class="class">Base</span>):
    __tablename__ = <span class="string">"contributors"</span>

    user_id: <span class="class">Mapped</span>[<span class="class">int</span>] = <span class="function">mapped_column</span>(primary_key=<span class="keyword">True</span>)
    username: <span class="class">Mapped</span>[<span class="class">str</span>]
    full_name: <span class="class">Mapped</span>[<span class="class">str</span>]


<span class="keyword">class</span> <span class="class">Repository</span>(<span class="class">Base</span>):
    __tablename__ = <span class="string">"repositories"</span>

    repo_id: <span class="class">Mapped</span>[<span class="class">int</span>] = <span class="function">mapped_column</span>(primary_key=<span class="keyword">True</span>)
    name: <span class="class">Mapped</span>[<span class="class">str</span>]
    description: <span class="class">Mapped</span>[<span class="class">str</span>]
    stars: <span class="class">Mapped</span>[<span class="class">int</span>]
    repo_metadata: <span class="class">Mapped</span>[<span class="class">dict</span>] = <span class="function">mapped_column</span>(<span class="class">JSON</span>)


<span class="keyword">class</span> <span class="class">Contribution</span>(<span class="class">Base</span>):
    __tablename__ = <span class="string">"contributions"</span>

    <span class="comment"># –°–æ—Å—Ç–∞–≤–Ω–æ–π PK: –¥–≤–∞ –≤–Ω–µ—à–Ω–∏—Ö –∫–ª—é—á–∞</span>
    user_id: <span class="class">Mapped</span>[<span class="class">int</span>] = <span class="function">mapped_column</span>(
        <span class="function">ForeignKey</span>(<span class="string">"contributors.user_id"</span>), primary_key=<span class="keyword">True</span>
    )
    repo_id: <span class="class">Mapped</span>[<span class="class">int</span>] = <span class="function">mapped_column</span>(
        <span class="function">ForeignKey</span>(<span class="string">"repositories.repo_id"</span>), primary_key=<span class="keyword">True</span>
    )

    commits_count: <span class="class">Mapped</span>[<span class="class">int</span>]
    last_activity: <span class="class">Mapped</span>[date]


<span class="comment"># –°–æ–∑–¥–∞–Ω–∏–µ –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ë–î</span>

engine = <span class="function">create_engine</span>(<span class="string">"postgresql://student:password@localhost:5435/students_db"</span>)
<span class="keyword">try</span>:
    <span class="class">Base</span>.metadata.<span class="function">drop_all</span>(engine)
<span class="keyword">except</span>:
    <span class="keyword">pass</span>
<span class="class">Base</span>.metadata.<span class="function">create_all</span>(engine)

<span class="keyword">with</span> <span class="function">Session</span>(engine) <span class="keyword">as</span> session:
    session.<span class="function">execute</span>(<span class="function">text</span>(<span class="string">"DELETE FROM contributions"</span>))
    session.<span class="function">execute</span>(<span class="function">text</span>(<span class="string">"DELETE FROM contributors"</span>))
    session.<span class="function">execute</span>(<span class="function">text</span>(<span class="string">"DELETE FROM repositories"</span>))
    session.<span class="function">commit</span>()

    <span class="comment"># –î–∞–Ω–Ω—ã–µ</span>
    contributors = [
        <span class="function">Contributor</span>(user_id=<span class="number">1</span>, username=<span class="string">"alice_dev"</span>, full_name=<span class="string">"–ê–ª–∏—Å–∞ –°–º–∏—Ä–Ω–æ–≤–∞"</span>),
        <span class="function">Contributor</span>(user_id=<span class="number">2</span>, username=<span class="string">"bob_code"</span>, full_name=<span class="string">"–ë–æ—Ä–∏—Å –ò–≤–∞–Ω–æ–≤"</span>),
        <span class="function">Contributor</span>(user_id=<span class="number">3</span>, username=<span class="string">"clara_python"</span>, full_name=<span class="string">"–ö–ª–∞—Ä–∞ –ü–µ—Ç—Ä–æ–≤–∞"</span>),
    ]

    repos = [
        <span class="function">Repository</span>(repo_id=<span class="number">101</span>, name=<span class="string">"–≤–µ–±-—à–∞–±–ª–æ–Ω"</span>, description=<span class="string">"–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å—Ç–∞—Ä—Ç–µ—Ä –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π"</span>, stars=<span class="number">1200</span>, repo_metadata={<span class="string">"language"</span>: <span class="string">"Python"</span>, <span class="string">"framework"</span>: <span class="string">"FastAPI"</span>, <span class="string">"tags"</span>: [<span class="string">"web"</span>, <span class="string">"api"</span>]}),
        <span class="function">Repository</span>(repo_id=<span class="number">102</span>, name=<span class="string">"–º–ª-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã"</span>, description=<span class="string">"–£—Ç–∏–ª–∏—Ç—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤"</span>, stars=<span class="number">870</span>, repo_metadata={<span class="string">"language"</span>: <span class="string">"Python"</span>, <span class="string">"libraries"</span>: [<span class="string">"pandas"</span>, <span class="string">"sklearn"</span>], <span class="string">"difficulty"</span>: <span class="string">"beginner"</span>}),
        <span class="function">Repository</span>(repo_id=<span class="number">103</span>, name=<span class="string">"–∫–æ–Ω—Å–æ–ª—å-–ª–æ–≥–≥–µ—Ä"</span>, description=<span class="string">"–ü—Ä–æ—Å—Ç–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è"</span>, stars=<span class="number">340</span>, repo_metadata={<span class="string">"language"</span>: <span class="string">"Go"</span>, <span class="string">"type"</span>: <span class="string">"library"</span>, <span class="string">"platforms"</span>: [<span class="string">"linux"</span>, <span class="string">"windows"</span>]}),
    ]

    contributions = [
        <span class="function">Contribution</span>(user_id=<span class="number">1</span>, repo_id=<span class="number">101</span>, commits_count=<span class="number">42</span>, last_activity=<span class="function">date</span>(<span class="number">2025</span>, <span class="number">10</span>, <span class="number">15</span>)),
        <span class="function">Contribution</span>(user_id=<span class="number">1</span>, repo_id=<span class="number">102</span>, commits_count=<span class="number">15</span>, last_activity=<span class="function">date</span>(<span class="number">2025</span>, <span class="number">9</span>, <span class="number">20</span>)),
        <span class="function">Contribution</span>(user_id=<span class="number">2</span>, repo_id=<span class="number">101</span>, commits_count=<span class="number">28</span>, last_activity=<span class="function">date</span>(<span class="number">2025</span>, <span class="number">11</span>, <span class="number">1</span>)),
        <span class="function">Contribution</span>(user_id=<span class="number">3</span>, repo_id=<span class="number">102</span>, commits_count=<span class="number">60</span>, last_activity=<span class="function">date</span>(<span class="number">2025</span>, <span class="number">11</span>, <span class="number">20</span>)),
        <span class="function">Contribution</span>(user_id=<span class="number">3</span>, repo_id=<span class="number">103</span>, commits_count=<span class="number">5</span>, last_activity=<span class="function">date</span>(<span class="number">2025</span>, <span class="number">8</span>, <span class="number">5</span>)),
    ]

    session.<span class="function">add_all</span>(contributors)
    session.<span class="function">add_all</span>(repos)
    session.<span class="function">commit</span>()
    
    session.<span class="function">add_all</span>(contributions)
    session.<span class="function">commit</span>()</div>
        </div>

        <div class="section">
            <h2>üìù –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏</h2>
            
            <h3>1. –ü—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞–Ω–∏—è –Ω–∞ SQLAlchemy 2.x</h3>
            
            <h4>1.1 –ù–∞–π—Ç–∏ –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</h4>
            <p><strong>SQL:</strong> SELECT username, full_name FROM contributors;</p>
            <div class="code-block"><span class="keyword">def</span> <span class="function">task_1_1</span>():
    <span class="keyword">with</span> <span class="function">Session</span>(engine) <span class="keyword">as</span> session:
        stmt = <span class="function">select</span>(<span class="class">Contributor</span>)
        <span class="keyword">for</span> contributor <span class="keyword">in</span> session.<span class="function">execute</span>(stmt).<span class="function">scalars</span>():
            <span class="function">print</span>(<span class="string">f"{contributor.username}: {contributor.full_name}"</span>)</div>
            
            <h4>1.2 –ù–∞–π—Ç–∏ –≤—Å–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–≤–µ–∑–¥ –±–æ–ª—å—à–µ 500</h4>
            <p><strong>SQL:</strong> SELECT name, stars FROM repositories WHERE stars > 500;</p>
            <div class="form-group">
                <label>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ:</label>
                <textarea class="code-textarea"></textarea>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="task1-2">
                <label for="task1-2">–ó–∞–¥–∞–Ω–∏–µ 1.2 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</label>
            </div>
            
            <h4>1.3 –ù–∞–π—Ç–∏ –≤—Å–µ –≤–∫–ª–∞–¥—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞</h4>
            <p><strong>SQL:</strong> SELECT user_id, commits_count FROM contributions WHERE user_id = 1;</p>
            <div class="form-group">
                <label>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ:</label>
                <textarea class="code-textarea"></textarea>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="task1-3">
                <label for="task1-3">–ó–∞–¥–∞–Ω–∏–µ 1.3 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</label>
            </div>
            
            <h4>1.4 –ü–æ–¥—Å—á–∏—Ç–∞—Ç—å –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</h4>
            <p><strong>SQL:</strong> SELECT COUNT(*) FROM contributors;</p>
            <div class="form-group">
                <label>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ:</label>
                <textarea class="code-textarea"></textarea>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="task1-4">
                <label for="task1-4">–ó–∞–¥–∞–Ω–∏–µ 1.4 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</label>
            </div>
            
            <h4>1.5 –ù–∞–π—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–≤–µ–∑–¥</h4>
            <p><strong>SQL:</strong> SELECT name, stars FROM repositories ORDER BY stars DESC LIMIT 1;</p>
            <div class="form-group">
                <label>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ:</label>
                <textarea class="code-textarea"></textarea>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="task1-5">
                <label for="task1-5">–ó–∞–¥–∞–Ω–∏–µ 1.5 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</label>
            </div>
        </div>

        <div class="section">
            <h2>2. –°—Ä–µ–¥–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è –Ω–∞ SQLAlchemy</h2>
            
            <h4>2.1 –ù–∞–π—Ç–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏ –∏—Ö –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–º–∏—Ç–æ–≤</h4>
            <p><strong>SQL:</strong> SELECT c.username, SUM(co.commits_count) as total FROM contributors c NATURAL JOIN contributions co GROUP BY c.user_id;</p>
            <div class="form-group">
                <label>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ:</label>
                <textarea class="code-textarea"></textarea>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="task2-1">
                <label for="task2-1">–ó–∞–¥–∞–Ω–∏–µ 2.1 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</label>
            </div>
            
            <h4>2.2 –ù–∞–π—Ç–∏ –≤—Å–µ Python –ø—Ä–æ–µ–∫—Ç—ã —á–µ—Ä–µ–∑ JSON</h4>
            <p><strong>SQL:</strong> SELECT name FROM repositories WHERE repo_metadata->>'language' = 'Python';</p>
            <div class="form-group">
                <label>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ:</label>
                <textarea class="code-textarea"></textarea>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="task2-2">
                <label for="task2-2">–ó–∞–¥–∞–Ω–∏–µ 2.2 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</label>
            </div>
            
            <h4>2.3 –ù–∞–π—Ç–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö —Å FastAPI</h4>
            <p><strong>SQL:</strong> SELECT c.full_name, r.name FROM contributions co NATURAL JOIN contributors c NATURAL JOIN repositories r WHERE r.repo_metadata->>'framework' = 'FastAPI';</p>
            <div class="form-group">
                <label>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ:</label>
                <textarea class="code-textarea"></textarea>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="task2-3">
                <label for="task2-3">–ó–∞–¥–∞–Ω–∏–µ 2.3 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</label>
            </div>
            
            <h4>2.4 –ü–æ–¥—Å—á–∏—Ç–∞—Ç—å –ø—Ä–æ–µ–∫—Ç—ã –ø–æ —è–∑—ã–∫–∞–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è</h4>
            <p><strong>SQL:</strong> SELECT repo_metadata->>'language' as language, COUNT(*) as count FROM repositories GROUP BY repo_metadata->>'language';</p>
            <div class="form-group">
                <label>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ:</label>
                <textarea class="code-textarea"></textarea>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="task2-4">
                <label for="task2-4">–ó–∞–¥–∞–Ω–∏–µ 2.4 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</label>
            </div>
            
            <h4>2.5 –ù–∞–π—Ç–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞</h4>
            <p><strong>SQL:</strong> SELECT DISTINCT c.full_name FROM contributors c NATURAL JOIN contributions co WHERE co.last_activity >= '2025-09-01';</p>
            <div class="form-group">
                <label>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ:</label>
                <textarea class="code-textarea"></textarea>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="task2-5">
                <label for="task2-5">–ó–∞–¥–∞–Ω–∏–µ 2.5 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</label>
            </div>
        </div>

        <div class="section">
            <h2>3. –°–ª–æ–∂–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è –Ω–∞ SQLAlchemy</h2>
            
            <h4>3.1 –ù–∞–π—Ç–∏ —Å–∞–º–æ–≥–æ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ —á–µ—Ä–µ–∑ –ø–æ–¥–∑–∞–ø—Ä–æ—Å</h4>
            <p><strong>SQL:</strong> SELECT c.full_name, s.total FROM contributors c NATURAL JOIN (SELECT user_id, SUM(commits_count) as total FROM contributions GROUP BY user_id) s ORDER BY s.total DESC LIMIT 1;</p>
            <div class="code-block"><span class="keyword">def</span> <span class="function">task_3_1</span>():
    <span class="keyword">with</span> <span class="function">Session</span>(engine) <span class="keyword">as</span> session:
        subq = (
            <span class="function">select</span>(
                <span class="class">Contribution</span>.user_id,
                func.<span class="function">sum</span>(<span class="class">Contribution</span>.commits_count).<span class="function">label</span>(<span class="string">'total'</span>)
            )
            .<span class="function">group_by</span>(<span class="class">Contribution</span>.user_id)
            .<span class="function">subquery</span>()
        )
        
        stmt = (
            <span class="function">select</span>(<span class="class">Contributor</span>.full_name, subq.c.total)
            .<span class="function">join</span>(subq)
            .<span class="function">order_by</span>(subq.c.total.<span class="function">desc</span>())
            .<span class="function">limit</span>(<span class="number">1</span>)
        )
        result = session.<span class="function">execute</span>(stmt).<span class="function">first</span>()
        <span class="function">print</span>(<span class="string">f"–°–∞–º—ã–π –∞–∫—Ç–∏–≤–Ω—ã–π: {result.full_name} ({result.total} –∫–æ–º–º–∏—Ç–æ–≤)"</span>)</div>
            
            <h4>3.2 –†–∞–Ω–∂–∏—Ä–æ–≤–∞—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø–æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å window —Ñ—É–Ω–∫—Ü–∏—è–º–∏</h4>
            <p><strong>SQL:</strong> SELECT c.full_name, SUM(co.commits_count) as total, RANK() OVER (ORDER BY SUM(co.commits_count) DESC) as rank FROM contributors c NATURAL JOIN contributions co GROUP BY c.user_id, c.full_name;</p>
            <div class="form-group">
                <label>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ:</label>
                <textarea class="code-textarea"></textarea>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="task3-2">
                <label for="task3-2">–ó–∞–¥–∞–Ω–∏–µ 3.2 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</label>
            </div>
            
            <h4>3.3 –ù–∞–π—Ç–∏ –ø—Ä–æ–µ–∫—Ç—ã —Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–π —á–µ—Ä–µ–∑ CTE</h4>
            <p><strong>SQL:</strong> WITH avg_commits AS (SELECT AVG(commits_count) as avg_commits FROM contributions) SELECT r.name, c.commits_count FROM repositories r NATURAL JOIN contributions c WHERE c.commits_count > (SELECT avg_commits FROM avg_commits);</p>
            <div class="form-group">
                <label>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ:</label>
                <textarea class="code-textarea"></textarea>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="task3-3">
                <label for="task3-3">–ó–∞–¥–∞–Ω–∏–µ 3.3 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</label>
            </div>
            
            <h4>3.4 –û–±–Ω–æ–≤–∏—Ç—å JSON –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ - –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–µ–≥</h4>
            <p><strong>SQL:</strong> UPDATE repositories SET repo_metadata = '{"language": "Python", "framework": "FastAPI", "tags": ["web", "api", "–æ–±–Ω–æ–≤–ª–µ–Ω–æ"]}' WHERE name = '–≤–µ–±-—à–∞–±–ª–æ–Ω';</p>
            <div class="form-group">
                <label>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ:</label>
                <textarea class="code-textarea"></textarea>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="task3-4">
                <label for="task3-4">–ó–∞–¥–∞–Ω–∏–µ 3.4 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</label>
            </div>
        </div>

        <div class="section">
            <h2>üìä –í—ã–≤–æ–¥—ã –ø–æ –∑–∞–Ω—è—Ç–∏—é</h2>

            <div class="form-group">
                <label>–ù–∞ –¥–∞–Ω–Ω–æ–º –∑–∞–Ω—è—Ç–∏–∏ –º—ã –∏–∑—É—á–∏–ª–∏:</label>
                <textarea rows="3">–ü–µ—Ä–µ—á–∏—Å–ª–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–º—ã...</textarea>
            </div>

            <div class="form-group">
                <label>–ß—Ç–æ –Ω–æ–≤–æ–≥–æ —É–∑–Ω–∞–ª(–∞):</label>
                <textarea rows="3">–û–ø–∏—à–∏—Ç–µ –Ω–æ–≤—ã–µ –∑–Ω–∞–Ω–∏—è...</textarea>
            </div>

            <div class="form-group">
                <label>–ß—Ç–æ –±—ã–ª–æ —Ç—Ä—É–¥–Ω–æ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è:</label>
                <textarea rows="3">–û–ø–∏—à–∏—Ç–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏...</textarea>
            </div>
        </div>

        <button class="save-btn" onclick="saveToPDF()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ PDF</button>
    </div>

    <script>
        function loadFromStorage() {
            document.getElementById('student-name').value = localStorage.getItem('student-name') || '';
            document.getElementById('group').value = localStorage.getItem('group') || '';
            document.getElementById('date').value = localStorage.getItem('date') || new Date().toISOString().split('T')[0];
            
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                if (localStorage.getItem(checkbox.id) === 'true') checkbox.checked = true;
            });
            
            document.querySelectorAll('textarea').forEach((textarea, index) => {
                const saved = localStorage.getItem('textarea-' + index);
                if (saved) textarea.value = saved;
            });
        }
        
        function saveToStorage() {
            localStorage.setItem('student-name', document.getElementById('student-name').value);
            localStorage.setItem('group', document.getElementById('group').value);
            localStorage.setItem('date', document.getElementById('date').value);
            
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                localStorage.setItem(checkbox.id, checkbox.checked);
            });
            
            document.querySelectorAll('textarea').forEach((textarea, index) => {
                localStorage.setItem('textarea-' + index, textarea.value);
            });
        }
        
        loadFromStorage();

        document.getElementById('student-name').addEventListener('input', saveToStorage);
        document.getElementById('group').addEventListener('input', saveToStorage);
        document.getElementById('date').addEventListener('change', saveToStorage);
        
        document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
            checkbox.addEventListener('change', saveToStorage);
        });

        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = textarea.scrollHeight + 'px';
        }

        function highlightPython(code) {
            let result = code
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;');
            
            result = result.replace(/(#.*$)/gm, '###COMMENT###$1###/COMMENT###');
            result = result.replace(/(['\"`])((?:\\\\.|(?!\\1)[^\\\\\\r\\n])*?)\\1/g, '###STRING###$&###/STRING###');
            result = result.replace(/\\b(from|import|def|class|return|if|else|elif|for|while|try|except|finally|with|as|and|or|not|in|is|True|False|None|async|await|raise|pass)\\b/g, '###KEYWORD###$1###/KEYWORD###');
            result = result.replace(/\\b(\\d+)\\b/g, '###NUMBER###$1###/NUMBER###');
            result = result.replace(/\\b(Session|Contributor|Repository|Contribution|Mapped|select|func|text|ForeignKey|JSON|date|engine|Base|DeclarativeBase|create_engine|mapped_column|int|str|dict)\\b/g, '###CLASS###$1###/CLASS###');
            result = result.replace(/\\b([a-zA-Z_][a-zA-Z0-9_]*)(?=\\s*\\()/g, '###FUNCTION###$1###/FUNCTION###');
            
            result = result.replace(/###COMMENT###/g, '<span class="comment">');
            result = result.replace(/###\\/COMMENT###/g, '</span>');
            result = result.replace(/###STRING###/g, '<span class="string">');
            result = result.replace(/###\\/STRING###/g, '</span>');
            result = result.replace(/###KEYWORD###/g, '<span class="keyword">');
            result = result.replace(/###\\/KEYWORD###/g, '</span>');
            result = result.replace(/###CLASS###/g, '<span class="class">');
            result = result.replace(/###\\/CLASS###/g, '</span>');
            result = result.replace(/###FUNCTION###/g, '<span class="function">');
            result = result.replace(/###\\/FUNCTION###/g, '</span>');
            result = result.replace(/###NUMBER###/g, '<span class="number">');
            result = result.replace(/###\\/NUMBER###/g, '</span>');
            
            return result;
        }

        document.querySelectorAll('.code-textarea').forEach(textarea => {
            const wrapper = document.createElement('div');
            wrapper.style.position = 'relative';
            textarea.parentNode.insertBefore(wrapper, textarea);
            wrapper.appendChild(textarea);

            const preview = document.createElement('div');
            preview.className = 'code-block';
            preview.style.display = 'none';
            preview.style.cursor = 'pointer';
            wrapper.appendChild(preview);

            textarea.addEventListener('input', function() {
                autoResize(this);
                saveToStorage();
            });

            textarea.addEventListener('blur', () => {
                saveToStorage();
                setTimeout(() => {
                    if (textarea.value.trim()) {
                        preview.innerHTML = highlightPython(textarea.value);
                        preview.style.display = 'block';
                        textarea.style.display = 'none';
                    }
                }, 200);
            });

            preview.addEventListener('click', () => {
                preview.style.display = 'none';
                textarea.style.display = 'block';
                textarea.focus();
            });
            
            if (textarea.value.trim()) {
                preview.innerHTML = highlightPython(textarea.value);
                preview.style.display = 'block';
                textarea.style.display = 'none';
            }

            autoResize(textarea);
        });

        document.querySelectorAll('textarea:not(.code-textarea)').forEach(textarea => {
            textarea.addEventListener('input', function() {
                autoResize(this);
                saveToStorage();
            });
            autoResize(textarea);
        });

        function saveToPDF() {
            const studentName = document.getElementById('student-name').value || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
            const group = document.getElementById('group').value || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
            const date = document.getElementById('date').value || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
            
            const originalTitle = document.title;
            document.title = `SQLAlchemy_ORM_${studentName}_${group}_${date}`;
            
            window.print();
            
            setTimeout(() => {
                document.title = originalTitle;
            }, 1000);
        }
    </script>
</body>
</html>
