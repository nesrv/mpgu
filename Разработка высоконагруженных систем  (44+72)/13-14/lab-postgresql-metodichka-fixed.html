<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–∞–∫—Ç–∏–∫–∞: PostgreSQL Views, Functions, Procedures</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/dracula.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/sql/sql.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/python/python.min.js"></script>
    <style media="print">
        body { font-family: Arial, sans-serif; font-size: 12px; }
        .container { box-shadow: none; background: white; }
        .header { background: white !important; color: black !important; }
        .save-btn { display: none !important; }
        .section { page-break-inside: avoid; }
        input, textarea { border: 1px solid #ccc; background: white; color: black; }
        .code-block { background: white !important; color: black !important; border: 1px solid #ccc; }
        .CodeMirror { display: none !important; }
        textarea { display: block !important; }
    </style>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: white;
            margin-top: 20px;
            margin-bottom: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .header {
            text-align: center;
            padding: 30px 0;
            background: linear-gradient(135deg, #4A90E2 0%, #357ABD 100%);
            color: white;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .student-info {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #4A90E2;
        }

        .form-group input, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus, .form-group textarea:focus {
            outline: none;
            border-color: #4A90E2;
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
        }

        .form-group textarea {
            min-height: auto;
            resize: vertical;
        }

        .CodeMirror {
            height: 300px;
            border-radius: 8px;
            font-size: 14px;
        }

        .section {
            margin-bottom: 40px;
            padding: 25px;
            background: #fff;
            border-left: 5px solid #4A90E2;
            border-radius: 0 10px 10px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .section h2 {
            color: #4A90E2;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .section h3 {
            color: #357ABD;
            margin: 20px 0 10px 0;
            font-size: 1.3em;
        }

        .section h4 {
            color: #555;
            margin: 15px 0 10px 0;
            font-size: 1.1em;
        }

        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            white-space: pre;
        }

        .code-block .keyword { color: #ff79c6; font-weight: bold; }
        .code-block .string { color: #f1fa8c; }
        .code-block .function { color: #50fa7b; }
        .code-block .class { color: #8be9fd; }
        .code-block .decorator { color: #ff79c6; }
        .code-block .comment { color: #6272a4; font-style: italic; }
        .code-block .number { color: #bd93f9; }
        .code-block .operator { color: #ff79c6; }

        .checkbox-item {
            margin: 15px 0;
            padding: 15px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .checkbox-item:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .checkbox-item input[type="checkbox"] {
            appearance: none;
            width: 24px;
            height: 24px;
            border: 3px solid white;
            border-radius: 6px;
            margin-right: 15px;
            cursor: pointer;
            position: relative;
            background: transparent;
            transition: all 0.3s;
        }

        .checkbox-item input[type="checkbox"]:checked {
            background: white;
        }

        .checkbox-item input[type="checkbox"]:checked::after {
            content: '‚úì';
            position: absolute;
            top: -2px;
            left: 4px;
            font-size: 18px;
            color: #667eea;
            font-weight: bold;
        }

        .checkbox-item label {
            color: white;
            font-weight: 500;
            cursor: pointer;
            user-select: none;
        }

        .save-btn {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 10px;
            cursor: pointer;
            display: block;
            margin: 30px auto;
            transition: transform 0.3s;
        }

        .save-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.3);
        }

        ul {
            list-style: none;
            padding-left: 0;
        }

        ul li {
            padding: 8px 0 8px 30px;
            position: relative;
        }

        ul li::before {
            content: '‚ñ∏';
            position: absolute;
            left: 0;
            color: #4A90E2;
            font-size: 18px;
            font-weight: bold;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        table th, table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }

        table th {
            background: #4A90E2;
            color: white;
        }

        table tr:nth-child(even) {
            background: #f8f9fa;
        }

        @media (max-width: 768px) {
            .student-info {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üóÑÔ∏è –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞</h1>
            <h2>PostgreSQL: Views, Functions, Procedures</h2>
            <p>–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Ä–∞–±–æ—Ç–∞ —Å PostgreSQL –≤ —Å—Ä–µ–¥–µ FastAPI</p>
        </div>

        <div class="student-info">
            <div class="form-group">
                <label for="student-name">–§–ò–û —Å—Ç—É–¥–µ–Ω—Ç–∞:</label>
                <input type="text" id="student-name" placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á">
            </div>
            <div class="form-group">
                <label for="group">–ì—Ä—É–ø–ø–∞:</label>
                <input type="text" id="group" placeholder="–ò–°–¢-401">
            </div>
            <div class="form-group">
                <label for="date">–î–∞—Ç–∞:</label>
                <input type="date" id="date">
            </div>
        </div>

        <div class="section">
            <h2>üéØ –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã</h2>
            <p>–ò–∑—É—á–∏—Ç—å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ PostgreSQL (Views, Materialized Views, Cursors, Functions, Procedures) –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∏—Ö —Å FastAPI —á–µ—Ä–µ–∑ SQLAlchemy –∏ raw SQL.</p>
            <p>–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ —É—Å–∫–æ—Ä–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –±—ç–∫–µ–Ω–¥–∞ –∑–∞ —Å—á–µ—Ç –ø–µ—Ä–µ–Ω–æ—Å–∞ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.</p>
            
            <h3>–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</h3>
            <p>4 –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏—Ö —á–∞—Å–∞</p>
            
            <h3>–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞</h3>
            <ul>
                <li>–ó–∞–ø—É—Å—Ç–∏—Ç–µ PostgreSQL –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ</li>
                <li>–°–æ–∑–¥–∞–π—Ç–µ –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –ë–î –∏–∑ seed_data.sql</li>
            </ul>
        </div>

        <div class="section">
            <h2>3. –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (Views)</h2>
            
            <h3>3.1 –°–æ–∑–¥–∞—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ active_students_view –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</h3>
            <div class="code-block"><span class="keyword">CREATE VIEW</span> active_students_view <span class="keyword">AS</span>
<span class="keyword">SELECT</span> 
    id,
    name,
    email,
    created_at
<span class="keyword">FROM</span> students
<span class="keyword">WHERE</span> status <span class="operator">=</span> <span class="string">'active'</span>;</div>

            <h3>3.2 –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ view top_students_view —Å —Ç–æ–ø-5 —Å—Ç—É–¥–µ–Ω—Ç–∞–º–∏ –ø–æ —Å—Ä–µ–¥–Ω–µ–º—É –±–∞–ª–ª—É</h3>
            <div class="form-group">
                <label>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ:</label>
                <textarea class="code-textarea" data-mode="sql"></textarea>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="task3-2">
                <label for="task3-2">–ó–∞–¥–∞–Ω–∏–µ 3.2 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</label>
            </div>

            <h3>3.3 –°–æ–∑–¥–∞–π—Ç–µ materialized view course_statistics_mv —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –ø–æ –∫–∞–∂–¥–æ–º—É –∫—É—Ä—Å—É</h3>
            <div class="form-group">
                <label>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ:</label>
                <textarea class="code-textarea" data-mode="sql"></textarea>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="task3-3">
                <label for="task3-3">–ó–∞–¥–∞–Ω–∏–µ 3.3 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</label>
            </div>
        </div>

        <div class="section">
            <h2>4. –ü—Ä–æ—Ü–µ–¥—É—Ä—ã (Procedures)</h2>
            
            <h3>4.2 –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—É add_grade –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ—Ü–µ–Ω–∫–∏ —Å—Ç—É–¥–µ–Ω—Ç—É –ø–æ –∫—É—Ä—Å—É</h3>
            <div class="form-group">
                <label>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ:</label>
                <textarea class="code-textarea" data-mode="sql"></textarea>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="task4-2">
                <label for="task4-2">–ó–∞–¥–∞–Ω–∏–µ 4.2 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</label>
            </div>

            <h3>4.3 –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—É delete_inactive_students –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –±–µ–∑ –æ—Ü–µ–Ω–æ–∫</h3>
            <div class="form-group">
                <label>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ:</label>
                <textarea class="code-textarea" data-mode="sql"></textarea>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="task4-3">
                <label for="task4-3">–ó–∞–¥–∞–Ω–∏–µ 4.3 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</label>
            </div>
        </div>

        <div class="section">
            <h2>5. –§—É–Ω–∫—Ü–∏–∏ (Functions)</h2>
            
            <h3>5.2 –°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é count_student_courses, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—É—Ä—Å–æ–≤ —Å—Ç—É–¥–µ–Ω—Ç–∞</h3>
            <div class="form-group">
                <label>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ:</label>
                <textarea class="code-textarea" data-mode="sql"></textarea>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="task5-2">
                <label for="task5-2">–ó–∞–¥–∞–Ω–∏–µ 5.2 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</label>
            </div>

            <h3>5.3 –°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é get_grade_status, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –æ—Ü–µ–Ω–∫–∏</h3>
            <div class="form-group">
                <label>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ:</label>
                <textarea class="code-textarea" data-mode="sql"></textarea>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="task5-3">
                <label for="task5-3">–ó–∞–¥–∞–Ω–∏–µ 5.3 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</label>
            </div>

            <h3>5.4 –°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é calculate_course_discount, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ü–µ–Ω—É –∫—É—Ä—Å–∞ —Å–æ —Å–∫–∏–¥–∫–æ–π</h3>
            <div class="form-group">
                <label>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ:</label>
                <textarea class="code-textarea" data-mode="sql"></textarea>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="task5-4">
                <label for="task5-4">–ó–∞–¥–∞–Ω–∏–µ 5.4 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</label>
            </div>

            <h3>5.5* –°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é get_course_students, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∫—É—Ä—Å–∞</h3>
            <div class="form-group">
                <label>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ:</label>
                <textarea class="code-textarea" data-mode="sql"></textarea>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="task5-5">
                <label for="task5-5">–ó–∞–¥–∞–Ω–∏–µ 5.5 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</label>
            </div>
        </div>

        <div class="section">
            <h2>–°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ - FastAPI —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã</h2>
            
            <h3>–≠–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è top_students_view</h3>
            <div class="form-group">
                <label>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ:</label>
                <textarea class="code-textarea" data-mode="python"></textarea>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="task-top-students">
                <label for="task-top-students">–≠–Ω–¥–ø–æ–∏–Ω—Ç top_students –≤—ã–ø–æ–ª–Ω–µ–Ω</label>
            </div>

            <h3>–≠–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è course_statistics_mv</h3>
            <div class="form-group">
                <label>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ:</label>
                <textarea class="code-textarea" data-mode="python"></textarea>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="task-course-stats">
                <label for="task-course-stats">–≠–Ω–¥–ø–æ–∏–Ω—Ç course_statistics –≤—ã–ø–æ–ª–Ω–µ–Ω</label>
            </div>

            <h3>–≠–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è add_student</h3>
            <div class="form-group">
                <label>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ:</label>
                <textarea class="code-textarea" data-mode="python"></textarea>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="task-add-student">
                <label for="task-add-student">–≠–Ω–¥–ø–æ–∏–Ω—Ç add_student –≤—ã–ø–æ–ª–Ω–µ–Ω</label>
            </div>
        </div>

        <div class="section">
            <h2>üìä –í—ã–≤–æ–¥—ã –ø–æ –∑–∞–Ω—è—Ç–∏—é</h2>
            <div class="form-group">
                <label>–ù–∞ –¥–∞–Ω–Ω–æ–º –∑–∞–Ω—è—Ç–∏–∏ –º—ã –∏–∑—É—á–∏–ª–∏:</label>
                <textarea rows="3">–ü–µ—Ä–µ—á–∏—Å–ª–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–º—ã...</textarea>
            </div>
            <div class="form-group">
                <label>–ß—Ç–æ –Ω–æ–≤–æ–≥–æ —É–∑–Ω–∞–ª(–∞):</label>
                <textarea rows="3">–û–ø–∏—à–∏—Ç–µ –Ω–æ–≤—ã–µ –∑–Ω–∞–Ω–∏—è...</textarea>
            </div>
            <div class="form-group">
                <label>–ß—Ç–æ –±—ã–ª–æ —Ç—Ä—É–¥–Ω–æ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è:</label>
                <textarea rows="3">–û–ø–∏—à–∏—Ç–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏...</textarea>
            </div>
        </div>

        <button class="save-btn" onclick="window.print()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ PDF</button>
    </div>

    <script>
        const editors = [];
        
        document.querySelectorAll('.code-textarea').forEach((textarea, index) => {
            const mode = textarea.dataset.mode || 'sql';
            const editor = CodeMirror.fromTextArea(textarea, {
                mode: mode === 'python' ? 'python' : 'text/x-sql',
                theme: 'dracula',
                lineNumbers: true,
                autoCloseBrackets: true,
                matchBrackets: true,
                indentUnit: 4,
                tabSize: 4,
                lineWrapping: true
            });
            
            editor.on('change', () => {
                localStorage.setItem('editor-' + index, editor.getValue());
            });
            
            const saved = localStorage.getItem('editor-' + index);
            if (saved) {
                editor.setValue(saved);
            }
            
            editors.push(editor);
        });

        document.getElementById('student-name').addEventListener('input', e => {
            localStorage.setItem('student-name', e.target.value);
        });
        document.getElementById('group').addEventListener('input', e => {
            localStorage.setItem('group', e.target.value);
        });
        document.getElementById('date').addEventListener('change', e => {
            localStorage.setItem('date', e.target.value);
        });

        document.getElementById('student-name').value = localStorage.getItem('student-name') || '';
        document.getElementById('group').value = localStorage.getItem('group') || '';
        document.getElementById('date').value = localStorage.getItem('date') || new Date().toISOString().split('T')[0];

        document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
            if (localStorage.getItem(checkbox.id) === 'true') checkbox.checked = true;
            checkbox.addEventListener('change', () => {
                localStorage.setItem(checkbox.id, checkbox.checked);
            });
        });
    </script>
</body>
</html>
