# –õ–µ–∫—Ü–∏—è: Apache Kafka. –ü–æ–ª–Ω—ã–π –∫—É—Ä—Å

## –ü–æ –∫–Ω–∏–≥–µ "Kafka: The Definitive Guide" (2-–µ –∏–∑–¥–∞–Ω–∏–µ)

## –ê–≤—Ç–æ—Ä—ã: –ì–≤–µ–Ω –®–∞–ø–∏—Ä–∞, –¢–æ–¥–¥ –ü–∞–ª–∏–Ω–æ, –†–∞–¥–∂–∏–Ω–∏ –°–∏–≤–∞—Ä–∞–º, –ö—Ä–∏—Ç –ü–µ—Ç—Ç–∏

**–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å:** –°–µ—Ä–æ–≤ –ù.–ï.  
**–î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞:** –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º  
**–û–±—â–µ–µ –≤—Ä–µ–º—è:** ~20 –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏—Ö —á–∞—Å–æ–≤ (10 –∑–∞–Ω—è—Ç–∏–π –ø–æ 2 —á–∞—Å–∞)

---

# –ó–∞–Ω—è—Ç–∏–µ 1: –í–≤–µ–¥–µ–Ω–∏–µ –≤ Kafka (2 —á–∞—Å–∞)

## –°–ª–∞–π–¥ 1: –¢–∏—Ç—É–ª—å–Ω—ã–π

# üöÄ Apache Kafka

## –ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö

### –ü–æ–ª–Ω—ã–π –∫—É—Ä—Å –ø–æ –∫–Ω–∏–≥–µ "Kafka: The Definitive Guide"

**–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å:** –°–µ—Ä–æ–≤ –ù.–ï.  
**–ú–ü–ì–£, 2025**

---

## –°–ª–∞–π–¥ 2: –û –∫–Ω–∏–≥–µ

### "Kafka: The Definitive Guide" (2-–µ –∏–∑–¥–∞–Ω–∏–µ)

**–ê–≤—Ç–æ—Ä—ã:**

- –ì–≤–µ–Ω –®–∞–ø–∏—Ä–∞ (Confluent)
- –¢–æ–¥–¥ –ü–∞–ª–∏–Ω–æ (LinkedIn)
- –†–∞–¥–∂–∏–Ω–∏ –°–∏–≤–∞—Ä–∞–º (Confluent)
- –ö—Ä–∏—Ç –ü–µ—Ç—Ç–∏ (Confluent)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**

- 14 –≥–ª–∞–≤
- –û—Ç –æ—Å–Ω–æ–≤ –¥–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö —Ç–µ–º
- –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã
- Production-ready –∑–Ω–∞–Ω–∏—è

**–î–ª—è –∫–æ–≥–æ:**

- –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä—ã
- DevOps –∏–Ω–∂–µ–Ω–µ—Ä—ã
- Data engineers

---

## –°–ª–∞–π–¥ 3: –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∫—É—Ä—Å–∞

### 10 –∑–∞–Ω—è—Ç–∏–π –ø–æ 2 —á–∞—Å–∞

1. **–ó–∞–Ω—è—Ç–∏–µ 1:** –í–≤–µ–¥–µ–Ω–∏–µ –≤ Kafka (–ì–ª–∞–≤—ã 1-2)
2. **–ó–∞–Ω—è—Ç–∏–µ 2:** –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (–ì–ª–∞–≤–∞ 2)
3. **–ó–∞–Ω—è—Ç–∏–µ 3:** Kafka Producers (–ì–ª–∞–≤–∞ 3)
4. **–ó–∞–Ω—è—Ç–∏–µ 4:** Kafka Consumers (–ì–ª–∞–≤–∞ 4)
5. **–ó–∞–Ω—è—Ç–∏–µ 5:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Kafka –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ (–ì–ª–∞–≤–∞ 5)
6. **–ó–∞–Ω—è—Ç–∏–µ 6:** –í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (–ì–ª–∞–≤–∞ 6)
7. **–ó–∞–Ω—è—Ç–∏–µ 7:** –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ —Å–µ–º–∞–Ω—Ç–∏–∫–∞ (–ì–ª–∞–≤—ã 7-8)
8. **–ó–∞–Ω—è—Ç–∏–µ 8:** Data Pipelines –∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è (–ì–ª–∞–≤—ã 9-10)
9. **–ó–∞–Ω—è—Ç–∏–µ 9:** –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ (–ì–ª–∞–≤—ã 11-12)
10. **–ó–∞–Ω—è—Ç–∏–µ 10:** –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ Stream Processing (–ì–ª–∞–≤—ã 13-14)

---

## –°–ª–∞–π–¥ 4: –ì–ª–∞–≤–∞ 1. –ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å Kafka

### –ß—Ç–æ —Ç–∞–∫–æ–µ Apache Kafka?

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:**
Apache Kafka ‚Äî —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ø–æ—Ç–æ–∫–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è –≤ LinkedIn.

**–ö–ª—é—á–µ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**

- –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å (–º–∏–ª–ª–∏–æ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫)
- –ù–∏–∑–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ (< 10ms)
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å (—Ç—ã—Å—è—á–∏ —Ç–æ–ø–∏–∫–æ–≤)
- –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å (—Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è)
- –î–æ–ª–≥–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

**–ê–Ω–∞–ª–æ–≥–∏—è:** –ö–∞–∫ –∂—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ë–î, –Ω–æ –¥–ª—è –≤—Å–µ–≥–æ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è!

---

## –°–ª–∞–π–¥ 5: –ò—Å—Ç–æ—Ä–∏—è Kafka

### –û—Ç LinkedIn –¥–æ Apache

**2009:** –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –≤ LinkedIn

- –ü—Ä–æ–±–ª–µ–º–∞: –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Å–∏—Å—Ç–µ–º
- –†–µ—à–µ–Ω–∏–µ: –µ–¥–∏–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –æ–±–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã–º–∏

**2011:** –û—Ç–∫—Ä—ã—Ç –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥

- –ü–µ—Ä–µ–¥–∞–Ω –≤ Apache Software Foundation

**2012:** Apache Kafka 0.8

- –°—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è production

**2017:** Apache Kafka 1.0

- –ó—Ä–µ–ª–æ—Å—Ç—å –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

**2020+:** Apache Kafka 2.x, 3.x

- Exactly-once semantics
- –£–ª—É—á—à–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- KIP (Kafka Improvement Proposals)

---

## –°–ª–∞–π–¥ 6: –ü–∞—Ç—Ç–µ—Ä–Ω –ø—É–±–ª–∏–∫–∞—Ü–∏—è/–ø–æ–¥–ø–∏—Å–∫–∞

### –ó–∞—á–µ–º –Ω—É–∂–µ–Ω pub/sub?

**–ü—Ä–æ–±–ª–µ–º–∞ –ø—Ä—è–º—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π:**

```
App1 ‚îÄ‚îÄ‚îê
App2 ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚Üí System1
App3 ‚îÄ‚îÄ‚îò    System2
            System3
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–∞—É—Ç–∏–Ω–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π! üò±

**–†–µ—à–µ–Ω–∏–µ —á–µ—Ä–µ–∑ pub/sub:**

```
App1 ‚îÄ‚îÄ‚îê
App2 ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚Üí [–ë—Ä–æ–∫–µ—Ä] ‚îÄ‚îÄ‚îê
App3 ‚îÄ‚îÄ‚îò                ‚îú‚îÄ‚îÄ‚Üí System1
                         ‚îú‚îÄ‚îÄ‚Üí System2
                         ‚îî‚îÄ‚îÄ‚Üí System3
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∏–∑–¥–∞—Ç–µ–ª–µ–π –∏ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã—Ö –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

![–≠–≤–æ–ª—é—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã](image/lect/1768492210683.png)

---

## –°–ª–∞–π–¥ 7: –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ Kafka

### –ë–∞–∑–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã

1. **–°–æ–æ–±—â–µ–Ω–∏–µ (Message)** ‚Äî –µ–¥–∏–Ω–∏—Ü–∞ –¥–∞–Ω–Ω—ã—Ö
2. **–¢–æ–ø–∏–∫ (Topic)** ‚Äî –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
3. **–†–∞–∑–¥–µ–ª (Partition)** ‚Äî —á–∞—Å—Ç—å —Ç–æ–ø–∏–∫–∞
4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å (Producer)** ‚Äî —Å–æ–∑–¥–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
5. **–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å (Consumer)** ‚Äî —á–∏—Ç–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
6. **–ë—Ä–æ–∫–µ—Ä (Broker)** ‚Äî —Å–µ—Ä–≤–µ—Ä Kafka
7. **–ö–ª–∞—Å—Ç–µ—Ä (Cluster)** ‚Äî –≥—Ä—É–ø–ø–∞ –±—Ä–æ–∫–µ—Ä–æ–≤
8. **Consumer Group** ‚Äî –≥—Ä—É–ø–ø–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π

**–ê–Ω–∞–ª–æ–≥–∏—è:** –¢–æ–ø–∏–∫ = –≥–∞–∑–µ—Ç–∞, –†–∞–∑–¥–µ–ª = —Å—Ç—Ä–∞–Ω–∏—Ü–∞, –°–æ–æ–±—â–µ–Ω–∏–µ = —Å—Ç–∞—Ç—å—è

---

## –°–ª–∞–π–¥ 8: –°–æ–æ–±—â–µ–Ω–∏—è –∏ –ø–∞–∫–µ—Ç—ã

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Key    ‚îÇ  Value   ‚îÇ  Metadata   ‚îÇ
‚îÇ (–±–∞–π—Ç—ã) ‚îÇ (–±–∞–π—Ç—ã)  ‚îÇ (offset, ts)‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**

- **Value** ‚Äî –¥–∞–Ω–Ω—ã–µ (–ª—é–±–æ–π —Ñ–æ—Ä–º–∞—Ç)
- **Key** ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–ª—é—á –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏
- **Metadata** ‚Äî offset, timestamp, headers

**–ü–∞–∫–µ—Ç—ã (Batches):**

- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –ö–æ–º–ø—Ä–æ–º–∏—Å—Å: –∑–∞–¥–µ—Ä–∂–∫–∞ vs throughput
- –°–∂–∞—Ç–∏–µ –ø–∞–∫–µ—Ç–æ–≤

---

## –°–ª–∞–π–¥ 9: –¢–æ–ø–∏–∫–∏ –∏ —Ä–∞–∑–¥–µ–ª—ã

### –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

**–¢–æ–ø–∏–∫:**

- –ò–º–µ–Ω–æ–≤–∞–Ω–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
- –ê–Ω–∞–ª–æ–≥–∏—è: —Ç–∞–±–ª–∏—Ü–∞ –≤ –ë–î

**–†–∞–∑–¥–µ–ª:**

- –£–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–π
- –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º
- –ü–æ—Ä—è–¥–æ–∫ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω —Ç–æ–ª—å–∫–æ –≤ —Ä–∞–∑–¥–µ–ª–µ

```
–¢–æ–ø–∏–∫: user-events
‚îú‚îÄ‚îÄ –†–∞–∑–¥–µ–ª 0: [msg1, msg2, ...]
‚îú‚îÄ‚îÄ –†–∞–∑–¥–µ–ª 1: [msg3, msg4, ...]
‚îú‚îÄ‚îÄ –†–∞–∑–¥–µ–ª 2: [msg5, msg6, ...]
‚îî‚îÄ‚îÄ –†–∞–∑–¥–µ–ª 3: [msg7, msg8, ...]
```

![–¢–æ–ø–∏–∫ —Å —Ä–∞–∑–¥–µ–ª–∞–º–∏](image/lect/1768492879379.png)

---

## –°–ª–∞–π–¥ 10: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–∏ –∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏

### –ö—Ç–æ —Å–æ–∑–¥–∞–µ—Ç –∏ —á–∏—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ

**Producer (–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å):**

- –°–æ–∑–¥–∞–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
- –í—ã–±–∏—Ä–∞–µ—Ç —Ç–æ–ø–∏–∫ –∏ —Ä–∞–∑–¥–µ–ª (—á–µ—Ä–µ–∑ –∫–ª—é—á)
- –ú–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–π Partitioner

**Consumer (–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å):**

- –ß–∏—Ç–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ —Ç–æ–ø–∏–∫–æ–≤
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç offset (–ø–æ–∑–∏—Ü–∏—é)
- –ú–æ–∂–µ—Ç –ø–µ—Ä–µ—á–∏—Ç—ã–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è

**Consumer Group:**

- –ì—Ä—É–ø–ø–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤–º–µ—Å—Ç–µ
- –ö–∞–∂–¥—ã–π —Ä–∞–∑–¥–µ–ª —á–∏—Ç–∞–µ—Ç—Å—è –æ–¥–Ω–∏–º –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–º –≥—Ä—É–ø–ø—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞

---

## –°–ª–∞–π–¥ 11: –ë—Ä–æ–∫–µ—Ä—ã –∏ –∫–ª–∞—Å—Ç–µ—Ä

### –°–µ—Ä–≤–µ—Ä—ã Kafka

**–ë—Ä–æ–∫–µ—Ä:**

- –°–µ—Ä–≤–µ—Ä, —Ö—Ä–∞–Ω—è—â–∏–π –¥–∞–Ω–Ω—ã–µ
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã
- –£–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–∞–∑–¥–µ–ª–∞–º–∏

**–ö–ª–∞—Å—Ç–µ—Ä:**

- –ù–µ—Å–∫–æ–ª—å–∫–æ –±—Ä–æ–∫–µ—Ä–æ–≤
- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

**–†–µ–ø–ª–∏–∫–∞—Ü–∏—è:**

- –ö–æ–ø–∏–∏ —Ä–∞–∑–¥–µ–ª–æ–≤ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –±—Ä–æ–∫–µ—Ä–∞—Ö
- Leader –∏ Followers
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π failover

**–ú–∏–Ω–∏–º—É–º:** 1 –±—Ä–æ–∫–µ—Ä (dev)  
**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:** 3+ –±—Ä–æ–∫–µ—Ä–∞ (production)

---

## –°–ª–∞–π–¥ 12: –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Kafka?

1. **–ú–µ—Ç—Ä–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**

   - –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –æ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**

   - –ê–≥—Ä–µ–≥–∞—Ü–∏—è –ª–æ–≥–æ–≤
   - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ

3. **Event Sourcing**

   - –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –≤–º–µ—Å—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

4. **–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã**

   - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Å–≤—è–∑—å –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏

5. **–ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**

   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

6. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º**
   - –°–≤—è–∑—å legacy –∏ –Ω–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º

---

## –°–ª–∞–π–¥ 13: –ì–ª–∞–≤–∞ 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Kafka

### –°–ø–æ—Å–æ–±—ã —É—Å—Ç–∞–Ω–æ–≤–∫–∏

**1. –°–∫–∞—á–∞—Ç—å –±–∏–Ω–∞—Ä–Ω–∏–∫–∏:**

```bash
wget https://downloads.apache.org/kafka/...
tar -xzf kafka_2.13-3.5.0.tgz
cd kafka_2.13-3.5.0
```

**2. Docker:**

```bash
docker run -p 9092:9092 apache/kafka:latest
```

**3. Docker Compose:**

```yaml
services:
  zookeeper:
    image: confluentinc/cp-zookeeper
  kafka:
    image: confluentinc/cp-kafka
```

**4. Managed —Å–µ—Ä–≤–∏—Å—ã:**

- Confluent Cloud
- AWS MSK
- Azure Event Hubs

---

## –°–ª–∞–π–¥ 14: –ó–∞–ø—É—Å–∫ Kafka

### –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã

**–ó–∞–ø—É—Å–∫ Zookeeper:**

```bash
bin/zookeeper-server-start.sh config/zookeeper.properties
```

**–ó–∞–ø—É—Å–∫ Kafka:**

```bash
bin/kafka-server-start.sh config/server.properties
```

**–°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–ø–∏–∫–∞:**

```bash
bin/kafka-topics.sh --create \
  --topic my-topic \
  --partitions 3 \
  --replication-factor 2 \
  --bootstrap-server localhost:9092
```

**–°–ø–∏—Å–æ–∫ —Ç–æ–ø–∏–∫–æ–≤:**

```bash
bin/kafka-topics.sh --list \
  --bootstrap-server localhost:9092
```

---

## –°–ª–∞–π–¥ 15: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Kafka

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

**server.properties:**

```properties
# –ë–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
broker.id=1
listeners=PLAINTEXT://localhost:9092
log.dirs=/tmp/kafka-logs

# –†–∞–∑–¥–µ–ª—ã –∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è
num.partitions=3
default.replication.factor=2

# –•—Ä–∞–Ω–µ–Ω–∏–µ
log.retention.hours=168  # 7 –¥–Ω–µ–π
log.segment.bytes=1073741824  # 1GB

# –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
num.network.threads=8
num.io.threads=8
```

**–í–∞–∂–Ω–æ:** –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –Ω–∞–≥—Ä—É–∑–∫–∏!

---

# –ó–∞–Ω—è—Ç–∏–µ 2: Kafka Producers (2 —á–∞—Å–∞)

## –°–ª–∞–π–¥ 16: –ì–ª–∞–≤–∞ 3. Kafka Producers

### –ù–∞–ø–∏—Å–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ Kafka

**–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ Producer:**

1. –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
2. –í—ã–±–æ—Ä —Ç–æ–ø–∏–∫–∞ –∏ —Ä–∞–∑–¥–µ–ª–∞
3. –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
5. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä (Java):**

```java
Properties props = new Properties();
props.put("bootstrap.servers", "localhost:9092");
props.put("key.serializer", "org.apache.kafka.common.serialization.StringSerializer");
props.put("value.serializer", "org.apache.kafka.common.serialization.StringSerializer");

Producer<String, String> producer = new KafkaProducer<>(props);
ProducerRecord<String, String> record =
    new ProducerRecord<>("my-topic", "key", "value");
producer.send(record);
producer.close();
```

---

## –°–ª–∞–π–¥ 17: Producer - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –í–∞–∂–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ:**

- `bootstrap.servers` ‚Äî —Å–ø–∏—Å–æ–∫ –±—Ä–æ–∫–µ—Ä–æ–≤
- `key.serializer` ‚Äî —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä –∫–ª—é—á–∞
- `value.serializer` ‚Äî —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä –∑–Ω–∞—á–µ–Ω–∏—è

**–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:**

- `acks` ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (0, 1, all)
- `retries` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–æ–≤
- `max.in.flight.requests.per.connection` ‚Äî –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**

- `batch.size` ‚Äî —Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞
- `linger.ms` ‚Äî –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
- `compression.type` ‚Äî —Ç–∏–ø —Å–∂–∞—Ç–∏—è (gzip, snappy, lz4)

---

## –°–ª–∞–π–¥ 18: Producer - –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π

### –¢—Ä–∏ —Å–ø–æ—Å–æ–±–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏

**1. Fire-and-forget:**

```java
producer.send(record);  // –ù–µ –∂–¥–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
```

**2. –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞:**

```java
Future<RecordMetadata> future = producer.send(record);
RecordMetadata metadata = future.get();  // –ë–ª–æ–∫–∏—Ä—É—é—â–∏–π –≤—ã–∑–æ–≤
```

**3. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞:**

```java
producer.send(record, new Callback() {
    @Override
    public void onCompletion(RecordMetadata metadata, Exception e) {
        if (e != null) {
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏
        } else {
            // –£—Å–ø–µ—à–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
        }
    }
});
```

---

## –°–ª–∞–π–¥ 19: Producer - –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è

### –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –±–∞–π—Ç—ã

**–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã:**

- `StringSerializer`
- `ByteArraySerializer`
- `IntegerSerializer`
- `LongSerializer`

**–ö–∞—Å—Ç–æ–º–Ω—ã–π —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä:**

```java
public class UserSerializer implements Serializer<User> {
    @Override
    public byte[] serialize(String topic, User user) {
        // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ User –≤ –±–∞–π—Ç—ã
        return jsonMapper.writeValueAsBytes(user);
    }
}
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Schema Registry –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ö–µ–º–∞–º–∏!

---

## –°–ª–∞–π–¥ 20: Producer - –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º

**–ë–µ–∑ –∫–ª—é—á–∞:**

- Round-robin –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º
- –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

**–° –∫–ª—é—á–æ–º:**

- Hash(key) % –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—Ä–∞–∑–¥–µ–ª–æ–≤
- –°–æ–æ–±—â–µ–Ω–∏—è —Å –æ–¥–Ω–∏–º –∫–ª—é—á–æ–º ‚Üí –æ–¥–∏–Ω —Ä–∞–∑–¥–µ–ª

**–ö–∞—Å—Ç–æ–º–Ω—ã–π Partitioner:**

```java
public class CustomPartitioner implements Partitioner {
    @Override
    public int partition(String topic, Object key, byte[] keyBytes,
                        Object value, byte[] valueBytes, Cluster cluster) {
        // –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ —Ä–∞–∑–¥–µ–ª–∞
        return partitionNumber;
    }
}
```

---

## –°–ª–∞–π–¥ 21: Producer - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –¢–∏–ø—ã –æ—à–∏–±–æ–∫

**1. Retriable (–º–æ–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å):**

- Leader not available
- Network errors
- Not enough replicas

**2. Non-retriable (–Ω–µ–ª—å–∑—è –ø–æ–≤—Ç–æ—Ä–∏—Ç—å):**

- Invalid topic
- Message too large
- Authentication errors

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ retries:**

```java
props.put("retries", 3);
props.put("retry.backoff.ms", 100);
props.put("max.in.flight.requests.per.connection", 1);  // –î–ª—è –ø–æ—Ä—è–¥–∫–∞
```

**–í–∞–∂–Ω–æ:** –ü—Ä–∏ retries –º–æ–∂–µ—Ç –Ω–∞—Ä—É—à–∏—Ç—å—Å—è –ø–æ—Ä—è–¥–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π!

---

## –°–ª–∞–π–¥ 22: Producer - –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å

### Exactly-once semantics

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ retries —Å–æ–æ–±—â–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –¥–≤–∞–∂–¥—ã

**–†–µ—à–µ–Ω–∏–µ:** –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–π Producer

```java
props.put("enable.idempotence", true);
props.put("acks", "all");
props.put("retries", Integer.MAX_VALUE);
props.put("max.in.flight.requests.per.connection", 5);
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

- Producer ID (PID) + Sequence Number
- –ë—Ä–æ–∫–µ—Ä –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –î—É–±–ª–∏–∫–∞—Ç—ã –æ—Ç–∫–ª–æ–Ω—è—é—Ç—Å—è

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑!

---

## –°–ª–∞–π–¥ 23: Producer - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

### –£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ü–∞–∫–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**

```java
props.put("batch.size", 16384);  // 16KB
props.put("linger.ms", 10);  // –ñ–¥–∞—Ç—å 10ms –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø–∞–∫–µ—Ç–∞
```

**–°–∂–∞—Ç–∏–µ:**

```java
props.put("compression.type", "snappy");  // –∏–ª–∏ gzip, lz4
```

**–ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è:**

```java
props.put("buffer.memory", 33554432);  // 32MB
```

**–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º:**

```java
props.put("max.in.flight.requests.per.connection", 5);
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£–≤–µ–ª–∏—á–µ–Ω–∏–µ throughput –≤ 10-100 —Ä–∞–∑!

---

# –ó–∞–Ω—è—Ç–∏–µ 3: Kafka Consumers (2 —á–∞—Å–∞)

## –°–ª–∞–π–¥ 24: –ì–ª–∞–≤–∞ 4. Kafka Consumers

### –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Kafka

**–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ Consumer:**

1. –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ç–æ–ø–∏–∫–∏
2. –ß—Ç–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
3. –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ offset
4. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
5. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø–∞–º–∏

**–ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä (Java):**

```java
Properties props = new Properties();
props.put("bootstrap.servers", "localhost:9092");
props.put("group.id", "my-group");
props.put("key.deserializer", "org.apache.kafka.common.serialization.StringDeserializer");
props.put("value.deserializer", "org.apache.kafka.common.serialization.StringDeserializer");

Consumer<String, String> consumer = new KafkaConsumer<>(props);
consumer.subscribe(Arrays.asList("my-topic"));

while (true) {
    ConsumerRecords<String, String> records = consumer.poll(Duration.ofMillis(100));
    for (ConsumerRecord<String, String> record : records) {
        System.out.println(record.value());
    }
}
```

---

## –°–ª–∞–π–¥ 25: Consumer - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –í–∞–∂–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ:**

- `bootstrap.servers` ‚Äî —Å–ø–∏—Å–æ–∫ –±—Ä–æ–∫–µ—Ä–æ–≤
- `group.id` ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≥—Ä—É–ø–ø—ã
- `key.deserializer` ‚Äî –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä –∫–ª—é—á–∞
- `value.deserializer` ‚Äî –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä –∑–Ω–∞—á–µ–Ω–∏—è

**Offset management:**

- `auto.offset.reset` ‚Äî earliest, latest, none
- `enable.auto.commit` ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π commit
- `auto.commit.interval.ms` ‚Äî –∏–Ω—Ç–µ—Ä–≤–∞–ª commit

**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**

- `fetch.min.bytes` ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä fetch
- `fetch.max.wait.ms` ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è
- `max.partition.fetch.bytes` ‚Äî —Ä–∞–∑–º–µ—Ä fetch –¥–ª—è —Ä–∞–∑–¥–µ–ª–∞

---

## –°–ª–∞–π–¥ 26: Consumer - –ü–æ–¥–ø–∏—Å–∫–∞

### –°–ø–æ—Å–æ–±—ã –ø–æ–¥–ø–∏—Å–∫–∏

**1. –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ç–æ–ø–∏–∫–∏:**

```java
consumer.subscribe(Arrays.asList("topic1", "topic2"));
```

**2. –ü–æ–¥–ø–∏—Å–∫–∞ —Å –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º:**

```java
consumer.subscribe(Pattern.compile("user-.*"));
```

**3. –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–æ–≤ –≤—Ä—É—á–Ω—É—é:**

```java
TopicPartition partition = new TopicPartition("my-topic", 0);
consumer.assign(Arrays.asList(partition));
```

**–†–∞–∑–Ω–∏—Ü–∞:**

- `subscribe()` ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞
- `assign()` ‚Äî —Ä—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –±–µ–∑ –≥—Ä—É–ø–ø

---

## –°–ª–∞–π–¥ 27: Consumer - Polling

### –ß—Ç–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

**Polling —Ü–∏–∫–ª:**

```java
while (true) {
    ConsumerRecords<String, String> records = consumer.poll(Duration.ofMillis(100));

    for (ConsumerRecord<String, String> record : records) {
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
        processRecord(record);
    }

    // Commit –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
    consumer.commitSync();
}
```

**–í–∞–∂–Ω–æ:**

- Poll –¥–æ–ª–∂–µ–Ω –≤—ã–∑—ã–≤–∞—Ç—å—Å—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ
- –î–æ–ª–≥–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–ª–æ–∫–∏—Ä—É–µ—Ç heartbeat
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏

---

## –°–ª–∞–π–¥ 28: Consumer - Offset Management

### –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π commit:**

```java
props.put("enable.auto.commit", true);
props.put("auto.commit.interval.ms", 5000);
```

**–†—É—á–Ω–æ–π commit:**

```java
props.put("enable.auto.commit", false);

// –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π commit
consumer.commitSync();

// –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π commit
consumer.commitAsync(new OffsetCommitCallback() {
    @Override
    public void onComplete(Map<TopicPartition, OffsetAndMetadata> offsets, Exception e) {
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    }
});
```

**Commit –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ offset:**

```java
Map<TopicPartition, OffsetAndMetadata> offsets = new HashMap<>();
offsets.put(partition, new OffsetAndMetadata(offset + 1));
consumer.commitSync(offsets);
```

---

## –°–ª–∞–π–¥ 29: Consumer Groups

### –ì—Ä—É–ø–ø—ã –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π

**–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:**

- –ö–∞–∂–¥—ã–π —Ä–∞–∑–¥–µ–ª —á–∏—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∏–º –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–º –≥—Ä—É–ø–ø—ã
- –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è ‚Äî —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–æ–≤

**–ü—Ä–∏–º–µ—Ä:**

```
–¢–æ–ø–∏–∫: orders (4 —Ä–∞–∑–¥–µ–ª–∞)
Consumer Group: order-processors
‚îú‚îÄ‚îÄ Consumer 1 ‚Üí –†–∞–∑–¥–µ–ª—ã 0, 1
‚îú‚îÄ‚îÄ Consumer 2 ‚Üí –†–∞–∑–¥–µ–ª 2
‚îî‚îÄ‚îÄ Consumer 3 ‚Üí –†–∞–∑–¥–µ–ª 3
```

**–î–æ–±–∞–≤–∏–ª–∏ Consumer 4:**

```
‚îú‚îÄ‚îÄ Consumer 1 ‚Üí –†–∞–∑–¥–µ–ª 0
‚îú‚îÄ‚îÄ Consumer 2 ‚Üí –†–∞–∑–¥–µ–ª 1
‚îú‚îÄ‚îÄ Consumer 3 ‚Üí –†–∞–∑–¥–µ–ª 2
‚îî‚îÄ‚îÄ Consumer 4 ‚Üí –†–∞–∑–¥–µ–ª 3
```

---

## –°–ª–∞–π–¥ 30: Consumer - –†–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞

### –ü–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–æ–≤

**–¢—Ä–∏–≥–≥–µ—Ä—ã —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏:**

1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è
2. –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è
3. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–∞–∑–¥–µ–ª–æ–≤ —Ç–æ–ø–∏–∫–∞
4. Timeout —Å–µ—Å—Å–∏–∏

**–¢–∏–ø—ã —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏:**

- **Eager:** –í—Å–µ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏ –æ—Ç–ø–∏—Å—ã–≤–∞—é—Ç—Å—è, –∑–∞—Ç–µ–º –ø–æ–¥–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –∑–∞–Ω–æ–≤–æ
- **Cooperative (Incremental):** –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

**–ü—Ä–æ–±–ª–µ–º—ã:**

- Stop-the-world —ç—Ñ—Ñ–µ–∫—Ç
- –ü–æ—Ç–µ—Ä—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–†–µ—à–µ–Ω–∏–µ:** Cooperative rebalancing (Kafka 2.3+)

---

## –°–ª–∞–π–¥ 31: Consumer - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏

**1. Retry:**

```java
try {
    processRecord(record);
} catch (Exception e) {
    // –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É
    retry(record);
}
```

**2. Dead Letter Queue:**

```java
try {
    processRecord(record);
} catch (Exception e) {
    // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ DLQ
    sendToDLQ(record, e);
    consumer.commitSync();
}
```

**3. Skip:**

```java
try {
    processRecord(record);
} catch (Exception e) {
    // –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
    log.error("Skipping record", e);
    consumer.commitSync();
}
```

---

## –°–ª–∞–π–¥ 32: Consumer - –î–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è

### –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –±–∞–π—Ç–æ–≤ –≤ –æ–±—ä–µ–∫—Ç—ã

**–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã:**

- `StringDeserializer`
- `ByteArrayDeserializer`
- `IntegerDeserializer`
- `LongDeserializer`

**–ö–∞—Å—Ç–æ–º–Ω—ã–π –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä:**

```java
public class UserDeserializer implements Deserializer<User> {
    @Override
    public User deserialize(String topic, byte[] data) {
        try {
            return jsonMapper.readValue(data, User.class);
        } catch (Exception e) {
            throw new SerializationException("Error deserializing", e);
        }
    }
}
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Schema Registry –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏!

---

# –ó–∞–Ω—è—Ç–∏–µ 4: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Kafka –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ (2 —á–∞—Å–∞)

## –°–ª–∞–π–¥ 33: –ì–ª–∞–≤–∞ 5. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Kafka –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ

### AdminClient API

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**

- –°–æ–∑–¥–∞–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–ø–∏–∫–æ–≤
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ü—Ä–æ—Å–º–æ—Ç—Ä –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ACL

**–ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è —Ç–æ–ø–∏–∫–∞:**

```java
AdminClient admin = AdminClient.create(props);

NewTopic newTopic = new NewTopic("my-topic", 3, (short) 2);
CreateTopicsResult result = admin.createTopics(
    Collections.singleton(newTopic)
);

result.all().get();  // –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
```

---

## –°–ª–∞–π–¥ 34: AdminClient - –û–ø–µ—Ä–∞—Ü–∏–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

**–°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–ø–∏–∫–∞:**

```java
admin.createTopics(topics);
```

**–£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–ø–∏–∫–∞:**

```java
admin.deleteTopics(topicNames);
```

**–°–ø–∏—Å–æ–∫ —Ç–æ–ø–∏–∫–æ–≤:**

```java
ListTopicsResult result = admin.listTopics();
Set<String> topics = result.names().get();
```

**–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–ø–∏–∫–∞:**

```java
DescribeTopicsResult result = admin.describeTopics(topicNames);
Map<String, TopicDescription> descriptions = result.all().get();
```

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**

```java
ConfigResource resource = new ConfigResource(ConfigResource.Type.TOPIC, "my-topic");
ConfigEntry entry = new ConfigEntry("retention.ms", "86400000");
admin.alterConfigs(Collections.singletonMap(resource, new Config(Collections.singleton(entry))));
```

---

# –ó–∞–Ω—è—Ç–∏–µ 5: –í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ Kafka (2 —á–∞—Å–∞)

## –°–ª–∞–π–¥ 35: –ì–ª–∞–≤–∞ 6. –í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ Kafka

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±—Ä–æ–∫–µ—Ä–∞

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

1. **–°–µ—Ç–µ–≤–æ–π —Å–ª–æ–π** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
2. **API —Å–ª–æ–π** ‚Äî Producer/Consumer API
3. **–ñ—É—Ä–Ω–∞–ª (Log)** ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
4. **–ò–Ω–¥–µ–∫—Å—ã** ‚Äî –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø
5. **–†–µ–ø–ª–∏–∫–∞—Ü–∏—è** ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞–∑–¥–µ–ª–∞:**

```
partition-0/
‚îú‚îÄ‚îÄ 00000000000000000000.log  (—Å–µ–≥–º–µ–Ω—Ç)
‚îú‚îÄ‚îÄ 00000000000000000000.index
‚îú‚îÄ‚îÄ 00000000000000000000.timeindex
‚îú‚îÄ‚îÄ 00000000000000123456.log
‚îî‚îÄ‚îÄ ...
```

---

## –°–ª–∞–π–¥ 36: –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

### –°–µ–≥–º–µ–Ω—Ç—ã –∏ –∏–Ω–¥–µ–∫—Å—ã

**–°–µ–≥–º–µ–Ω—Ç (Segment):**

- –§–∞–π–ª –∂—É—Ä–Ω–∞–ª–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1GB –∏–ª–∏ 7 –¥–Ω–µ–π
- –°—Ç–∞—Ä—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã —É–¥–∞–ª—è—é—Ç—Å—è (retention)

**–ò–Ω–¥–µ–∫—Å—ã:**

- **Offset index** ‚Äî –±—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –ø–æ offset
- **Time index** ‚Äî –ø–æ–∏—Å–∫ –ø–æ –≤—Ä–µ–º–µ–Ω–∏

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```
Offset: 0     ‚Üí Position: 0
Offset: 100   ‚Üí Position: 1024
Offset: 200   ‚Üí Position: 2048
```

**–ß—Ç–µ–Ω–∏–µ:** –ë–∏–Ω–∞—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –∏–Ω–¥–µ–∫—Å—É ‚Üí —á—Ç–µ–Ω–∏–µ –∏–∑ –∂—É—Ä–Ω–∞–ª–∞

---

## –°–ª–∞–π–¥ 37: –†–µ–ø–ª–∏–∫–∞—Ü–∏—è

### Leader –∏ Followers

**–†–æ–ª–∏:**

- **Leader** ‚Äî –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã
- **Followers** ‚Äî –∫–æ–ø–∏—Ä—É—é—Ç –¥–∞–Ω–Ω—ã–µ –æ—Ç Leader

**–ü—Ä–æ—Ü–µ—Å—Å –∑–∞–ø–∏—Å–∏:**

```
Producer ‚Üí Leader ‚Üí Follower 1
                  ‚Üí Follower 2
```

**ISR (In-Sync Replicas):**

- –†–µ–ø–ª–∏–∫–∏, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å Leader
- –ú–∏–Ω–∏–º—É–º –¥–ª—è –∑–∞–ø–∏—Å–∏: `min.insync.replicas`

**Failover:**

- –ü—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ Leader –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –∏–∑ ISR
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å

---

## –°–ª–∞–π–¥ 38: Request Processing

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤

**–¢–∏–ø—ã –∑–∞–ø—Ä–æ—Å–æ–≤:**

- **Produce** ‚Äî –∑–∞–ø–∏—Å—å —Å–æ–æ–±—â–µ–Ω–∏–π
- **Fetch** ‚Äî —á—Ç–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
- **Metadata** ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- **Offset** ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ offset

**–ü—Ä–æ—Ü–µ—Å—Å:**

```
Request ‚Üí Acceptor Thread ‚Üí Request Queue
                              ‚Üì
                         I/O Thread Pool
                              ‚Üì
                         Kafka API Handler
                              ‚Üì
                         Response Queue
                              ‚Üì
                         Network Thread
```

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤ –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞

---

## –°–ª–∞–π–¥ 39: –§–∏–∑–∏—á–µ—Å–∫–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ

### –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –Ω–∞ –¥–∏—Å–∫–µ

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```
/tmp/kafka-logs/
‚îú‚îÄ‚îÄ topic1-0/
‚îÇ   ‚îú‚îÄ‚îÄ 00000000000000000000.log
‚îÇ   ‚îú‚îÄ‚îÄ 00000000000000000000.index
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ topic1-1/
‚îî‚îÄ‚îÄ topic2-0/
```

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**

- Sequential writes (–±—ã—Å—Ç—Ä–µ–µ —á–µ–º random)
- Zero-copy –¥–ª—è —á—Ç–µ–Ω–∏—è
- Page cache (–û–° –∫–µ—à–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã)

**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**

- –ó–∞–ø–∏—Å—å: ~600MB/s –Ω–∞ –æ–¥–Ω–æ–º –¥–∏—Å–∫–µ
- –ß—Ç–µ–Ω–∏–µ: –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ —Å–µ—Ç—å—é, –Ω–µ –¥–∏—Å–∫–æ–º

---

# –ó–∞–Ω—è—Ç–∏–µ 6: –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ —Å–µ–º–∞–Ω—Ç–∏–∫–∞ (2 —á–∞—Å–∞)

## –°–ª–∞–π–¥ 40: –ì–ª–∞–≤–∞ 7. –ù–∞–¥–µ–∂–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

### –ì–∞—Ä–∞–Ω—Ç–∏–∏ –¥–æ—Å—Ç–∞–≤–∫–∏

**–£—Ä–æ–≤–Ω–∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏:**

**1. At-most-once (–º–∞–∫—Å–∏–º—É–º –æ–¥–∏–Ω —Ä–∞–∑):**

- `acks=0` ‚Äî –Ω–µ –∂–¥–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- –ë—ã—Å—Ç—Ä–æ, –Ω–æ –º–æ–≥—É—Ç –±—ã—Ç—å –ø–æ—Ç–µ—Ä–∏

**2. At-least-once (–º–∏–Ω–∏–º—É–º –æ–¥–∏–Ω —Ä–∞–∑):**

- `acks=all`, `retries>0`
- –ù–µ—Ç –ø–æ—Ç–µ—Ä—å, –Ω–æ –≤–æ–∑–º–æ–∂–Ω—ã –¥—É–±–ª–∏–∫–∞—Ç—ã

**3. Exactly-once (—Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑):**

- –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–π Producer + —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –ù–µ—Ç –ø–æ—Ç–µ—Ä—å –∏ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

---

## –°–ª–∞–π–¥ 41: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏

### Producer –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

**–î–ª—è at-least-once:**

```java
props.put("acks", "all");
props.put("retries", Integer.MAX_VALUE);
props.put("max.in.flight.requests.per.connection", 1);
```

**–î–ª—è exactly-once:**

```java
props.put("enable.idempotence", true);
props.put("acks", "all");
props.put("retries", Integer.MAX_VALUE);
props.put("max.in.flight.requests.per.connection", 5);
```

**Consumer –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**

```java
props.put("enable.auto.commit", false);
// Commit –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
consumer.commitSync();
```

---

## –°–ª–∞–π–¥ 42: –ì–ª–∞–≤–∞ 8. Exactly-Once Semantics

### –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ Kafka

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞–∫ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å exactly-once –º–µ–∂–¥—É Producer –∏ Consumer?

**–†–µ—à–µ–Ω–∏–µ:** –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ Kafka

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Producer:**

```java
props.put("enable.idempotence", true);
props.put("transactional.id", "my-transactional-id");
props.put("acks", "all");

Producer<String, String> producer = new KafkaProducer<>(props);
producer.initTransactions();
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```java
producer.beginTransaction();
try {
    producer.send(record1);
    producer.send(record2);
    producer.commitTransaction();
} catch (Exception e) {
    producer.abortTransaction();
}
```

---

## –°–ª–∞–π–¥ 43: –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ - Consumer

### –ß—Ç–µ–Ω–∏–µ –∏–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–æ–ø–∏–∫–æ–≤

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Consumer:**

```java
props.put("isolation.level", "read_committed");
// –∏–ª–∏ "read_uncommitted" (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
```

**–†–∞–∑–Ω–∏—Ü–∞:**

- `read_uncommitted` ‚Äî —á–∏—Ç–∞–µ—Ç –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–≤–∫–ª—é—á–∞—è aborted)
- `read_committed` ‚Äî —á–∏—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ committed —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

**–í–∞–∂–Ω–æ:** –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –æ–¥–Ω–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞!

---

# –ó–∞–Ω—è—Ç–∏–µ 7: Data Pipelines (2 —á–∞—Å–∞)

## –°–ª–∞–π–¥ 44: –ì–ª–∞–≤–∞ 9. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ Data Pipelines

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

**–¢–∏–ø—ã pipelines:**

1. **ETL** ‚Äî Extract, Transform, Load
2. **ELT** ‚Äî Extract, Load, Transform
3. **Streaming** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

- **Kafka Connect** ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
- **Kafka Streams** ‚Äî –ø–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- **Custom Producers/Consumers** ‚Äî –∫–∞—Å—Ç–æ–º–Ω–∞—è –ª–æ–≥–∏–∫–∞

**–ü—Ä–∏–º–µ—Ä—ã:**

- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ‚Üí Kafka ‚Üí Data Warehouse
- Kafka ‚Üí Elasticsearch (–ø–æ–∏—Å–∫)
- Kafka ‚Üí HDFS (—Ö—Ä–∞–Ω–µ–Ω–∏–µ)

---

## –°–ª–∞–π–¥ 45: Kafka Connect

### –§—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

**–ö–æ–Ω—Ü–µ–ø—Ü–∏—è:**

- **Source Connectors** ‚Äî —á—Ç–µ–Ω–∏–µ –∏–∑ –≤–Ω–µ—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º
- **Sink Connectors** ‚Äî –∑–∞–ø–∏—Å—å –≤–æ –≤–Ω–µ—à–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

**–ì–æ—Ç–æ–≤—ã–µ –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä—ã:**

- JDBC (–±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö)
- Elasticsearch
- S3
- HDFS
- MongoDB
- –ò –º–Ω–æ–≥–∏–µ –¥—Ä—É–≥–∏–µ

**–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**

```json
{
  "name": "jdbc-source",
  "config": {
    "connector.class": "io.confluent.connect.jdbc.JdbcSourceConnector",
    "connection.url": "jdbc:postgresql://localhost/db",
    "table.whitelist": "users",
    "topic.prefix": "db-"
  }
}
```

---

## –°–ª–∞–π–¥ 46: Kafka Streams

### –ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

**Kafka Streams:**

- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è Java/Scala
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- Stateful –∏ stateless –æ–ø–µ—Ä–∞—Ü–∏–∏

**–ü—Ä–∏–º–µ—Ä:**

```java
StreamsBuilder builder = new StreamsBuilder();
KStream<String, String> source = builder.stream("input-topic");

source
    .filter((key, value) -> value.length() > 5)
    .mapValues(value -> value.toUpperCase())
    .to("output-topic");

KafkaStreams streams = new KafkaStreams(builder.build(), props);
streams.start();
```

**–û–ø–µ—Ä–∞—Ü–∏–∏:**

- map, filter, flatMap
- groupBy, aggregate
- join, windowing

---

## –°–ª–∞–π–¥ 47: –ì–ª–∞–≤–∞ 10. Cross-Cluster Data Mirroring

### –†–µ–ø–ª–∏–∫–∞—Ü–∏—è –º–µ–∂–¥—É –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏

**–°—Ü–µ–Ω–∞—Ä–∏–∏:**

- Disaster recovery
- –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
- –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏—è:**

1. **MirrorMaker 2.0** ‚Äî –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
2. **Confluent Replicator** ‚Äî –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ
3. **Custom solutions** ‚Äî –∫–∞—Å—Ç–æ–º–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

**MirrorMaker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**

```properties
clusters = primary, backup
primary.bootstrap.servers = primary-kafka:9092
backup.bootstrap.servers = backup-kafka:9092

primary->backup.enabled = true
primary->backup.topics = .*
```

---

# –ó–∞–Ω—è—Ç–∏–µ 8: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (2 —á–∞—Å–∞)

## –°–ª–∞–π–¥ 48: –ì–ª–∞–≤–∞ 11. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å Kafka

### –ó–∞—â–∏—Ç–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞

**–£—Ä–æ–≤–Ω–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**

1. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** ‚Äî –∫—Ç–æ –≤—ã?
2. **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** ‚Äî —á—Ç–æ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å?
3. **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –∑–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö

**–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:**

- SASL/PLAIN
- SASL/SCRAM
- SASL/GSSAPI (Kerberos)
- mTLS (SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã)

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:**

- ACL (Access Control Lists)
- RBAC (Role-Based Access Control)

---

## –°–ª–∞–π–¥ 49: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### SSL/TLS

**–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤:**

```bash
# CA —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
openssl req -new -x509 -keyout ca-key -out ca-cert -days 365

# –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±—Ä–æ–∫–µ—Ä–∞
keytool -keystore kafka.server.keystore.jks \
  -alias localhost -validity 365 \
  -genkey -keyalg RSA
```

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±—Ä–æ–∫–µ—Ä–∞:**

```properties
listeners=SSL://localhost:9093
ssl.keystore.location=/var/private/ssl/kafka.server.keystore.jks
ssl.keystore.password=test1234
ssl.key.password=test1234
ssl.truststore.location=/var/private/ssl/kafka.server.truststore.jks
ssl.truststore.password=test1234
```

---

## –°–ª–∞–π–¥ 50: ACL (Access Control Lists)

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º

**–í–∫–ª—é—á–µ–Ω–∏–µ ACL:**

```properties
authorizer.class.name=kafka.security.authorizer.AclAuthorizer
super.users=User:admin
```

**–°–æ–∑–¥–∞–Ω–∏–µ ACL:**

```bash
# –†–∞–∑—Ä–µ—à–∏—Ç—å Producer –ø–∏—Å–∞—Ç—å –≤ —Ç–æ–ø–∏–∫
kafka-acls.sh --authorizer-properties zookeeper.connect=localhost:2181 \
  --add --allow-principal User:producer \
  --operation Write --topic my-topic

# –†–∞–∑—Ä–µ—à–∏—Ç—å Consumer —á–∏—Ç–∞—Ç—å –∏–∑ —Ç–æ–ø–∏–∫–∞
kafka-acls.sh --authorizer-properties zookeeper.connect=localhost:2181 \
  --add --allow-principal User:consumer \
  --operation Read --topic my-topic \
  --group my-group
```

---

# –ó–∞–Ω—è—Ç–∏–µ 9: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ (2 —á–∞—Å–∞)

## –°–ª–∞–π–¥ 51: –ì–ª–∞–≤–∞ 12. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ Kafka

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–º

**–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏:**

1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–ø–∏–∫–∞–º–∏
2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–∞–º–∏
3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—Ä–æ–∫–µ—Ä–∞–º–∏
4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
5. –¢—é–Ω–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**

- `kafka-topics.sh` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–ø–∏–∫–∞–º–∏
- `kafka-configs.sh` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `kafka-reassign-partitions.sh` ‚Äî –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–æ–≤
- `kafka-consumer-groups.sh` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø–∞–º–∏

---

## –°–ª–∞–π–¥ 52: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–ø–∏–∫–∞–º–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

**–°–æ–∑–¥–∞–Ω–∏–µ:**

```bash
kafka-topics.sh --create \
  --topic my-topic \
  --partitions 3 \
  --replication-factor 2 \
  --config retention.ms=86400000 \
  --bootstrap-server localhost:9092
```

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–∞–∑–¥–µ–ª–æ–≤:**

```bash
kafka-topics.sh --alter \
  --topic my-topic \
  --partitions 6 \
  --bootstrap-server localhost:9092
```

**–£–¥–∞–ª–µ–Ω–∏–µ:**

```bash
kafka-topics.sh --delete \
  --topic my-topic \
  --bootstrap-server localhost:9092
```

**–í–∞–∂–Ω–æ:** –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ, —É–º–µ–Ω—å—à–µ–Ω–∏–µ ‚Äî –Ω–µ—Ç!

---

## –°–ª–∞–π–¥ 53: –ü–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–æ–≤

### Rebalancing

**–ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ:**

- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –±—Ä–æ–∫–µ—Ä–æ–≤
- –£–¥–∞–ª–µ–Ω–∏–µ –±—Ä–æ–∫–µ—Ä–æ–≤
- –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏

**–ü—Ä–æ—Ü–µ—Å—Å:**

```bash
# 1. –°–æ–∑–¥–∞—Ç—å –ø–ª–∞–Ω –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
kafka-reassign-partitions.sh \
  --generate \
  --topics-to-move-json-file topics.json \
  --broker-list 1,2,3 \
  --bootstrap-server localhost:9092

# 2. –í—ã–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
kafka-reassign-partitions.sh \
  --execute \
  --reassignment-json-file reassignment.json \
  --bootstrap-server localhost:9092

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
kafka-reassign-partitions.sh \
  --verify \
  --reassignment-json-file reassignment.json \
  --bootstrap-server localhost:9092
```

---

## –°–ª–∞–π–¥ 54: Consumer Groups

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø–∞–º–∏

**–°–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø:**

```bash
kafka-consumer-groups.sh --list \
  --bootstrap-server localhost:9092
```

**–û–ø–∏—Å–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã:**

```bash
kafka-consumer-groups.sh --describe \
  --group my-group \
  --bootstrap-server localhost:9092
```

**–°–±—Ä–æ—Å offset:**

```bash
# –ö –Ω–∞—á–∞–ª—É
kafka-consumer-groups.sh --reset-offsets \
  --to-earliest \
  --group my-group \
  --topic my-topic \
  --execute \
  --bootstrap-server localhost:9092

# –ö –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É offset
kafka-consumer-groups.sh --reset-offsets \
  --to-offset 100 \
  --group my-group \
  --topic my-topic \
  --execute \
  --bootstrap-server localhost:9092
```

---

# –ó–∞–Ω—è—Ç–∏–µ 10: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ Stream Processing (2 —á–∞—Å–∞)

## –°–ª–∞–π–¥ 55: –ì–ª–∞–≤–∞ 13. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Kafka

### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

**–ú–µ—Ç—Ä–∏–∫–∏ –±—Ä–æ–∫–µ—Ä–æ–≤:**

- `kafka.server:type=BrokerTopicMetrics,name=MessagesInPerSec`
- `kafka.server:type=BrokerTopicMetrics,name=BytesInPerSec`
- `kafka.server:type=BrokerTopicMetrics,name=BytesOutPerSec`
- `kafka.network:type=RequestMetrics,name=TotalTimeMs`

**–ú–µ—Ç—Ä–∏–∫–∏ —Ç–æ–ø–∏–∫–æ–≤:**

- –†–∞–∑–º–µ—Ä —Ä–∞–∑–¥–µ–ª–æ–≤
- Lag –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π
- Throughput

**–ú–µ—Ç—Ä–∏–∫–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π:**

- `records-lag-max` ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –æ—Ç—Å—Ç–∞–≤–∞–Ω–∏–µ
- `records-consumed-rate` ‚Äî —Å–∫–æ—Ä–æ—Å—Ç—å –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è

---

## –°–ª–∞–π–¥ 56: –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

**1. JMX –º–µ—Ç—Ä–∏–∫–∏:**

- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ Kafka
- JConsole, VisualVM
- Prometheus + JMX Exporter

**2. Kafka Manager / CMAK:**

- –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**3. Confluent Control Center:**

- –ö–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**4. –ö–∞—Å—Ç–æ–º–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥—ã:**

- Grafana + Prometheus
- ELK Stack –¥–ª—è –ª–æ–≥–æ–≤

---

## –°–ª–∞–π–¥ 57: –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏

### –ß—Ç–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ

**1. Consumer Lag:**

- –û—Ç—Å—Ç–∞–≤–∞–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π
- –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è real-time —Å–∏—Å—Ç–µ–º

**2. Disk Usage:**

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è

**3. Network I/O:**

- –í—Ö–æ–¥—è—â–∏–π/–∏—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫
- –í—ã—è–≤–ª–µ–Ω–∏–µ —É–∑–∫–∏—Ö –º–µ—Å—Ç

**4. Request Latency:**

- –ó–∞–¥–µ—Ä–∂–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- P50, P95, P99 –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª–∏

**5. Under-replicated Partitions:**

- –ü—Ä–æ–±–ª–µ–º—ã —Å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–µ–π
- –†–∏—Å–∫ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö

---

## –°–ª–∞–π–¥ 58: –ì–ª–∞–≤–∞ 14. Stream Processing

### –ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

**–ö–æ–Ω—Ü–µ–ø—Ü–∏—è:**

- –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ —Å–æ–±—ã—Ç–∏–π
- Stateful –∏ stateless –æ–ø–µ—Ä–∞—Ü–∏–∏

**–§—Ä–µ–π–º–≤–æ—Ä–∫–∏:**

1. **Kafka Streams** ‚Äî –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è Java/Scala
2. **KsqlDB** ‚Äî SQL –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤
3. **Apache Flink** ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
4. **Apache Samza** ‚Äî –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å batch:**

- Batch: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- Stream: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

---

## –°–ª–∞–π–¥ 59: Kafka Streams - –û—Å–Ω–æ–≤—ã

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

- **Stream** ‚Äî –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø–∏—Å–µ–π
- **Table** ‚Äî –∏–∑–º–µ–Ω—è–µ–º–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞
- **Processor** ‚Äî –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–ø–∏—Å–µ–π
- **State Store** ‚Äî —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–¢–æ–ø–æ–ª–æ–≥–∏—è:**

```
Source ‚Üí Processor1 ‚Üí Processor2 ‚Üí Sink
         ‚Üì
      State Store
```

**–ü—Ä–∏–º–µ—Ä:**

```java
StreamsBuilder builder = new StreamsBuilder();
KStream<String, String> source = builder.stream("input");

source
    .groupByKey()
    .count()
    .toStream()
    .to("output");

KafkaStreams streams = new KafkaStreams(builder.build(), props);
streams.start();
```

---

## –°–ª–∞–π–¥ 60: Kafka Streams - –û–ø–µ—Ä–∞—Ü–∏–∏

### –¢–∏–ø—ã –æ–ø–µ—Ä–∞—Ü–∏–π

**Stateless (–±–µ–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è):**

- `map`, `filter`, `flatMap`
- `branch`, `merge`
- `peek`

**Stateful (—Å —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º):**

- `groupBy`, `groupByKey`
- `aggregate`, `reduce`, `count`
- `join` (stream-stream, stream-table)
- `window` (tumbling, hopping, session)

**–ü—Ä–∏–º–µ—Ä windowing:**

```java
source
    .groupByKey()
    .windowedBy(TimeWindows.of(Duration.ofMinutes(5)))
    .count()
    .toStream()
    .to("windowed-output");
```

---

## –°–ª–∞–π–¥ 61: KsqlDB

### SQL –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤

**–ö–æ–Ω—Ü–µ–ø—Ü–∏—è:**

- SQL-–ø–æ–¥–æ–±–Ω—ã–π —è–∑—ã–∫ –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤
- –£–ø—Ä–æ—â–∞–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É
- –ù–µ –Ω—É–∂–µ–Ω Java –∫–æ–¥

**–ü—Ä–∏–º–µ—Ä—ã:**

**–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞:**

```sql
CREATE STREAM user_events (
    user_id VARCHAR,
    event_type VARCHAR,
    timestamp BIGINT
) WITH (
    KAFKA_TOPIC='user-events',
    VALUE_FORMAT='JSON'
);
```

**–ó–∞–ø—Ä–æ—Å:**

```sql
SELECT user_id, COUNT(*) as event_count
FROM user_events
WINDOW TUMBLING (SIZE 1 MINUTE)
GROUP BY user_id;
```

---

## –°–ª–∞–π–¥ 62: Use Cases Stream Processing

### –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**1. Real-time Analytics:**

- –ü–æ–¥—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –ê–≥—Ä–µ–≥–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π

**2. Fraud Detection:**

- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π
- –ü–∞—Ç—Ç–µ—Ä–Ω—ã –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞

**3. Recommendation Systems:**

- –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

**4. IoT:**

- –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å –¥–∞—Ç—á–∏–∫–æ–≤
- –ê–ª–µ—Ä—Ç–∏–Ω–≥

**5. Event-driven Architecture:**

- –†–µ–∞–∫—Ü–∏—è –Ω–∞ —Å–æ–±—ã—Ç–∏—è
- –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã

---

## –°–ª–∞–π–¥ 63: Best Practices

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

**–¢–æ–ø–∏–∫–∏:**

- –û—Å–º—ã—Å–ª–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞
- –ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑–¥–µ–ª–æ–≤ –∑–∞—Ä–∞–Ω–µ–µ
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ retention policy
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∂–∞—Ç–∏–µ

**Producers:**

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞–∫–µ—Ç—ã
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ—à–∏–±–∫–∏
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –º–µ—Ç—Ä–∏–∫–∏

**Consumers:**

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥—Ä—É–ø–ø—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- Commit –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ lag
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–ö–ª–∞—Å—Ç–µ—Ä:**

- –ú–∏–Ω–∏–º—É–º 3 –±—Ä–æ–∫–µ—Ä–∞
- Replication factor = 3
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç–∏–Ω–≥
- –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –±—ç–∫–∞–ø—ã

---

## –°–ª–∞–π–¥ 64: Troubleshooting

### –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

**1. Consumer Lag:**

- **–ü—Ä–∏—á–∏–Ω–∞:** –ú–µ–¥–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- **–†–µ—à–µ–Ω–∏–µ:** –£–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É

**2. –ù–µ—Ö–≤–∞—Ç–∫–∞ —Ä–∞–∑–¥–µ–ª–æ–≤:**

- **–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ª—å–∑—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –¥–∞–ª—å—à–µ
- **–†–µ—à–µ–Ω–∏–µ:** –£–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑–¥–µ–ª–æ–≤ (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)

**3. –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∏—Å–∫–∞:**

- **–ü—Ä–∏—á–∏–Ω–∞:** –°—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è
- **–†–µ—à–µ–Ω–∏–µ:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å retention policy

**4. Network saturation:**

- **–ü—Ä–∏—á–∏–Ω–∞:** –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö
- **–†–µ—à–µ–Ω–∏–µ:** –°–∂–∞—Ç–∏–µ, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –ø–∞–∫–µ—Ç–æ–≤

**5. Under-replicated partitions:**

- **–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–æ–±–ª–µ–º—ã —Å –±—Ä–æ–∫–µ—Ä–∞–º–∏
- **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ –±—Ä–æ–∫–µ—Ä–æ–≤

---

## –°–ª–∞–π–¥ 65: –†–µ–∑—é–º–µ –∫—É—Ä—Å–∞

### –ß—Ç–æ –º—ã –∏–∑—É—á–∏–ª–∏

**–û—Å–Ω–æ–≤—ã:**

- –ü–∞—Ç—Ç–µ—Ä–Ω pub/sub
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Kafka
- –¢–æ–ø–∏–∫–∏, —Ä–∞–∑–¥–µ–ª—ã, —Å–æ–æ–±—â–µ–Ω–∏—è

**–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞:**

- Producers –∏ Consumers
- –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

**–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã:**

- –í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
- –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**–ü—Ä–∞–∫—Ç–∏–∫–∞:**

- Data Pipelines
- Stream Processing
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## –°–ª–∞–π–¥ 66: –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### –ì–¥–µ —É—á–∏—Ç—å—Å—è –¥–∞–ª—å—à–µ?

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**

- https://kafka.apache.org/documentation/
- https://kafka.apache.org/quickstart

**–ö–Ω–∏–≥–∏:**

- "Kafka: The Definitive Guide" (—ç—Ç–∞ –∫–Ω–∏–≥–∞!)
- "Kafka Streams in Action"

**–ü—Ä–∞–∫—Ç–∏–∫–∞:**

- Docker –æ–±—Ä–∞–∑—ã Kafka
- Confluent Platform (–±–µ—Å–ø–ª–∞—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è)
- –ü—Ä–∏–º–µ—Ä—ã –Ω–∞ GitHub

**–°–æ–æ–±—â–µ—Å—Ç–≤–æ:**

- Apache Kafka mailing lists
- Stack Overflow
- Reddit r/apachekafka
- Confluent Community

---

## –°–ª–∞–π–¥ 67: –í–æ–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã

### ‚ùì –í—Ä–µ–º—è –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤

**–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã:**

1. **–ö–∞–∫ –≤—ã–±—Ä–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑–¥–µ–ª–æ–≤?**

   - –ó–∞–≤–∏—Å–∏—Ç –æ—Ç throughput –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑–¥–µ–ª–æ–≤ = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π

2. **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Kafka vs RabbitMQ?**

   - Kafka: –≤—ã—Å–æ–∫–∏–π throughput, –¥–æ–ª–≥–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ
   - RabbitMQ: —Å–ª–æ–∂–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è, –Ω–∏–∑–∫–∏–π latency

3. **–ö–∞–∫ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π?**

   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª—é—á–∏ –∏ –æ–¥–∏–Ω —Ä–∞–∑–¥–µ–ª
   - –ò–ª–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è exactly-once

4. **–ú–æ–∂–Ω–æ –ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑–¥–µ–ª–æ–≤?**
   - –£–≤–µ–ª–∏—á–∏—Ç—å ‚Äî –¥–∞, –±–µ–∑–æ–ø–∞—Å–Ω–æ
   - –£–º–µ–Ω—å—à–∏—Ç—å ‚Äî –Ω–µ—Ç, –ø–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö

**–í–∞—à–∏ –≤–æ–ø—Ä–æ—Å—ã?**

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: –®–ø–∞—Ä–≥–∞–ª–∫–∞ –∫–æ–º–∞–Ω–¥

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã Kafka

**–¢–æ–ø–∏–∫–∏:**

```bash
# –°–æ–∑–¥–∞—Ç—å
kafka-topics.sh --create --topic my-topic --partitions 3 --replication-factor 2

# –°–ø–∏—Å–æ–∫
kafka-topics.sh --list

# –û–ø–∏—Å–∞–Ω–∏–µ
kafka-topics.sh --describe --topic my-topic

# –£–¥–∞–ª–∏—Ç—å
kafka-topics.sh --delete --topic my-topic
```

**Producer:**

```bash
kafka-console-producer.sh --topic my-topic --bootstrap-server localhost:9092
```

**Consumer:**

```bash
kafka-console-consumer.sh --topic my-topic --from-beginning --bootstrap-server localhost:9092
```

**Consumer Groups:**

```bash
kafka-consumer-groups.sh --list
kafka-consumer-groups.sh --describe --group my-group
```

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

### Producer (Java)

```java
Properties props = new Properties();
props.put("bootstrap.servers", "localhost:9092");
props.put("key.serializer", "org.apache.kafka.common.serialization.StringSerializer");
props.put("value.serializer", "org.apache.kafka.common.serialization.StringSerializer");
props.put("acks", "all");
props.put("retries", 3);

Producer<String, String> producer = new KafkaProducer<>(props);

for (int i = 0; i < 100; i++) {
    ProducerRecord<String, String> record =
        new ProducerRecord<>("my-topic", "key-" + i, "value-" + i);
    producer.send(record, (metadata, exception) -> {
        if (exception != null) {
            System.err.println("Error: " + exception);
        } else {
            System.out.println("Sent: " + metadata);
        }
    });
}

producer.close();
```

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

### Consumer (Java)

```java
Properties props = new Properties();
props.put("bootstrap.servers", "localhost:9092");
props.put("group.id", "my-group");
props.put("key.deserializer", "org.apache.kafka.common.serialization.StringDeserializer");
props.put("value.deserializer", "org.apache.kafka.common.serialization.StringDeserializer");
props.put("enable.auto.commit", false);

Consumer<String, String> consumer = new KafkaConsumer<>(props);
consumer.subscribe(Arrays.asList("my-topic"));

try {
    while (true) {
        ConsumerRecords<String, String> records = consumer.poll(Duration.ofMillis(100));
        for (ConsumerRecord<String, String> record : records) {
            System.out.printf("offset = %d, key = %s, value = %s%n",
                record.offset(), record.key(), record.value());
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
            processRecord(record);
        }
        consumer.commitSync();
    }
} finally {
    consumer.close();
}
```

---

**–ö–æ–Ω–µ—Ü –∫—É—Ä—Å–∞**

_–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–Ω–∏–º–∞–Ω–∏–µ!_

**–£–¥–∞—á–∏ –≤ –∏–∑—É—á–µ–Ω–∏–∏ Kafka!** üöÄ
