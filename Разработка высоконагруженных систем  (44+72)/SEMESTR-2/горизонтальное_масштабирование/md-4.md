–ü–æ–µ—Ö–∞–ª–∏ üòé
–ù–∏–∂–µ ‚Äî  **–ø–æ–¥—Ä–æ–±–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –∑–∞–Ω—è—Ç–∏—è 4** , –ª–æ–≥–∏—á–Ω–æ–µ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è:  **–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏ —Å –ø–æ–º–æ—â—å—é Nginx –≤ Docker Compose** . –≠—Ç–æ –∑–∞–Ω—è—Ç–∏–µ –æ–±—ã—á–Ω–æ –≤—ã–∑—ã–≤–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç ¬´–∞–∞–∞, –≤–æ—Ç –∑–∞—á–µ–º!¬ª üî•

---

# –°—Ü–µ–Ω–∞—Ä–∏–π –∑–∞–Ω—è—Ç–∏—è 4

## –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏ —Å –ø–æ–º–æ—â—å—é Nginx –≤ Docker Compose

---

## üéØ –¶–µ–ª–∏ –∑–∞–Ω—è—Ç–∏—è

–°—Ç—É–¥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω:

* –ø–æ–Ω—è—Ç—å, –∑–∞—á–µ–º –Ω—É–∂–µ–Ω **load balancer**
* —É–º–µ—Ç—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å Nginx –∫–∞–∫ reverse proxy
* —Å–≤—è–∑–∞—Ç—å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–Ω—ã–π backend —Å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–æ–º
* —É–≤–∏–¥–µ—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –º–µ–∂–¥—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏

---

## üß† –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å (20 –º–∏–Ω—É—Ç)

### 1. –ó–∞—á–µ–º –Ω—É–∂–Ω–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏

–ü—Ä–æ–±–ª–µ–º–∞ –∏–∑ –∑–∞–Ω—è—Ç–∏—è 3:

* –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–µ–ø–ª–∏–∫ backend
* –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–∏—Ö–æ–¥—è—Ç —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω—É

–†–µ—à–µ–Ω–∏–µ:

* –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
* —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤

–¢–∏–ø—ã –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏:

* Round-robin (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ Nginx)
* Least connections
* IP hash (—É–ø–æ–º—è–Ω—É—Ç—å –∫—Ä–∞—Ç–∫–æ)

---

### 2. Nginx –∫–∞–∫ reverse proxy

–ö–ª—é—á–µ–≤—ã–µ –ø–æ–Ω—è—Ç–∏—è:

* upstream
* proxy_pass
* L7 –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞

–í–∞–∂–Ω–æ:

* Nginx —Ä–∞–±–æ—Ç–∞–µ—Ç **–≤–Ω—É—Ç—Ä–∏ Docker-—Å–µ—Ç–∏**
* –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–∏–º–µ–Ω–∞ —Å–µ—Ä–≤–∏—Å–æ–≤** –∫–∞–∫ hostname

---

## üß™ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å (55 –º–∏–Ω—É—Ç)

### –®–∞–≥ 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (5 –º–∏–Ω—É—Ç)

```text
project/
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ nginx/
‚îÇ   ‚îî‚îÄ‚îÄ nginx.conf
‚îî‚îÄ‚îÄ app/
    ‚îú‚îÄ‚îÄ app.py
    ‚îî‚îÄ‚îÄ Dockerfile
```

---

### –®–∞–≥ 2. Backend (–ø–æ–≤—Ç–æ—Ä / –±—ã—Å—Ç—Ä–æ) (5 –º–∏–Ω—É—Ç)

–ò—Å–ø–æ–ª—å–∑—É–µ–º backend –∏–∑ –∑–∞–Ω—è—Ç–∏—è 3:

```python
from flask import Flask
import socket

app = Flask(__name__)

@app.route("/")
def hello():
    return f"Hello from container: {socket.gethostname()}\n"

if __name__ == "__main__":
    app.run(host="0.0.0.0", port=5000)
```

---

### –®–∞–≥ 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx (15 –º–∏–Ω—É—Ç)

**nginx/nginx.conf**

```nginx
events {}

http {
    upstream backend {
        server backend:5000;
    }

    server {
        listen 80;

        location / {
            proxy_pass http://backend;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
        }
    }
}
```

üß† –í–∞–∂–Ω–æ –ø—Ä–æ–≥–æ–≤–æ—Ä–∏—Ç—å:

* `backend` ‚Äî —ç—Ç–æ **–∏–º—è —Å–µ—Ä–≤–∏—Å–∞**
* Nginx —Å–∞–º –≤–∏–¥–∏—Ç –≤—Å–µ —Ä–µ–ø–ª–∏–∫–∏
* round-robin —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

### –®–∞–≥ 4. Docker Compose (15 –º–∏–Ω—É—Ç)

```yaml
version: "3.9"

services:
  backend:
    build: ./app

  nginx:
    image: nginx:alpine
    ports:
      - "8080:80"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
    depends_on:
      - backend
```

‚ö†Ô∏è –û–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ:

* backend **–±–µ–∑ ports**
* nginx ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
* `depends_on` ‚â† –æ–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞

---

### –®–∞–≥ 5. –ó–∞–ø—É—Å–∫ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (15 –º–∏–Ω—É—Ç)

1. –ó–∞–ø—É—Å–∫ —Å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ–º:

```bash
docker compose up --build --scale backend=3
```

2. –ü—Ä–æ–≤–µ—Ä–∫–∞:

```bash
curl localhost:8080
curl localhost:8080
curl localhost:8080
```

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

```text
Hello from container: backend-1
Hello from container: backend-2
Hello from container: backend-3
```

üéâ –ú–æ–º–µ–Ω—Ç ¬´–º–∞–≥–∏–∏¬ª

---

## üîç –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å (15 –º–∏–Ω—É—Ç)

### –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 1: –ø–∞–¥–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```bash
docker stop backend-2
```

* –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
* –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏—Å–∫–ª—é—á–∞–µ—Ç—Å—è –∏–∑ round-robin

–û–±—Å—É–∂–¥–µ–Ω–∏–µ:

* Nginx –Ω–µ –∑–Ω–∞–µ—Ç, *–ø–æ—á–µ–º—É* –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–æ–ø–∞–ª
* –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—Å—Ç–∞—ë—Ç —Å–ª–∞—Ç—å —Ç—Ä–∞—Ñ–∏–∫

---

### –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 2: –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –ª–µ—Ç—É

```bash
docker compose up --scale backend=5
```

* Nginx –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—á–∏–Ω–∞–µ—Ç —Å–ª–∞—Ç—å —Ç—Ä–∞—Ñ–∏–∫ –Ω–æ–≤—ã–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º

---

## üß† –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã (10 –º–∏–Ω—É—Ç)

–§–∏–∫—Å–∏—Ä—É–µ–º:

* load balancer —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
* Nginx + Docker Compose = —Ä–∞–±–æ—á–∞—è –º–æ–¥–µ–ª—å
* service name = DNS
* —ç—Ç–æ **—Ä—É—á–Ω–∞—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è**

–ü–æ–¥–≤–æ–¥–∫–∞:

> –í Kubernetes –≤—Å—ë —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–æ üòâ

---

## üß™ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è

### –õ—ë–≥–∫–æ–µ

* –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç nginx
* –∏–∑–º–µ–Ω–∏—Ç—å —Ç–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞ backend

### –°—Ä–µ–¥–Ω–µ–µ

* –≤–∫–ª—é—á–∏—Ç—å `least_conn`

```nginx
upstream backend {
    least_conn;
    server backend:5000;
}
```

### –°–ª–æ–∂–Ω–æ–µ ‚≠ê

* –¥–æ–±–∞–≤–∏—Ç—å `healthcheck`
* –∏—Å–∫–ª—é—á–∞—Ç—å ¬´–±–æ–ª—å–Ω—ã–µ¬ª –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

---

## üìù –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ

**–í–∞—Ä–∏–∞–Ω—Ç 1:**
–°—Ö–µ–º–∞—Ç–∏—á–Ω–æ –Ω–∞—Ä–∏—Å–æ–≤–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É:

```
Client ‚Üí Nginx ‚Üí Backend replicas
```

**–í–∞—Ä–∏–∞–Ω—Ç 2 (–ø—Ä–∞–∫—Ç–∏–∫–∞):**

* –¥–æ–±–∞–≤–∏—Ç—å –≤—Ç–æ—Ä–æ–π backend endpoint `/slow`
* –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –∫–∞–∫ –º–µ–Ω—è–µ—Ç—Å—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞

---

## üë®‚Äçüè´ –ú–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã

* –¥–∞–π—Ç–µ —Å—Ç—É–¥–µ–Ω—Ç–∞–º —Å–∞–º–∏–º –¥–æ–≥–∞–¥–∞—Ç—å—Å—è, —á—Ç–æ `backend` ‚Äî —ç—Ç–æ DNS
* –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–¥–∏–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä ¬´–Ω–∞ –≥–ª–∞–∑–∞—Ö¬ª
* –Ω–µ —É–≥–ª—É–±–ª—è–π—Ç–µ—Å—å –ø–æ–∫–∞ –≤ Kubernetes ‚Äî –ø—É—Å—Ç—å Compose ¬´–¥–æ–∂–∏–≤—ë—Ç —Å–≤–æ—ë¬ª

---

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, –¥–∞–ª—å—à–µ –º–æ–≥—É:

* —Å–¥–µ–ª–∞—Ç—å **–∑–∞–Ω—è—Ç–∏–µ 5 (resource limits + docker stats)**
* –æ—Ñ–æ—Ä–º–∏—Ç—å **–≤—Å–µ –∑–∞–Ω—è—Ç–∏—è –≤ –µ–¥–∏–Ω—ã–π —É—á–µ–±–Ω—ã–π –º–æ–¥—É–ª—å**
* –∏–ª–∏ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ **–ª–∞–±—ã —Å –ø—Ä–æ–≤–µ—Ä—è–µ–º—ã–º–∏ –∫—Ä–∏—Ç–µ—Ä–∏—è–º–∏**
