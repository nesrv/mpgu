–û—Ç–ª–∏—á–Ω–æ, –ª–æ–≥–∏—á–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º üí™
–ù–∏–∂–µ ‚Äî  **–ø–æ–¥—Ä–æ–±–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –∑–∞–Ω—è—Ç–∏—è 5** , –≥–¥–µ —Å—Ç—É–¥–µ–Ω—Ç—ã –≤–ø–µ—Ä–≤—ã–µ **–≤–∏–¥—è—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤** –∏ –ø–æ–Ω–∏–º–∞—é—Ç, –∑–∞—á–µ–º –æ–Ω–∏ –≤–æ–æ–±—â–µ –Ω—É–∂–Ω—ã –≤ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏.

---

# –°—Ü–µ–Ω–∞—Ä–∏–π –∑–∞–Ω—è—Ç–∏—è 5

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (CPU –∏ –ø–∞–º—è—Ç—å) –≤ Docker Compose

---

## üéØ –¶–µ–ª–∏ –∑–∞–Ω—è—Ç–∏—è

–°—Ç—É–¥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω:

* –ø–æ–Ω–∏–º–∞—Ç—å, –∑–∞—á–µ–º –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
* —É–º–µ—Ç—å –∑–∞–¥–∞–≤–∞—Ç—å –ª–∏–º–∏—Ç—ã CPU –∏ –ø–∞–º—è—Ç–∏
* –Ω–∞–±–ª—é–¥–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π
* —É–≤–∏–¥–µ—Ç—å, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤

---

## üß† –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å (20 –º–∏–Ω—É—Ç)

### 1. –ü–æ—á–µ–º—É —Ä–µ—Å—É—Ä—Å—ã ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã

–û–±—Å—É–∂–¥–µ–Ω–∏–µ:

* –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–µ–ª—è—Ç —Ä–µ—Å—É—Ä—Å—ã —Ö–æ—Å—Ç–∞
* –æ–¥–∏–Ω ¬´–ø—Ä–æ–∂–æ—Ä–ª–∏–≤—ã–π¬ª —Å–µ—Ä–≤–∏—Å –º–æ–∂–µ—Ç –ø–æ–ª–æ–∂–∏—Ç—å –≤—Å—ë –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
* –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è ‚Äî –±–∞–∑–æ–≤–∞—è –∑–∞—â–∏—Ç–∞

–ü–æ–Ω—è—Ç–∏—è:

* CPU limit
* Memory limit
* OOM (Out Of Memory)

---

### 2. –ö–∞–∫ Docker –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã

–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:

* cgroups (–±–µ–∑ —É–≥–ª—É–±–ª–µ–Ω–∏—è)
* Docker ‚Üí Linux kernel
* Compose  **–Ω–µ —É–ø—Ä–∞–≤–ª—è–µ—Ç** , –∞ **–æ–ø–∏—Å—ã–≤–∞–µ—Ç** –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

–í–∞–∂–Ω–æ:

* –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –∏ –±–µ–∑ Kubernetes
* –≤ –ø—Ä–æ–¥–µ –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –µ—Å—Ç—å –ª–∏–º–∏—Ç—ã

---

### 3. –ì–¥–µ –∑–∞–¥–∞—é—Ç—Å—è –ª–∏–º–∏—Ç—ã –≤ Docker Compose

–û–±—ä—è—Å–Ω–∏—Ç—å –∞–∫–∫—É—Ä–∞—Ç–Ω–æ ‚ö†Ô∏è:

```yaml
deploy:
  resources:
    limits:
      cpus: "0.5"
      memory: 256M
```

üìå –û–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ:

* `deploy` –≤ Compose **—á–∞—Å—Ç–∏—á–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è**
* –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å—Ä–µ–¥—ã ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç
* –≤ Swarm / k8s ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ

---

## üß™ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å (55 –º–∏–Ω—É—Ç)

### –®–∞–≥ 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ (5 –º–∏–Ω—É—Ç)

–ë–µ—Ä—ë–º –ø—Ä–æ–µ–∫—Ç —Å –∑–∞–Ω—è—Ç–∏—è 4:

```text
project/
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ nginx/
‚îî‚îÄ‚îÄ app/
```

---

### –®–∞–≥ 2. Backend —Å –Ω–∞–≥—Ä—É–∑–∫–æ–π (15 –º–∏–Ω—É—Ç)

**app.py**

```python
from flask import Flask
import socket
import time

app = Flask(__name__)

@app.route("/")
def hello():
    return f"Hello from {socket.gethostname()}\n"

@app.route("/cpu")
def cpu_load():
    x = 0
    for i in range(10**7):
        x += i
    return f"CPU load done on {socket.gethostname()}\n"

@app.route("/memory")
def memory_load():
    data = []
    try:
        for i in range(10**6):
            data.append("X" * 1024)
    except MemoryError:
        return "MemoryError!\n"
    return "Memory allocated\n"

if __name__ == "__main__":
    app.run(host="0.0.0.0", port=5000)
```

–û–±—Å—É–¥–∏—Ç—å:

* `/cpu` –≥—Ä—É–∑–∏—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä
* `/memory` –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –µ—Å—Ç –ø–∞–º—è—Ç—å

---

### –®–∞–≥ 3. Docker Compose —Å –ª–∏–º–∏—Ç–∞–º–∏ (15 –º–∏–Ω—É—Ç)

```yaml
version: "3.9"

services:
  backend:
    build: ./app
    deploy:
      resources:
        limits:
          cpus: "0.5"
          memory: 256M

  nginx:
    image: nginx:alpine
    ports:
      - "8080:80"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
    depends_on:
      - backend
```

‚ö†Ô∏è –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≥–æ–≤–æ—Ä–∏—Ç—å:

* –ª–∏–º–∏—Ç—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ **–∫–∞–∂–¥–æ–π —Ä–µ–ø–ª–∏–∫–µ**
* 3 —Ä–µ–ø–ª–∏–∫–∏ √ó 256MB ‚â† 256MB

---

### –®–∞–≥ 4. –ó–∞–ø—É—Å–∫ –∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ (20 –º–∏–Ω—É—Ç)

1. –ó–∞–ø—É—Å–∫:

```bash
docker compose up --build --scale backend=2
```

2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:

```bash
docker stats
```

3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏:

```bash
curl localhost:8080/cpu
curl localhost:8080/memory
```

–ù–∞–±–ª—é–¥–µ–Ω–∏—è:

* CPU –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ª–∏–º–∏—Ç
* –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–∂–µ—Ç –±—ã—Ç—å —É–±–∏—Ç –ø–æ OOM
* Nginx –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 502, –µ—Å–ª–∏ backend —É–º–µ—Ä

---

## üîç –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å (15 –º–∏–Ω—É—Ç)

### –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 1: –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏

* –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å–æ–≤ `/memory`
* –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏–ª–∏ —É–º–∏—Ä–∞–µ—Ç

–ö–æ–º–∞–Ω–¥–∞:

```bash
docker compose ps
```

---

### –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 2: –±–µ–∑ –ª–∏–º–∏—Ç–æ–≤

* —É–±—Ä–∞—Ç—å `deploy.resources`
* –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
* –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É

–û–±—Å—É–∂–¥–µ–Ω–∏–µ:

* —Å–∏—Å—Ç–µ–º–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç ¬´—Ç–æ—Ä–º–æ–∑–∏—Ç—å¬ª
* —Å—Ç—Ä–∞–¥–∞—é—Ç –¥—Ä—É–≥–∏–µ —Å–µ—Ä–≤–∏—Å—ã

---

## üß† –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã (10 –º–∏–Ω—É—Ç)

–§–∏–∫—Å–∏—Ä—É–µ–º:

* –ª–∏–º–∏—Ç—ã ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã
* CPU –ª–∏–º–∏—Ç ‚Üí –∑–∞–º–µ–¥–ª–µ–Ω–∏–µ
* Memory –ª–∏–º–∏—Ç ‚Üí —É–±–∏–π—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
* –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –Ω–µ —Å–ø–∞—Å–∞–µ—Ç –æ—Ç OOM

–°–≤—è–∑—å —Å —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å—é:

> –ò–º–µ–Ω–Ω–æ —Ç–∞–∫ ¬´–ø–∞–¥–∞—é—Ç¬ª —Å–µ—Ä–≤–∏—Å—ã –≤ –ø—Ä–æ–¥–µ üò¨

---

## üß™ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è

### –õ—ë–≥–∫–æ–µ

* –∏–∑–º–µ–Ω–∏—Ç—å –ª–∏–º–∏—Ç—ã
* –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–∞–∑–Ω–∏—Ü—É

### –°—Ä–µ–¥–Ω–µ–µ

* –∑–∞–¥–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –ª–∏–º–∏—Ç—ã –¥–ª—è backend –∏ nginx
* —Å—Ä–∞–≤–Ω–∏—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ

### –°–ª–æ–∂–Ω–æ–µ ‚≠ê

* —Å–¥–µ–ª–∞—Ç—å —Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π  **—Å–∞–º –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç** , —á—Ç–æ –µ–º—É –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –ø–∞–º—è—Ç–∏
* –≤–µ—Ä–Ω—É—Ç—å –æ—Å–º—ã—Å–ª–µ–Ω–Ω—É—é –æ—à–∏–±–∫—É

---

## üìù –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ

**–í–∞—Ä–∏–∞–Ω—Ç 1 (—Ç–µ–æ—Ä–∏—è):**
–ü–æ—á–µ–º—É –ª—É—á—à–µ —É–±–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, —á–µ–º –ø–æ–∑–≤–æ–ª–∏—Ç—å –µ–º—É —Å—ä–µ—Å—Ç—å –≤—Å—é –ø–∞–º—è—Ç—å?

**–í–∞—Ä–∏–∞–Ω—Ç 2 (–ø—Ä–∞–∫—Ç–∏–∫–∞):**

* –∑–∞–¥–∞—Ç—å –ª–∏–º–∏—Ç 128MB
* –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –º–æ–º–µ–Ω—Ç –ø–∞–¥–µ–Ω–∏—è

---

## üë®‚Äçüè´ –ú–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã

* –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–π—Ç–µ `docker stats` –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
* –¥–∞–π—Ç–µ —Å—Ç—É–¥–µ–Ω—Ç–∞–º ¬´—Å–ª–æ–º–∞—Ç—å¬ª –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
* –ø–æ–¥—á–µ—Ä–∫–Ω–∏—Ç–µ: Compose ‚â† Kubernetes, –Ω–æ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ç–µ –∂–µ

---

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, —Å–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –º–æ–≥—É:

* —Å–¥–µ–ª–∞—Ç—å **—Å—Ü–µ–Ω–∞—Ä–∏–π 6 (restart policy + healthcheck)**
* –∏–ª–∏ –æ—Ñ–æ—Ä–º–∏—Ç—å **–≤–µ—Å—å –∫—É—Ä—Å –∫–∞–∫ –≥–æ—Ç–æ–≤—É—é —É—á–µ–±–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É**
