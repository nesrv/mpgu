<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞: –ü–æ–∏—Å–∫–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∫–∞—Ç–∞–ª–æ–≥–∞ —Ç–æ–≤–∞—Ä–æ–≤</title>
<style media="print">
        body { font-family: Arial, sans-serif; font-size: 12px; }
        .container { box-shadow: none; background: white; }
        .header { background: white !important; color: black !important; }
        .save-btn { display: none !important; }
        .section { page-break-inside: avoid; }
        input, textarea { border: 1px solid #ccc; background: white; color: black; }
        .code-block { background: white !important; color: black !important; border: 1px solid #ccc; }
    </style>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: white;
            margin-top: 20px;
            margin-bottom: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .header {
            text-align: center;
            padding: 30px 0;
            background: linear-gradient(135deg, #005EB8 0%, #003D82 100%);
            color: white;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .student-info {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #003D82;
        }

        .form-group input, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus, .form-group textarea:focus {
            outline: none;
            border-color: #005EB8;
            box-shadow: 0 0 0 3px rgba(0, 94, 184, 0.1);
        }

        .form-group textarea {
            min-height: auto;
            resize: vertical;
        }

        .section textarea.code-textarea {
            min-height: 300px;
        }

        .code-textarea {
            font-family: 'Courier New', monospace;
            background: #2d3748;
            color: #e2e8f0;
            white-space: pre;
            tab-size: 4;
        }

        .section {
            margin-bottom: 40px;
            padding: 25px;
            background: #fff;
            border-left: 5px solid #005EB8;
            border-radius: 0 10px 10px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .section h2 {
            color: #003D82;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .section h3 {
            color: #005EB8;
            margin: 20px 0 10px 0;
            font-size: 1.3em;
        }

        .section h4 {
            color: #555;
            margin: 15px 0 10px 0;
            font-size: 1.1em;
        }

        .code-block {
            background: #282c34;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            white-space: pre;
            font-size: 14px;
            line-height: 1.5;
        }

        ul {
            list-style: none;
            padding-left: 0;
        }

        ul li {
            padding: 8px 0 8px 30px;
            position: relative;
        }

        ul li::before {
            content: '‚ñ∏';
            position: absolute;
            left: 0;
            color: #005EB8;
            font-size: 18px;
            font-weight: bold;
        }

        .save-btn {
            background: linear-gradient(135deg, #005EB8, #003D82);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 10px;
            cursor: pointer;
            display: block;
            margin: 30px auto;
            transition: transform 0.3s;
        }

        .save-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 94, 184, 0.3);
        }

        .checkbox-item {
            margin: 15px 0;
            padding: 15px 20px;
            background: linear-gradient(135deg, #005EB8 0%, #003D82 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .checkbox-item:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0, 94, 184, 0.3);
        }

        .checkbox-item input[type="checkbox"] {
            appearance: none;
            width: 24px;
            height: 24px;
            border: 3px solid white;
            border-radius: 6px;
            margin-right: 15px;
            cursor: pointer;
            position: relative;
            background: transparent;
            transition: all 0.3s;
        }

        .checkbox-item input[type="checkbox"]:checked {
            background: white;
        }

        .checkbox-item input[type="checkbox"]:checked::after {
            content: '‚úì';
            position: absolute;
            top: -2px;
            left: 4px;
            font-size: 18px;
            color: #005EB8;
            font-weight: bold;
        }

        .checkbox-item label {
            color: white;
            font-weight: 500;
            cursor: pointer;
            user-select: none;
        }

        @media (max-width: 768px) {
            .student-info {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîç –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞</h1>
            <h2>–ü–æ–∏—Å–∫–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∫–∞—Ç–∞–ª–æ–≥–∞ —Ç–æ–≤–∞—Ä–æ–≤</h2>
            <p>PostgreSQL + OpenSearch + FastAPI</p>
        </div>

        <div class="student-info">
            <div class="form-group">
                <label for="student-name">–§–ò–û —Å—Ç—É–¥–µ–Ω—Ç–∞:</label>
                <input type="text" id="student-name" placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á">
            </div>
            <div class="form-group">
                <label for="group">–ì—Ä—É–ø–ø–∞:</label>
                <input type="text" id="group" placeholder="–ò–°–¢-401">
            </div>
            <div class="form-group">
                <label for="date">–î–∞—Ç–∞:</label>
                <input type="date" id="date">
            </div>
        </div>

        <div class="section">
            <h2>üéØ –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã</h2>
            <p>–°–æ–∑–¥–∞—Ç—å API –¥–ª—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ —Å –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–º –ø–æ–∏—Å–∫–æ–º –Ω–∞ –±–∞–∑–µ PostgreSQL, OpenSearch –∏ FastAPI.</p>
            
            <h3>–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã</h3>
            <div class="code-block">FastAPI (REST API)
    ‚Üì
PostgreSQL (–æ—Å–Ω–æ–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ)
    ‚Üì
OpenSearch (–ø–æ–∏—Å–∫–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å)</div>
        </div>

        <div class="section">
            <h2>üìã –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è</h2>
            
            <h3>1.1. –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞</h3>
            <div class="code-block">mkdir lab1_product_search
cd lab1_product_search</div>
            
            <h3>1.2. –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ Python</h3>
            <div class="code-block"># Windows
python -m venv venv
venv\Scripts\activate

# Linux/Mac
python -m venv venv
source venv/bin/activate</div>
            
            <div class="checkbox-item">
                <input type="checkbox" id="task-env">
                <label for="task-env">–û–∫—Ä—É–∂–µ–Ω–∏–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ</label>
            </div>
        </div>

        <div class="section">
            <h2>üê≥ –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã</h2>
            
            <h3>2.1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª docker-compose.yml</h3>
            <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> –≠—Ç–æ—Ç —Ñ–∞–π–ª –æ–ø–∏—Å—ã–≤–∞–µ—Ç –¥–≤–∞ —Å–µ—Ä–≤–∏—Å–∞ - PostgreSQL –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –∏ OpenSearch –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞.</p>
            
            <div class="code-block">services:
  postgres:
    image: postgres:18
    env_file: .env
    ports:
      - "5437:5432"
    volumes:
      - postgres_data:/var/lib/postgresql

  opensearch:
    image: opensearchproject/opensearch:2.11.0
    env_file: .env
    ports:
      - "9200:9200"
    volumes:
      - opensearch_data:/usr/share/opensearch/data

volumes:
  postgres_data:
  opensearch_data:</div>

            <h3>2.2. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª .env</h3>
            <div class="code-block"># PostgreSQL
POSTGRES_DB=shop
POSTGRES_USER=user
POSTGRES_PASSWORD=password

# OpenSearch
discovery.type=single-node
OPENSEARCH_JAVA_OPTS=-Xms512m -Xmx512m
DISABLE_SECURITY_PLUGIN=true</div>

            <p><strong>–ü–æ—è—Å–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:</strong></p>
            <ul>
                <li><strong>discovery.type=single-node</strong> - OpenSearch —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ –æ–¥–Ω–æ–≥–æ —É–∑–ª–∞ (–±–µ–∑ –∫–ª–∞—Å—Ç–µ—Ä–∞)</li>
                <li><strong>OPENSEARCH_JAVA_OPTS</strong> - –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –ø–∞–º—è—Ç—å Java: –º–∏–Ω–∏–º—É–º –∏ –º–∞–∫—Å–∏–º—É–º –ø–æ 512 –ú–ë</li>
                <li><strong>DISABLE_SECURITY_PLUGIN=true</strong> - –æ—Ç–∫–ª—é—á–∞–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏</li>
            </ul>

            <h3>2.3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã</h3>
            <div class="code-block">docker-compose up -d

# –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å
docker-compose down -v && docker-compose up -d</div>

            <h3>2.4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å–µ—Ä–≤–∏—Å–æ–≤</h3>
            <div class="code-block"># PostgreSQL
docker ps | grep postgres

# OpenSearch (—á–µ—Ä–µ–∑ WSL –∏–ª–∏ Git Bash)
curl http://localhost:9200</div>
            
            <div class="checkbox-item">
                <input type="checkbox" id="task-docker">
                <label for="task-docker">–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø—É—â–µ–Ω–∞</label>
            </div>
        </div>

        <div class="section">
            <h2>üì¶ –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π Python</h2>
            
            <h3>3.1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª requirements.txt</h3>
            <div class="code-block">fastapi==0.109.0
uvicorn==0.27.0
sqlalchemy==2.0.36
psycopg2-binary==2.9.10
opensearch-py==2.4.2
pydantic==2.10.5</div>

            <h3>3.2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏</h3>
            <div class="code-block">pip install -r requirements.txt</div>
            
            <div class="checkbox-item">
                <input type="checkbox" id="task-deps">
                <label for="task-deps">–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã</label>
            </div>
        </div>

        <div class="section">
            <h2>üíæ –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö PostgreSQL</h2>
            
            <h3>4.1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª database.py</h3>
            <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> –ó–¥–µ—Å—å –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL —á–µ—Ä–µ–∑ SQLAlchemy –∏ –º–æ–¥–µ–ª—å —Ç–∞–±–ª–∏—Ü—ã products.</p>
            
            <div class="code-block">from sqlalchemy import create_engine, Column, Integer, String, Float, Text
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import sessionmaker

DATABASE_URL = "postgresql://user:password@localhost:5432/shop"

engine = create_engine(DATABASE_URL)
SessionLocal = sessionmaker(bind=engine)
Base = declarative_base()

class Product(Base):
    __tablename__ = "products"
    
    id = Column(Integer, primary_key=True, index=True)
    name = Column(String(255), nullable=False)
    description = Column(Text)
    price = Column(Float, nullable=False)
    category = Column(String(100), nullable=False)
    popularity = Column(Integer, default=0)

def get_db():
    db = SessionLocal()
    try:
        yield db
    finally:
        db.close()</div>

            <p><strong>–ü–æ—è—Å–Ω–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:</strong></p>
            <ul>
                <li><strong>engine</strong> - –¥–≤–∏–∂–æ–∫ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î</li>
                <li><strong>SessionLocal</strong> - —Ñ–∞–±—Ä–∏–∫–∞ —Å–µ—Å—Å–∏–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î</li>
                <li><strong>Product</strong> - ORM –º–æ–¥–µ–ª—å —Ç–∞–±–ª–∏—Ü—ã —Ç–æ–≤–∞—Ä–æ–≤</li>
                <li><strong>get_db()</strong> - dependency –¥–ª—è FastAPI, —Å–æ–∑–¥–∞–µ—Ç –∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–µ—Å—Å–∏—é</li>
            </ul>
            
            <div class="checkbox-item">
                <input type="checkbox" id="task-db">
                <label for="task-db">–ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞</label>
            </div>
        </div>

        <div class="section">
            <h2>üîç –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenSearch</h2>
            
            <h3>5.1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª opensearch_client.py</h3>
            <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> –†–µ–∞–ª–∏–∑—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ OpenSearch, —Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ —Å –º–∞–ø–ø–∏–Ω–≥–æ–º –ø–æ–ª–µ–π –∏ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞.</p>
            
            <div class="code-block">from opensearchpy import OpenSearch

client = OpenSearch(
    hosts=[{'host': 'localhost', 'port': 9200}],
    http_auth=None,
    use_ssl=False,
    verify_certs=False
)

INDEX_NAME = "products"

INDEX_MAPPING = {
    "mappings": {
        "properties": {
            "id": {"type": "integer"},
            "name": {
                "type": "text",  # –ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
                "fields": {
                    "keyword": {"type": "keyword"},  # –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
                    "suggest": {"type": "completion"}  # –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
                }
            },
            "description": {"type": "text"},  # –ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é
            "price": {"type": "float"},  # –ß–∏—Å–ª–æ–≤–æ–µ –ø–æ–ª–µ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
            "category": {"type": "keyword"},  # –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤
            "popularity": {"type": "integer"}  # –ß–∏—Å–ª–æ–≤–æ–µ –ø–æ–ª–µ –¥–ª—è —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è
        }
    }
}

def create_index():
    if not client.indices.exists(index=INDEX_NAME):
        client.indices.create(index=INDEX_NAME, body=INDEX_MAPPING)

def index_product(product):
    doc = {
        "id": product.id,
        "name": product.name,
        "description": product.description,
        "price": product.price,
        "category": product.category,
        "popularity": product.popularity
    }
    client.index(index=INDEX_NAME, id=product.id, body=doc)</div>

            <h3>–§—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤</h3>
            <div class="code-block">def search_products(query, category=None, min_price=None, max_price=None):
    must = []
    filters = []
    
    if query:
        must.append({
            "multi_match": {
                "query": query,
                "fields": ["name^3", "description"],
                "type": "best_fields"
            }
        })
    
    if category:
        filters.append({"term": {"category": category}})
    
    if min_price or max_price:
        range_filter = {"range": {"price": {}}}
        if min_price:
            range_filter["range"]["price"]["gte"] = min_price
        if max_price:
            range_filter["range"]["price"]["lte"] = max_price
        filters.append(range_filter)
    
    body = {
        "query": {
            "bool": {
                "must": must if must else [{"match_all": {}}],
                "filter": filters
            }
        },
        "aggs": {
            "categories": {"terms": {"field": "category"}},
            "price_ranges": {
                "range": {
                    "field": "price",
                    "ranges": [
                        {"to": 1000},
                        {"from": 1000, "to": 5000},
                        {"from": 5000}
                    ]
                }
            }
        }
    }
    
    return client.search(index=INDEX_NAME, body=body)</div>

            <h3>–§—É–Ω–∫—Ü–∏—è –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è</h3>
            <div class="code-block">def suggest_products(prefix):
    body = {
        "query": {
            "match_phrase_prefix": {
                "name": prefix
            }
        },
        "_source": ["name"],
        "size": 5
    }
    return client.search(index=INDEX_NAME, body=body)</div>

            <p><strong>–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:</strong></p>
            <ul>
                <li><strong>name^3</strong> - boost (—É—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤–µ—Å) –¥–ª—è –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞</li>
                <li><strong>multi_match</strong> - –ø–æ–∏—Å–∫ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ø–æ–ª—è–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ</li>
                <li><strong>bool query</strong> - –∫–æ–º–±–∏–Ω–∏—Ä—É–µ—Ç —É—Å–ª–æ–≤–∏—è –ø–æ–∏—Å–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä—ã</li>
                <li><strong>aggregations</strong> - –ø–æ–¥—Å—á–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ —Ü–µ–Ω–æ–≤—ã–º –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º</li>
            </ul>
            
            <div class="checkbox-item">
                <input type="checkbox" id="task-opensearch">
                <label for="task-opensearch">OpenSearch –Ω–∞—Å—Ç—Ä–æ–µ–Ω</label>
            </div>
        </div>

        <div class="section">
            <h2>üìù –®–∞–≥ 6: –°–æ–∑–¥–∞–Ω–∏–µ Pydantic —Å—Ö–µ–º</h2>
            
            <h3>6.1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª schemas.py</h3>
            <div class="code-block">from pydantic import BaseModel

class ProductCreate(BaseModel):
    name: str
    description: str
    price: float
    category: str
    popularity: int = 0

class ProductResponse(BaseModel):
    id: int
    name: str
    description: str
    price: float
    category: str
    popularity: int

    class Config:
        from_attributes = True</div>

            <p><strong>–ü–æ—è—Å–Ω–µ–Ω–∏–µ:</strong></p>
            <ul>
                <li><strong>ProductCreate</strong> - —Å—Ö–µ–º–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ (–±–µ–∑ id)</li>
                <li><strong>ProductResponse</strong> - —Å—Ö–µ–º–∞ –¥–ª—è –æ—Ç–≤–µ—Ç–∞ API (—Å id)</li>
                <li><strong>from_attributes = True</strong> - –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å Pydantic –º–æ–¥–µ–ª–∏ –∏–∑ ORM –æ–±—ä–µ–∫—Ç–æ–≤</li>
            </ul>
            
            <div class="checkbox-item">
                <input type="checkbox" id="task-schemas">
                <label for="task-schemas">–°—Ö–µ–º—ã —Å–æ–∑–¥–∞–Ω—ã</label>
            </div>
        </div>

        <div class="section">
            <h2>üöÄ –®–∞–≥ 7: –°–æ–∑–¥–∞–Ω–∏–µ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</h2>
            
            <h3>7.1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª main.py</h3>
            <div class="code-block">from fastapi import FastAPI, Depends, HTTPException
from sqlalchemy.orm import Session
from typing import Optional
from database import get_db, Product
from schemas import ProductCreate, ProductResponse
import opensearch_client as os_client

app = FastAPI(title="Product Search API")

@app.post("/products", response_model=ProductResponse)
def create_product(product: ProductCreate, db: Session = Depends(get_db)):
    # –°–æ–∑–¥–∞–µ–º —Ç–æ–≤–∞—Ä –≤ PostgreSQL
    db_product = Product(**product.dict())
    db.add(db_product)
    db.commit()
    db.refresh(db_product)
    # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Å OpenSearch –¥–ª—è –ø–æ–∏—Å–∫–∞
    os_client.index_product(db_product)
    return db_product

@app.get("/products/{product_id}", response_model=ProductResponse)
def get_product(product_id: int, db: Session = Depends(get_db)):
    product = db.query(Product).filter(Product.id == product_id).first()
    if not product:
        raise HTTPException(status_code=404, detail="Product not found")
    return product

@app.get("/search")
def search(
    q: Optional[str] = None,
    category: Optional[str] = None,
    min_price: Optional[float] = None,
    max_price: Optional[float] = None
):
    # –í—ã–ø–æ–ª–Ω—è–µ–º –ø–æ–∏—Å–∫ –≤ OpenSearch
    results = os_client.search_products(q, category, min_price, max_price)
    return {
        "hits": [hit["_source"] for hit in results["hits"]["hits"]],
        "total": results["hits"]["total"]["value"],
        "aggregations": results.get("aggregations", {})
    }

@app.get("/suggest")
def suggest(q: str):
    # –ü–æ–ª—É—á–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫–∏ –∏–∑ OpenSearch
    results = os_client.suggest_products(q)
    options = results.get("suggest", {}).get("product-suggest", [{}])[0].get("options", [])
    return {"suggestions": [s["text"] for s in options]}</div>

            <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤:</strong></p>
            <ul>
                <li><strong>POST /products</strong> - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ PostgreSQL –∏ –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç –≤ OpenSearch)</li>
                <li><strong>GET /products/{id}</strong> - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –ø–æ ID –∏–∑ PostgreSQL</li>
                <li><strong>GET /search</strong> - –ø–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏—è–º–∏</li>
                <li><strong>GET /suggest</strong> - –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤</li>
            </ul>
            
            <div class="checkbox-item">
                <input type="checkbox" id="task-fastapi">
                <label for="task-fastapi">FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ</label>
            </div>
        </div>

        <div class="section">
            <h2>üîß –®–∞–≥ 8: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö</h2>
            
            <h3>8.1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª init_db.py</h3>
            <div class="code-block"><code class="language-python">from database import Base, engine, SessionLocal, Product
import opensearch_client as os_client

def init():
    Base.metadata.create_all(bind=engine)
    os_client.create_index()
    
    db = SessionLocal()
    
    # –ò–Ω–¥–µ–∫—Å–∏—Ä—É–µ–º –≤—Å–µ —Ç–æ–≤–∞—Ä—ã –≤ OpenSearch
    for product in db.query(Product).all():
        os_client.index_product(product)
    
    if db.query(Product).count() == 0:
        products = [
            Product(name="iPhone 15 Pro", description="–°–º–∞—Ä—Ç—Ñ–æ–Ω Apple —Å —á–∏–ø–æ–º A17 Pro, 256 –ì–ë", 
                    price=119990, category="–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã", popularity=100),
            Product(name="Samsung Galaxy S24 Ultra", description="–§–ª–∞–≥–º–∞–Ω—Å–∫–∏–π —Å–º–∞—Ä—Ç—Ñ–æ–Ω Samsung —Å S Pen", 
                    price=109990, category="–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã", popularity=95),
            Product(name="MacBook Pro 14", description="–ù–æ—É—Ç–±—É–∫ Apple M3 Pro, 18 –ì–ë, 512 –ì–ë SSD", 
                    price=219990, category="–ù–æ—É—Ç–±—É–∫–∏", popularity=90),
            Product(name="AirPods Pro 2", description="–ë–µ—Å–ø—Ä–æ–≤–æ–¥–Ω—ã–µ –Ω–∞—É—à–Ω–∏–∫–∏ —Å —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ–º", 
                    price=24990, category="–ù–∞—É—à–Ω–∏–∫–∏", popularity=95),
        ]
        
        for product in products:
            db.add(product)
            db.commit()
            db.refresh(product)
            os_client.index_product(product)
    
    db.close()
    print("–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞!")

if __name__ == "__main__":
    init()</code></div>

            <h3>8.2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é</h3>
            <div class="code-block">python init_db.py</div>
            
            <div class="checkbox-item">
                <input type="checkbox" id="task-init">
                <label for="task-init">–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞</label>
            </div>
        </div>

        <div class="section">
            <h2>üß™ –®–∞–≥ 9: –ó–∞–ø—É—Å–∫ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</h2>
            
            <h3>9.1. –ó–∞–ø—É—Å—Ç–∏—Ç—å FastAPI —Å–µ—Ä–≤–µ—Ä</h3>
            <div class="code-block">uvicorn main:app --reload</div>
            
            <h3>9.2. –û—Ç–∫—Ä—ã—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é API</h3>
            <p>–ü–µ—Ä–µ–π—Ç–∏ –ø–æ –∞–¥—Ä–µ—Å—É: <strong>http://localhost:8000/docs</strong></p>
            <p>Swagger UI –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ.</p>
            
            <h3>9.3. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª test_api.http –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
            <p><strong>–£—Å—Ç–∞–Ω–æ–≤–∫–∞:</strong> –í VS Code —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ "REST Client"</p>
            
            <div class="code-block" style="color: #ffffff !important;">### –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ - –ø–æ–∏—Å–∫ iPhone
GET http://localhost:8000/suggest?q=iph

### –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ - –ø–æ–∏—Å–∫ Samsung
GET http://localhost:8000/suggest?q=sam

### –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ - –ø–æ–∏—Å–∫ MacBook
GET http://localhost:8000/suggest?q=mac

### –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ - —Ç–µ–∫—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
GET http://localhost:8000/search?q=phone

### –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ - —Ñ–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
GET http://localhost:8000/search?category=–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã

### –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ü–µ–Ω–µ
GET http://localhost:8000/search?min_price=50000&max_price=100000

### –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ - –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã
GET http://localhost:8000/search?q=samsung&category=–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã&min_price=80000

### –ü–æ–∏—Å–∫ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤
GET http://localhost:8000/search

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
POST http://localhost:8000/products
Content-Type: application/json

{
  "name": "Test Product",
  "description": "Test Description",
  "price": 9999.99,
  "category": "Test Category",
  "popularity": 50
}

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –ø–æ ID
GET http://localhost:8000/products/1

### –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ç–æ–≤–∞—Ä–∞
GET http://localhost:8000/products/999</div>
            
            <div class="checkbox-item">
                <input type="checkbox" id="task-test">
                <label for="task-test">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</label>
            </div>
        </div>

        <div class="section">
            <h2>üìä –í—ã–≤–æ–¥—ã –ø–æ —Ä–∞–±–æ—Ç–µ</h2>

            <div class="form-group">
                <label>–ß—Ç–æ –∏–∑—É—á–∏–ª–∏ –≤ –¥–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ:</label>
                <textarea rows="4">–ü–µ—Ä–µ—á–∏—Å–ª–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏...</textarea>
            </div>

            <div class="form-group">
                <label>–ö–∞–∫–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –≤–æ–∑–Ω–∏–∫–ª–∏:</label>
                <textarea rows="4">–û–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –∫–∞–∫ –∏—Ö —Ä–µ—à–∏–ª–∏...</textarea>
            </div>

            <div class="form-group">
                <label>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:</label>
                <textarea rows="4">–ì–¥–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∑–Ω–∞–Ω–∏—è?</textarea>
            </div>
        </div>

        <button class="save-btn" onclick="saveToPDF()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ PDF</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/bash.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.code-block code').forEach(block => {
                hljs.highlightElement(block);
            });
            document.querySelectorAll('.code-block:not(:has(code))').forEach(block => {
                const code = document.createElement('code');
                code.className = 'language-python';
                code.textContent = block.textContent;
                block.textContent = '';
                block.appendChild(code);
                hljs.highlightElement(code);
            });
        });

        if (!sessionStorage.getItem('product-search-lab-loaded')) {
            localStorage.clear();
            sessionStorage.setItem('product-search-lab-loaded', 'true');
        }

        function loadFromStorage() {
            document.getElementById('student-name').value = localStorage.getItem('student-name') || '';
            document.getElementById('group').value = localStorage.getItem('group') || '';
            document.getElementById('date').value = localStorage.getItem('date') || new Date().toISOString().split('T')[0];
        }
        
        function saveToStorage() {
            localStorage.setItem('student-name', document.getElementById('student-name').value);
            localStorage.setItem('group', document.getElementById('group').value);
            localStorage.setItem('date', document.getElementById('date').value);
        }
        
        loadFromStorage();

        document.getElementById('student-name').addEventListener('input', saveToStorage);
        document.getElementById('group').addEventListener('input', saveToStorage);
        document.getElementById('date').addEventListener('change', saveToStorage);
        
        document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
            if (localStorage.getItem(checkbox.id) === 'true') checkbox.checked = true;
            checkbox.addEventListener('change', () => {
                localStorage.setItem(checkbox.id, checkbox.checked);
            });
        });

        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = textarea.scrollHeight + 'px';
        }

        document.querySelectorAll('textarea').forEach((textarea, index) => {
            const saved = localStorage.getItem('textarea-' + index);
            if (saved) textarea.value = saved;
            
            textarea.addEventListener('input', function() {
                autoResize(this);
                localStorage.setItem('textarea-' + index, textarea.value);
            });
            autoResize(textarea);
        });

        function saveToPDF() {
            const studentName = document.getElementById('student-name').value || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
            const group = document.getElementById('group').value || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
            const date = document.getElementById('date').value || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
            
            const originalTitle = document.title;
            document.title = `ProductSearch_Lab_${studentName}_${group}_${date}`;
            
            window.print();
            
            setTimeout(() => {
                document.title = originalTitle;
            }, 1000);
        }
    </script>
</body>
</html>
