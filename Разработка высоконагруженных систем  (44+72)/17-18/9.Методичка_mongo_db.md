# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ò–∑—É—á–µ–Ω–∏–µ mongodb

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞
```bash
cd LAB-REDIS-MONGO
```


### 2. –ü–æ–¥–Ω—è—Ç—å MongoDB –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker-compose.yml

```sh
services:
  mongodb:
    image: mongo:7
    env_file:
      - .env
    ports:
      - "27017:27017"
```


.env

```sh
MONGO_INITDB_ROOT_USERNAME=student
MONGO_INITDB_ROOT_PASSWORD=password

MONGODB_URL=mongodb://student:password@mongodb:27017/

```


### 3. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É MongoDB Compass 

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞
1. –°–∫–∞—á–∞—Ç—å —Å https://github.com/mongodb-js/compass/releases/download/v1.48.2/mongodb-compass-1.48.2-win32-x64.msi

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å MongoDB Compass

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
**Connection String:**
```
mongodb://student:password@localhost:27017/
```


### 4. –®–ø–∞—Ä–≥–∞–ª–∫–∞ –ø–æ —Ä–∞–±–æ—Ç–µ –≤ MongoDB Compass

#### üìå –ù–∞–≤–∏–≥–∞—Ü–∏—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
1. **–í—ã–±–æ—Ä –ë–î:** –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å ‚Üí –í—ã–±—Ä–∞—Ç—å `library` (–∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É `+`)
2. **–í—ã–±–æ—Ä –∫–æ–ª–ª–µ–∫—Ü–∏–∏:** –ö–ª–∏–∫–Ω—É—Ç—å –Ω–∞ `authors` –∏–ª–∏ `books`
3. **–í–∫–ª–∞–¥–∫–∏:**
   - **Documents** ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
   - **Aggregations** ‚Äî –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ pipeline –∞–≥—Ä–µ–≥–∞—Ü–∏–∏
   - **Schema** ‚Äî –∞–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
   - **Indexes** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞–º–∏


```js
// MongoDB –ë—ã—Å—Ç—Ä–∞—è —à–ø–∞—Ä–≥–∞–ª–∫–∞

// === –ó–ê–ü–£–°–ö MONGOSH ===
// –ò–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏:
// mongosh --username student --password password
// –ò–ª–∏ –∏–∑ Docker:
// docker-compose exec mongodb mongosh --username student --password password

// === –û–°–ù–û–í–ù–´–ï –ö–û–ú–ê–ù–î–´ ===
show dbs;              // –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
show collections;      // –ü–æ–∫–∞–∑–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –≤ —Ç–µ–∫—É—â–µ–π –ë–î
db;                    // –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â—É—é –ë–î
help;                  // –°–ø—Ä–∞–≤–∫–∞
exit;                  // –í—ã—Ö–æ–¥

// === –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï ===
use library;           // –í—ã–±—Ä–∞—Ç—å/—Å–æ–∑–¥–∞—Ç—å –ë–î

// === CREATE (–°–æ–∑–¥–∞–Ω–∏–µ) ===
db.authors.insertOne({name: "–¢–æ–ª—Å—Ç–æ–π", birthYear: 1828});
db.authors.insertMany([
  {name: "–¢–æ–ª—Å—Ç–æ–π", birthYear: 1828},
  {name: "–î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π", birthYear: 1821}
]);

// === READ (–ß—Ç–µ–Ω–∏–µ) ===
db.authors.find();                              // –í—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
db.authors.findOne({name: "–¢–æ–ª—Å—Ç–æ–π"});          // –û–¥–∏–Ω –¥–æ–∫—É–º–µ–Ω—Ç
db.books.find({pages: {$gt: 500}});             // –ë–æ–ª—å—à–µ 500 —Å—Ç—Ä–∞–Ω–∏—Ü
db.books.find({genre: "—Ä–æ–º–∞–Ω"}).limit(5);       // –ü–µ—Ä–≤—ã–µ 5

// === UPDATE (–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ) ===
db.authors.updateOne(
  {name: "–¢–æ–ª—Å—Ç–æ–π"},                  // –§–∏–ª—å—Ç—Ä
  {$set: {country: "–†–æ—Å—Å–∏—è"}}         // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ
);
db.books.updateMany(
  {genre: "—Ä–æ–º–∞–Ω"},
  {$set: {category: "–∫–ª–∞—Å—Å–∏–∫–∞"}}
);

// === DELETE (–£–¥–∞–ª–µ–Ω–∏–µ) ===
db.authors.deleteOne({name: "–¢–æ–ª—Å—Ç–æ–π"});
db.books.deleteMany({pages: {$lt: 100}});

// === –û–ü–ï–†–ê–¢–û–†–´ –ó–ê–ü–†–û–°–û–í ===
{price: {$gt: 1000}}    // –ë–æ–ª—å—à–µ
{price: {$gte: 1000}}   // –ë–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ
{price: {$lt: 1000}}    // –ú–µ–Ω—å—à–µ
{price: {$lte: 1000}}   // –ú–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ
{price: {$ne: 1000}}    // –ù–µ —Ä–∞–≤–Ω–æ

// –õ–æ–≥–∏—á–µ—Å–∫–∏–µ
{$and: [{pages: {$gt: 500}}, {genre: "—Ä–æ–º–∞–Ω"}]}
{$or: [{genre: "—Ä–æ–º–∞–Ω"}, {genre: "–ø–æ–≤–µ—Å—Ç—å"}]}

// –ú–∞—Å—Å–∏–≤—ã
{tags: {$in: ["–∫–ª–∞—Å—Å–∏–∫–∞", "—Ä–æ–º–∞–Ω"]}}      // –ï—Å—Ç—å –≤ –º–∞—Å—Å–∏–≤–µ
{tags: {$nin: ["—Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞"]}}            // –ù–µ—Ç –≤ –º–∞—Å—Å–∏–≤–µ

// === –ê–ì–†–ï–ì–ê–¶–ò–Ø ===

// –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞
db.books.aggregate([
  {
    $group: {
      _id: "$genre",              // –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ –∂–∞–Ω—Ä—É
      count: {$sum: 1},           // –ü–æ–¥—Å—á–µ—Ç
      avgPages: {$avg: "$pages"}  // –°—Ä–µ–¥–Ω–µ–µ
    }
  }
]);

// –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏ –ª–∏–º–∏—Ç
db.books.aggregate([
  {$sort: {pages: -1}},  // -1 = —É–±—ã–≤–∞–Ω–∏–µ, 1 = –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏–µ
  {$limit: 5}
]);

// –ü—Ä–æ–µ–∫—Ü–∏—è (–≤—ã–±–æ—Ä –ø–æ–ª–µ–π)
db.books.aggregate([
  {
    $project: {
      title: 1,                    // –í–∫–ª—é—á–∏—Ç—å
      authorName: "$author.name",  // –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å
      _id: 0                       // –ò—Å–∫–ª—é—á–∏—Ç—å
    }
  }
]);

// Lookup (JOIN)
db.books.aggregate([
  {
    $lookup: {
      from: "authors",        // –ò–∑ –∫–∞–∫–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏
      localField: "authorId", // –ü–æ–ª–µ –≤ books
      foreignField: "_id",    // –ü–æ–ª–µ –≤ authors
      as: "author"            // –ò–º—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—è
    }
  },
  {$unwind: "$author"}  // –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –º–∞—Å—Å–∏–≤ –≤ –æ–±—ä–µ–∫—Ç
]);

// === –ü–û–õ–ï–ó–ù–´–ï –ö–û–ú–ê–ù–î–´ ===
db.books.countDocuments({genre: "—Ä–æ–º–∞–Ω"});  // –ü–æ–¥—Å—á–µ—Ç
db.books.distinct("genre");                 // –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
show collections;                           // –°–ø–∏—Å–æ–∫ –∫–æ–ª–ª–µ–∫—Ü–∏–π
db.books.drop();                            // –£–¥–∞–ª–∏—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é

// ========================================
// === MONGODB COMPASS (GUI) ===
// ========================================

// –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï:
// Connection String: mongodb://student:password@localhost:27017/

// === CREATE (–°–æ–∑–¥–∞–Ω–∏–µ) ===
// 1. –í—ã–±—Ä–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, authors)
// 2. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "INSERT DOCUMENT"
// 3. –í–≤–µ—Å—Ç–∏ JSON:
//    {"name": "–¢–æ–ª—Å—Ç–æ–π", "birthYear": 1828, "country": "–†–æ—Å—Å–∏—è"}
// 4. –ù–∞–∂–∞—Ç—å "INSERT"

// === READ (–ß—Ç–µ–Ω–∏–µ) ===
// 1. –û—Ç–∫—Ä—ã—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é
// 2. –í –ø–æ–ª–µ Filter –≤–≤–µ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å:
//    {"genre": "—Ä–æ–º–∞–Ω"}                    // –ù–∞–π—Ç–∏ –ø–æ –∂–∞–Ω—Ä—É
//    {"pages": {"$gt": 500}}               // –ë–æ–ª—å—à–µ 500 —Å—Ç—Ä–∞–Ω–∏—Ü
//    {"publishedYear": {"$gte": 1900}}    // –° 1900 –≥–æ–¥–∞
// 3. –ù–∞–∂–∞—Ç—å "FIND"

// === UPDATE (–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ) ===
// 1. –ù–∞–π—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç —á–µ—Ä–µ–∑ Filter
// 2. –ù–∞–≤–µ—Å—Ç–∏ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç ‚Üí –Ω–∞–∂–∞—Ç—å –∏–∫–æ–Ω–∫—É –∫–∞—Ä–∞–Ω–¥–∞—à–∞ (Edit)
// 3. –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ–ª—è –≤ JSON
// 4. –ù–∞–∂–∞—Ç—å "UPDATE"

// === DELETE (–£–¥–∞–ª–µ–Ω–∏–µ) ===
// 1. –ù–∞–π—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç
// 2. –ù–∞–≤–µ—Å—Ç–∏ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç ‚Üí –Ω–∞–∂–∞—Ç—å –∏–∫–æ–Ω–∫—É –∫–æ—Ä–∑–∏–Ω—ã (Delete)
// 3. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ

// === AGGREGATIONS (–ê–≥—Ä–µ–≥–∞—Ü–∏—è) ===
// 1. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Aggregations"
// 2. –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞–¥–∏–∏ pipeline:
//    Stage 1: {"$match": {"genre": "—Ä–æ–º–∞–Ω"}}
//    Stage 2: {"$sort": {"pages": -1}}
//    Stage 3: {"$limit": 5}
// 3. –ù–∞–∂–∞—Ç—å "RUN" –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

// === INDEXES (–ò–Ω–¥–µ–∫—Å—ã) ===
// 1. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Indexes"
// 2. –ù–∞–∂–∞—Ç—å "CREATE INDEX"
// 3. –£–∫–∞–∑–∞—Ç—å –ø–æ–ª—è: {"name": 1}  // 1 = –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏–µ, -1 = —É–±—ã–≤–∞–Ω–∏–µ
// 4. –î–∞—Ç—å –∏–º—è –∏–Ω–¥–µ–∫—Å—É
// 5. –ù–∞–∂–∞—Ç—å "CREATE"

// === SCHEMA (–°—Ö–µ–º–∞) ===
// 1. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Schema"
// 2. –ù–∞–∂–∞—Ç—å "ANALYZE SCHEMA"
// 3. –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π

// === EXPORT/IMPORT ===
// Export:
// 1. Collection ‚Üí Export Collection
// 2. –í—ã–±—Ä–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç (JSON/CSV)
// 3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª
//
// Import:
// 1. Collection ‚Üí Import Data
// 2. –í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª
// 3. –ù–∞–∂–∞—Ç—å "IMPORT"
```