–ü–µ—Ä–µ–∏–º–µ–Ω—É–π
```
‚ö° FastAPI
üöÄ –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è Python
```

–≤ 

```
–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ ‚ö° FastAPI
–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å –∫ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç–µ

```
–Ω–∞ 16 —Å–ª–∞–π–¥–µ —É–º–µ–Ω—å—à–∏ —à—Ä–∏—Ñ—Ç –ø–∞–π—Ç–æ–Ω –∫–æ–¥–∞ –Ω–∞ 30 %


## –°–ª–∞–π–¥ 1

–ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–π —Å—Ç–∏–ª—å–Ω—ã–π —Å–ª–∞–π–¥ –ø—Ä–æ Fastapi
–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Fastapi

–∞–Ω–∏–º–∞—Ü–∏—è:
–Ω–∞ –ø–µ—Ä–≤–æ–º –ø–ª–∞–Ω–µ:
Pydantic
Starlette
type hints
ORM
 
–Ω–∞ –≤—Ç–æ—Ä–æ–º (–¥–∞–ª—å–Ω–∏–π –≥–æ—Ä–∏–∑–æ–Ω—Ç):
Dependency Injection
Middleware 
BackgroundTasks
testclient 
OAuth2PasswordBearer
SQL/NoSQL
–º–∏–≥—Ä–∞—Ü–∏–∏

Docker 
CI/CD


## –°–ª–∞–π–¥ 2

**Starlette** - —ç—Ç–æ –ª–µ–≥–∫–∏–π ASGI-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫/–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–π, –æ–Ω –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –≤–µ–±-—Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–∞ Python.

FastAPI
    ‚îú‚îÄ‚îÄ Pydantic (–≤–∞–ª–∏–¥–∞—Ü–∏—è, —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è)
    ‚îú‚îÄ‚îÄ Starlette (ASGI, HTTP, WebSockets)
    ‚îî‚îÄ‚îÄ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ç–∏–ø—ã Python (type hints)

–ë–æ–ª—å—à–∞—è —á–∞—Å—Ç—å –≤–µ–±-–∫–æ–¥–∞ FastAPI –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ —Å–æ–∑–¥–∞–Ω–Ω–æ–º –¢–æ–º–æ–º –ö—Ä–∏—Å—Ç–∏ –ø–∞–∫–µ—Ç–µ Starlette (https://www.starlette.io).

–ï–≥–æ –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–≥–æ –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ –∏–ª–∏ –∫–∞–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤, –Ω–∞–ø—Ä–∏–º–µ—Ä FastAPI.
–ö–∞–∫ –∏ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫, Starlette –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Å–µ –æ–±—ã—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤.

–û–Ω –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω –ª–µ–∂–∞—â–µ–º—É –≤ –æ—Å–Ω–æ–≤–µ Flask –ø–∞–∫–µ—Ç—É Werkzeug (https://werkzeug.palletsprojects.com).

## –°–ª–∞–π–¥ 3

–°–∞–º–∞—è –≤–∞–∂–Ω–∞—è –µ–≥–æ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –ø–æ–¥–¥–µ—Ä–∂–∫–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –≤–µ–±-—Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞ Python - ASGI (https://asgi.readthedocs.io).

–î–æ —Å–∏—Ö –ø–æ—Ä –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤ Python, –Ω–∞–ø—Ä–∏–º–µ—Ä Flask –∏ Django, –æ—Å–Ω–æ–≤—ã–≤–∞–ª–∏—Å—å –Ω–∞ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ–º —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–µ WSGI (https://wsgi.readthedocs.io).

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞         | WSGI (Gunicorn, uWSGI)  | ASGI (Uvicorn, Daphne) |
| ---------------------- | ----------------------- | ---------------------- |
| –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å         | –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è (–±–ª–æ–∫–∏—Ä—É—é—â–∞—è)| –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è (–Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∞—è) |
| –ü–æ–¥–¥–µ—Ä–∂–∫–∞ WebSockets   | ‚úó –ù–µ—Ç                  | –î–∞                     |
| –î–æ–ª–≥–æ–∂–∏–≤—É—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è| ‚úó –ù–µ—Ç                  | –î–∞                     |
| –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å     | –•–æ—Ä–æ—à–∞—è –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π | –õ—É—á—à–µ –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π |
| –õ—É—á—à–µ –≤—Å–µ–≥–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è | Flask, Django (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) | FastAPI, Django-ASGI   |

ASGI –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã—Ö –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞ –±–∞–∑–µ WSGI –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –∏ –Ω–∞–ø—Ä—è–∂–µ–Ω–Ω–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è.
–ü—Ä–æ–±–ª–µ–º—ã —Ç–∞–∫–æ–≥–æ —Ç–∏–ø–∞ —Å–≤—è–∑–∞–Ω—ã —Å —á–∞—Å—Ç—ã–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∫ –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª–µ–µ –º–µ–¥–ª–µ–Ω–Ω–æ–º—É –∫–æ–¥—É, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö, —Ñ–∞–π–ª–∞–º –∏ —Å–µ—Ç—è–º.

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ Starlette –∏ –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ –µ–≥–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏ —Å—Ç–∞–ª–∏ —Å–∞–º—ã–º–∏ –±—ã—Å—Ç—Ä—ã–º–∏ –≤–µ–±-–ø–∞–∫–µ—Ç–∞–º–∏ Python –∏ —Å–æ—Å—Ç–∞–≤–∏–ª–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—é –¥–∞–∂–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º –Ω–∞ Go –∏ Node.js.

## –°–ª–∞–π–¥ 4

### –¢–∏–ø—ã –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏

–ü—Ä–∏ **–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö** –∑–∞–¥–∞—á–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –º–µ–∂–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–º–∏ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞–º–∏ (–¶–ü). –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞—Å—á–µ—Ç–æ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫ –∑–∞–¥–∞—á–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≥—Ä–∞—Ñ–∏–∫–∏ –∏ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ.

–ü—Ä–∏ **–∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö** –∫–∞–∂–¥—ã–π –¶–ü –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –º–µ–∂–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∑–∞–¥–∞—á–∞–º–∏. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–∞–¥–∞—á–∏ –∏–∑ –ø–æ—Ç–æ–∫–∞ –∑–∞–Ω–∏–º–∞—é—Ç –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏, –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –æ–±—â–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

–°—á–∏—Ç—ã–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –∏–ª–∏ –¥–æ—Å—Ç—É–ø –∫ —É–¥–∞–ª–µ–Ω–Ω–æ–º—É —Å–µ—Ç–µ–≤–æ–º—É —Å–µ—Ä–≤–∏—Å—É –±—É–∫–≤–∞–ª—å–Ω–æ –≤ —Ç—ã—Å—è—á–∏ –∏ –º–∏–ª–ª–∏–æ–Ω—ã —Ä–∞–∑ –º–µ–¥–ª–µ–Ω–Ω–µ–µ, —á–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –≤ –¶–ü.

–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å —ç—Ç–æ–π –º–µ–¥–ª–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã. –ö–∞–∫ –∑–∞—Å—Ç–∞–≤–∏—Ç—å –∏—Ö –∏–ª–∏ –ª—é–±—ã–µ –¥—Ä—É–≥–∏–µ —Å–µ—Ä–≤–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—Ç—å –±—ã—Å—Ç—Ä–µ–µ?

## –°–ª–∞–π–¥ 5

## GIL (Global Interpreter Lock)

**GIL** - —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º –≤ CPython, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–º—É –ø–æ—Ç–æ–∫—É –≤—ã–ø–æ–ª–Ω—è—Ç—å –±–∞–π—Ç-–∫–æ–¥ Python –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –¥–∞–∂–µ –Ω–∞ –º–Ω–æ–≥–æ—è–¥–µ—Ä–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ –ø–æ—Ç–æ–∫–∏ Python –Ω–µ –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –¥–ª—è CPU-bound –∑–∞–¥–∞—á.

![1761908864592](image/lect/1761908864592.png)

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è GIL:

- **CPU-bound –∑–∞–¥–∞—á–∏** (–≤—ã—á–∏—Å–ª–µ–Ω–∏—è, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö) - –ø–æ—Ç–æ–∫–∏ –Ω–µ –¥–∞—é—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- **I/O-bound –∑–∞–¥–∞—á–∏** (—Å–µ—Ç—å, —Ñ–∞–π–ª—ã, –ë–î) - –ø–æ—Ç–æ–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ, —Ç–∞–∫ –∫–∞–∫ GIL –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è –≤–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è I/O

## –°–ª–∞–π–¥ 6

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞                        | I/O-bound                                                                 | CPU-bound                                                                  |
| :-------------------------------------------------- | :------------------------------------------------------------------------ | :------------------------------------------------------------------------- |
| **–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–π —Ä–µ—Å—É—Ä—Å** | –°–∫–æ—Ä–æ—Å—Ç—å –í–≤–æ–¥–∞/–í—ã–≤–æ–¥–∞ (–¥–∏—Å–∫, —Å–µ—Ç—å)             | –°–∫–æ—Ä–æ—Å—Ç—å –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ (CPU)                                |
| **–ó–∞–≥—Ä—É–∑–∫–∞ CPU**                      | –ù–∏–∑–∫–∞—è (–º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –≤ —Ä–µ–∂–∏–º–µ –æ–∂–∏–¥–∞–Ω–∏—è) | –í—ã—Å–æ–∫–∞—è (–ø–æ—á—Ç–∏ 100%)                                           |
| **–û—Å–Ω–æ–≤–Ω–æ–µ –≤—Ä–µ–º—è**               | –û–∂–∏–¥–∞–Ω–∏–µ                                                          | –ê–∫—Ç–∏–≤–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è                                      |
| **–ü—Ä–∏–º–µ—Ä—ã**                            | –í–µ–±-–∑–∞–ø—Ä–æ—Å—ã, –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤                | –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≤–∏–¥–µ–æ, –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—á–µ—Ç—ã |
| **–°–ø–æ—Å–æ–±—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**     | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å, –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å                | –ú–Ω–æ–≥–æ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ—Å—Ç—å, –†–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏–≤–∞–Ω–∏–µ |

**–ü—Ä–æ—Å—Ç–∞—è –∞–Ω–∞–ª–æ–≥–∏—è:**

* **CPU-bound** ‚Äî —ç—Ç–æ **—à–µ—Ñ-–ø–æ–≤–∞—Ä**, –∫–æ—Ç–æ—Ä—ã–π –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ —Ä–µ–∂–µ—Ç –æ–≤–æ—â–∏. –ï–≥–æ —Å–∫–æ—Ä–æ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ –µ–≥–æ –ª–∏—á–Ω–æ–π –ª–æ–≤–∫–æ—Å—Ç—å—é. –ß—Ç–æ–±—ã –≥–æ—Ç–æ–≤–∏—Ç—å –±—ã—Å—Ç—Ä–µ–µ, –Ω–∞–π–º–∏—Ç–µ –µ—â–µ –ø–æ–≤–∞—Ä–æ–≤ (–¥–æ–±–∞–≤—å—Ç–µ —è–¥–µ—Ä –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞).
* **I/O-bound** ‚Äî —ç—Ç–æ **–∫—É—Ä—å–µ—Ä**, –∫–æ—Ç–æ—Ä—ã–π –∂–¥–µ—Ç –ª–∏—Ñ—Ç, —á—Ç–æ–±—ã –¥–æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑. –ï–≥–æ —Å–∫–æ—Ä–æ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ –≤—Ä–µ–º–µ–Ω–µ–º –æ–∂–∏–¥–∞–Ω–∏—è –ª–∏—Ñ—Ç–∞. –ß—Ç–æ–±—ã –¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –±–æ–ª—å—à–µ –∑–∞–∫–∞–∑–æ–≤, –Ω–∞–π–º–∏—Ç–µ –±–æ–ª—å—à–µ –∫—É—Ä—å–µ—Ä–æ–≤ (—Å–æ–∑–¥–∞–π—Ç–µ –±–æ–ª—å—à–µ –ø–æ—Ç–æ–∫–æ–≤/–∑–∞–¥–∞—á), –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∂–¥–∞—Ç—å –ª–∏—Ñ—Ç—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ.

## –°–ª–∞–π–¥ 7

## –¢–∏–ø—ã –∑–∞–¥–∞—á –≤ FastAPI

### 1. I/O-bound –∑–∞–¥–∞—á–∏ (—Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –≤–≤–æ–¥–æ–º-–≤—ã–≤–æ–¥–æ–º)

- –ó–∞–ø—Ä–æ—Å—ã –∫ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö
- HTTP-–∑–∞–ø—Ä–æ—Å—ã –∫ –≤–Ω–µ—à–Ω–∏–º API
- –ß—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å —Ñ–∞–π–ª–æ–≤
- –°–µ—Ç–µ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å (async/await) + asyncio

```py
@app.get("/fetch-data")
async def fetch_multiple():
    async with httpx.AsyncClient() as client:
        # –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
        results = await asyncio.gather(
            client.get("https://api1.com/data"),
            client.get("https://api2.com/data"),
            client.get("https://api3.com/data")
        )
    return {"results": [r.json() for r in results]}
```

## –°–ª–∞–π–¥ 8

–ü—Ä–æ–±–ª–µ–º–∞ CPU-bound –∑–∞–¥–∞—á –≤ FastAPI

**–û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞**: FastAPI —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º **asyncio** –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–æ–¥–∏–Ω –ø–æ—Ç–æ–∫ —Å–æ–±—ã—Ç–∏—è (event loop)**. –ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è CPU-bound –∑–∞–¥–∞—á–∞, –æ–Ω–∞ –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤–µ—Å—å event loop, –∏ —Å–µ—Ä–≤–µ—Ä –Ω–µ –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ –∑–∞–ø—Ä–æ—Å—ã.

### –ü—Ä–∏–º–µ—Ä –ø—Ä–æ–±–ª–µ–º—ã

```python

# CPU-bound –∑–∞–¥–∞—á–∞ - —Ç—è–∂–µ–ª—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
def heavy_calculation(n: int):
    # –°–∏–º—É–ª—è—Ü–∏—è —Ç—è–∂–µ–ª—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
    result = 0
    for i in range(n):
        result += i * i
    return result

@app.get("/slow-cpu")
def slow_cpu_endpoint():
    start = time.time()
    result = heavy_calculation(50_000_000)  # –ë–ª–æ–∫–∏—Ä—É—é—â–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è!
    end = time.time()
    return {"result": result, "time": end - start}

@app.get("/fast")
def fast_endpoint():
    return {"message": "–Ø –±—ã—Å—Ç—Ä—ã–π!"}
```

–ï—Å–ª–∏ –≤—ã –æ—Ç–∫—Ä–æ–µ—Ç–µ –¥–≤–∞ –±—Ä–∞—É–∑–µ—Ä–∞ –∏:

1. –°–Ω–∞—á–∞–ª–∞ –∑–∞–ø—Ä–æ—Å–∏—Ç–µ `/slow-cpu` (–±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è 3-5 —Å–µ–∫—É–Ω–¥)
2. –ó–∞—Ç–µ–º —Å—Ä–∞–∑—É –∑–∞–ø—Ä–æ—Å–∏—Ç–µ `/fast`

–í—Ç–æ—Ä–æ–π –∑–∞–ø—Ä–æ—Å **–±—É–¥–µ—Ç –∂–¥–∞—Ç—å**, –ø–æ–∫–∞ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è –ø–µ—Ä–≤—ã–π, –ø–æ—Ç–æ–º—É —á—Ç–æ CPU-bound –∑–∞–¥–∞—á–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∞ event loop!

## –°–ª–∞–π–¥ 9

**–†–µ—à–µ–Ω–∏–µ –¥–ª—è CPU-bound –∑–∞–¥–∞—á**: –ú–Ω–æ–≥–æ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ—Å—Ç—å (ProcessPoolExecutor)

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–°–æ–∑–¥–∞—ë—Ç—Å—è –ø—É–ª –ø—Ä–æ—Ü–µ—Å—Å–æ–≤** - –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ Python
2. **–ö–∞–∂–¥—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∏–º–µ–µ—Ç —Å–≤–æ–π GIL** - –æ–±—Ö–æ–¥–∏–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ GIL
3. **–ó–∞–¥–∞—á–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏** - –∏—Å—Ç–∏–Ω–Ω—ã–π –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º
4. **Event loop –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è** - —Å–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞—ë—Ç—Å—è –æ—Ç–∑—ã–≤—á–∏–≤—ã–º

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- ‚úÖ –¢—è–∂—ë–ª—ã–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π/–≤–∏–¥–µ–æ
- ‚úÖ –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ (inference)
- ‚úÖ –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö

```py
from fastapi import FastAPI
from concurrent.futures import ProcessPoolExecutor
import asyncio

app = FastAPI()
executor = ProcessPoolExecutor(max_workers=4)  # 4 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞

def heavy_computation(n):
    # –¢—è–∂–µ–ª—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è - –∏—Å–ø–æ–ª—å–∑—É—é—Ç 100% CPU
    result = sum(i * i for i in range(n))
    return result

@app.get("/compute/{n}")
async def compute(n: int):
    loop = asyncio.get_event_loop()
    # –í—ã–ø–æ–ª–Ω—è–µ–º –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ - –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç event loop!
    result = await loop.run_in_executor(executor, heavy_computation, n)
    return {"result": result}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –ò—Å—Ç–∏–Ω–Ω—ã–π –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º, –æ–±—Ö–æ–¥ GIL, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è CPU-–∑–∞–¥–∞—á

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏**: –í—ã—Å–æ–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ (–∫–∞–∂–¥—ã–π –ø—Ä–æ—Ü–µ—Å—Å = –∫–æ–ø–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã), –º–µ–¥–ª–µ–Ω–Ω—ã–π —Å—Ç–∞—Ä—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

## –°–ª–∞–π–¥ 10

**–†–µ—à–µ–Ω–∏–µ –¥–ª—è –±–ª–æ–∫–∏—Ä—É—é—â–∏—Ö I/O**: –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å (ThreadPoolExecutor)

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–°–æ–∑–¥–∞—ë—Ç—Å—è –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤** - –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤ –≤ –æ–¥–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ
2. **–û–±—â–∏–π GIL, –Ω–æ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è –ø—Ä–∏ I/O** - –ø–æ—Ç–æ–∫–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è
3. **–õ–µ–≥–∫–æ–≤–µ—Å–Ω—ã–µ –ø–æ—Ç–æ–∫–∏** - –±—ã—Å—Ç—Ä–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ, –º–∞–ª–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
4. **–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –±–ª–æ–∫–∏—Ä—É—é—â–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫** - –∫–æ–≥–¥–∞ –Ω–µ—Ç async-–≤–µ—Ä—Å–∏–∏

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- ‚úÖ –†–∞–±–æ—Ç–∞ —Å —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ –ë–î (SQLAlchemy –±–µ–∑ async)
- ‚úÖ –í—ã–∑–æ–≤ –≤–Ω–µ—à–Ω–∏—Ö API —á–µ—Ä–µ–∑ requests (–Ω–µ httpx)
- ‚úÖ –ß—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å —Ñ–∞–π–ª–æ–≤ (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏)
- ‚úÖ –†–∞–±–æ—Ç–∞ —Å legacy-–±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏ –±–µ–∑ async
- ‚úÖ –°–º–µ—à–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ (–Ω–µ–º–Ω–æ–≥–æ CPU + I/O)

```py
from fastapi import FastAPI
from concurrent.futures import ThreadPoolExecutor
import time
import asyncio

app = FastAPI()
thread_executor = ThreadPoolExecutor(max_workers=10)  # 10 –ø–æ—Ç–æ–∫–æ–≤

def io_task(duration):
    time.sleep(duration)  # –ë–ª–æ–∫–∏—Ä—É—é—â–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è - GIL –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è!
    return f"Completed after {duration}s"

@app.get("/thread-task")
async def thread_task():
    loop = asyncio.get_event_loop()
    tasks = [
        loop.run_in_executor(thread_executor, io_task, 1),
        loop.run_in_executor(thread_executor, io_task, 2),
        loop.run_in_executor(thread_executor, io_task, 3)
    ]
    results = await asyncio.gather(*tasks)  # –í—Å–µ 3 –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω—è—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ!
    return {"results": results}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –ú–∞–ª–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏, –±—ã—Å—Ç—Ä–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤, —Ö–æ—Ä–æ—à–æ –¥–ª—è I/O

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏**: –ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è CPU-–∑–∞–¥–∞—á (GIL), –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º

## –°–ª–∞–π–¥ 11

## üîÑ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: ProcessPoolExecutor vs ThreadPoolExecutor

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | ProcessPoolExecutor | ThreadPoolExecutor |
|----------------|---------------------|--------------------|
| **–¢–∏–ø –∑–∞–¥–∞—á** | CPU-bound (–≤—ã—á–∏—Å–ª–µ–Ω–∏—è) | I/O-bound (–æ–∂–∏–¥–∞–Ω–∏–µ) |
| **GIL** | –û–±—Ö–æ–¥–∏—Ç (–∫–∞–∂–¥—ã–π –ø—Ä–æ—Ü–µ—Å—Å = —Å–≤–æ–π GIL) | –û–≥—Ä–∞–Ω–∏—á–µ–Ω GIL |
| **–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º** | –ò—Å—Ç–∏–Ω–Ω—ã–π (–º–Ω–æ–≥–æ—è–¥–µ—Ä–Ω—ã–π) | –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–π (–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ) |
| **–ü–∞–º—è—Ç—å** | –í—ã—Å–æ–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ (~50-100 MB/–ø—Ä–æ—Ü–µ—Å—Å) | –ù–∏–∑–∫–æ–µ (~1-2 MB/–ø–æ—Ç–æ–∫) |
| **–°–∫–æ—Ä–æ—Å—Ç—å —Å—Ç–∞—Ä—Ç–∞** | –ú–µ–¥–ª–µ–Ω–Ω–∞—è (—Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ ~100ms) | –ë—ã—Å—Ç—Ä–∞—è (—Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ ~1ms) |
| **–û–±–º–µ–Ω –¥–∞–Ω–Ω—ã–º–∏** | –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è (pickle) - –º–µ–¥–ª–µ–Ω–Ω–æ | –û–±—â–∞—è –ø–∞–º—è—Ç—å - –±—ã—Å—Ç—Ä–æ |
| **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ workers** | = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —è–¥–µ—Ä CPU (4-8) | –ú–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª—å—à–µ (10-100) |
| **–ü—Ä–∏–º–µ—Ä—ã** | ML inference, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ | –ó–∞–ø—Ä–æ—Å—ã –∫ –ë–î, —Ñ–∞–π–ª–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ |

### üí° –ó–æ–ª–æ—Ç–æ–µ –ø—Ä–∞–≤–∏–ª–æ:

- **CPU –∑–∞–≥—Ä—É–∂–µ–Ω –Ω–∞ 100%?** ‚Üí ProcessPoolExecutor
- **–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∂–¥—ë—Ç (—Å–µ—Ç—å, –¥–∏—Å–∫, –ë–î)?** ‚Üí ThreadPoolExecutor –∏–ª–∏ async/await
- **–ï—Å—Ç—å async-–≤–µ—Ä—Å–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏?** ‚Üí –ò—Å–ø–æ–ª—å–∑—É–π async/await (—Å–∞–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π!)

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É

| –¢–∏–ø –∑–∞–¥–∞—á–∏ | –†–µ—à–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä | –ü–æ—á–µ–º—É? |
|------------|---------|--------|----------|
| I/O-bound (—Å–µ—Ç—å, –ë–î) | async/await | API –∑–∞–ø—Ä–æ—Å—ã, async –ë–î | –°–∞–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π, –º–∏–Ω–∏–º—É–º —Ä–µ—Å—É—Ä—Å–æ–≤ |
| CPU-bound (–≤—ã—á–∏—Å–ª–µ–Ω–∏—è) | ProcessPoolExecutor | –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, ML | –û–±—Ö–æ–¥ GIL, –∏—Å—Ç–∏–Ω–Ω—ã–π –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º |
| –ë–ª–æ–∫–∏—Ä—É—é—â–∏–µ I/O | ThreadPoolExecutor | –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –ë–î, requests | –ö–æ–≥–¥–∞ –Ω–µ—Ç async-–≤–µ—Ä—Å–∏–∏ |
| –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ | BackgroundTasks | –û—Ç–ø—Ä–∞–≤–∫–∞ email, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç –∫–ª–∏–µ–Ω—Ç—É |
| –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ | Celery + Redis | –î–ª–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏, –æ—á–µ—Ä–µ–¥–∏ | –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–µ—Ä–æ–≤ |

## –°–ª–∞–π–¥ 12

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É

# –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥

```py
from fastapi import FastAPI, BackgroundTasks
from concurrent.futures import ProcessPoolExecutor, ThreadPoolExecutor
import asyncio
import httpx
import time

app = FastAPI()
process_pool = ProcessPoolExecutor(max_workers=4)
thread_pool = ThreadPoolExecutor(max_workers=10)

def process_image(image_data):
    # CPU-intensive: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    return {"processed": True}

async def fetch_data(url):
    # I/O-bound: –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    async with httpx.AsyncClient() as client:
        response = await client.get(url)
        return response.json()

def save_to_db(data):
    # I/O-bound: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
    time.sleep(1)
    return {"saved": True}

@app.post("/process")
async def process(background_tasks: BackgroundTasks):
    # 1. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –ø–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ
    data = await fetch_data("https://api.example.com/data")
  
    # 2. CPU-–∑–∞–¥–∞—á—É –≤—ã–ø–æ–ª–Ω—è–µ–º –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ
    loop = asyncio.get_event_loop()
    processed = await loop.run_in_executor(
        process_pool, 
        process_image, 
        data
    )
  
    # 3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î –¥–µ–ª–∞–µ–º –≤ —Ñ–æ–Ω–µ
    background_tasks.add_task(save_to_db, processed)
  
    return {"status": "processing", "data": processed}
```

## –°–ª–∞–π–¥ 13

### –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è

FastAPI –æ—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è API, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è, –Ω–æ —Å–∞–º–æ –ø–æ —Å–µ–±–µ –æ–Ω–æ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ –¥–ª—è —ç—Ç–∏—Ö –∑–∞–¥–∞—á.

–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —è–¥–µ—Ä –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞.
asyncio.gather() (–¥–ª—è I/O-bound –∑–∞–¥–∞—á):
–ò—Å–ø–æ–ª—å–∑—É–µ–º —ç—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥, –∫–æ–≥–¥–∞ –≤–∞—à–∏ –∑–∞–¥–∞—á–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–≤—è–∑–∞–Ω—ã —Å –≤–≤–æ–¥–æ–º-–≤—ã–≤–æ–¥–æ–º (—Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã, —á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å –≤ –ë–î). asyncio.gather() –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –æ–∂–∏–¥–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤ –æ–¥–Ω–æ–º –ø–æ—Ç–æ–∫–µ —Å–æ–±—ã—Ç–∏–π, –Ω–µ –±–ª–æ–∫–∏—Ä—É—è –µ–≥–æ.

concurrent.futures.ProcessPoolExecutor (–¥–ª—è CPU-bound –∑–∞–¥–∞—á): –î–ª—è –∑–∞–¥–∞—á, –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä (—Å–ª–æ–∂–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö), Python –∏–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ (GIL - Global Interpreter Lock), –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ—Ç–æ–∫–∞–º –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –≤ –æ–¥–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ.
–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º  (44+72)\5-6\image\lect\gil.gif

BackgroundTasks: –ü–æ–∑–≤–æ–ª—è–µ—Ç —Å–µ—Ä–≤–µ—Ä—É FastAPI –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç –∫–ª–∏–µ–Ω—Ç—É, –ø–æ–∫–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ. –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ API –æ—Å—Ç–∞–µ—Ç—Å—è –æ—Ç–∑—ã–≤—á–∏–≤—ã–º.

## –°–ª–∞–π–¥ 14

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è (–Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–µ—Ä–æ–≤/—É–∑–ª–æ–≤)

–î–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π —Ç—Ä–µ–±—É–µ—Ç—Å—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, —Å–æ—Å—Ç–æ—è—â–∞—è –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º.
–ë—Ä–æ–∫–µ—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏–π (Redis, RabbitMQ, Kafka) –∏ –æ—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á (Celery, Ray): –≠—Ç–æ –Ω–∞–∏–±–æ–ª–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥.
FastAPI –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–¥–∞—á—É –≤ –æ—á–µ—Ä–µ–¥—å —á–µ—Ä–µ–∑ –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, Redis).
–ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã (Celery Workers –∏–ª–∏ Ray Workers) –∏–∑–≤–ª–µ–∫–∞—é—Ç –∑–∞–¥–∞—á–∏ –∏–∑ –æ—á–µ—Ä–µ–¥–∏ –∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç –∏—Ö –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ –Ω–∞ –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö –∏–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö.
–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –±—Ä–æ–∫–µ—Ä–µ, –∏ –∫–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏ —á–µ—Ä–µ–∑ –¥—Ä—É–≥–æ–π —ç–Ω–¥–ø–æ–∏–Ω—Ç FastAPI.

## –°–ª–∞–π–¥ 15

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞

**–°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥:**

```py
import time

def q():
    print("Why can't programmers tell jokes?")
    time.sleep(3)

def a():
    print("Timing!")

def main():
    q()
    a()

main()
```

–í—ã–≤–æ–¥:

```
Why can't programmers tell jokes?
Timing!
```

–ú–µ–∂–¥—É –≤–æ–ø—Ä–æ—Å–æ–º –∏ –æ—Ç–≤–µ—Ç–æ–º –±—É–¥–µ—Ç —Ç—Ä–µ—Ö—Å–µ–∫—É–Ω–¥–Ω—ã–π –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫. –°–∫—É–∫–æ—Ç–∞.

**–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥:**

```py
import asyncio

async def q():
    print("Why can't programmers tell jokes?")
    await asyncio.sleep(3)

async def a():
    print("Timing!")

async def main():
    await asyncio.gather(q(), a())

asyncio.run(main())
```

## –°–ª–∞–π–¥ 16

### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç

```py
from fastapi import FastAPI
import asyncio

app = FastAPI()

@app.get("/hi")
async def greet():
    await asyncio.sleep(1)
    return "Hello? World?"
```

–ó–∞–ø—É—Å–∫:

```bash
uvicorn greet_async:app
```

–ò–ª–∏ —Å uvicorn –≤ –∫–æ–¥–µ:

```py
from fastapi import FastAPI
import asyncio
import uvicorn

app = FastAPI()

@app.get("/hi")
async def greet():
    await asyncio.sleep(1)
    return "Hello? World?"

if __name__ == "__main__":
    uvicorn.run("greet_async_uvicorn:app")
```

## –°–ª–∞–π–¥ 17

### Pydantic, –ø–æ–¥—Å–∫–∞–∑–∫–∏ —Ç–∏–ø–æ–≤ –∏ –æ–±–∑–æ—Ä –º–æ–¥–µ–ª–µ–π

–ü–æ–¥—Å–∫–∞–∑–∫–∏ —Ç–∏–ø–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –º–æ–≥—É—Ç –≤–∫–ª—é—á–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ç–∏–ø:

```
name: type
```

–∏–ª–∏ —Ç–∞–∫–∂–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –∑–Ω–∞—á–µ–Ω–∏–µ–º:

```
name: type = value
```

**–ü—Ä–∏–º–µ—Ä:**

```py
thing: str = "yeti"
physics_magic_number: float = 1.0/137.03599913
hp_lovecraft_noun: str = "ichor"
exploding_sheep: tuple = ("sis", "boom", "bah!")
responses: dict = {"Marco": "Polo", "answer": 42}
```

–ú–æ–∂–Ω–æ —Ç–∞–∫–∂–µ –≤–∫–ª—é—á–∞—Ç—å –ø–æ–¥—Ç–∏–ø—ã –∫–æ–ª–ª–µ–∫—Ü–∏–π:

```py
name: dict[keytype, valtype] = {key1: val1, key2: val2}
```

## –°–ª–∞–π–¥ 18

–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ Python –¥–æ –≤–µ—Ä—Å–∏–∏ 3.9 –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–ø–∏—Å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∏–º–µ–Ω —Ç–∏–ø–æ–≤ –∏–∑ –º–æ–¥—É–ª—è typing:

```py
from typing import Str
thing: Str = "yeti"
```

–ú–æ–¥—É–ª—å typing —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–µ–∑–Ω—ã–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è –ø–æ–¥—Ç–∏–ø–æ–≤. –ù–∞–∏–±–æ–ª–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∏–∑ –Ω–∏—Ö —Å–ª–µ–¥—É—é—â–∏–µ:

- **Any** - –ª—é–±–æ–π —Ç–∏–ø
- **Union** - –ª—é–±–æ–π –∏–∑ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤, –Ω–∞–ø—Ä–∏–º–µ—Ä `Union[str, int]`

## –°–ª–∞–π–¥ 19

–ü—Ä–∏–º–µ—Ä—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π Pydantic –¥–ª—è —Å–ª–æ–≤–∞—Ä–µ–π (dict) –≤ Python –≤–∫–ª—é—á–∞—é—Ç —Å–ª–µ–¥—É—é—â–µ–µ:

```py
from typing import Any
responses: dict[str, Any] = {"Marco": "Polo", "answer": 42}
```

–ò–ª–∏, –µ—Å–ª–∏ –±—ã—Ç—å –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–º–∏:

```py
from typing import Union
responses: dict[str, Union[str, int]] = {"Marco": "Polo", "answer": 42}
```

–ª–∏–±–æ (–≤ Python 3.10 –∏ –±–æ–ª–µ–µ –ø–æ–∑–¥–Ω–∏—Ö –≤–µ—Ä—Å–∏—è—Ö):

```py
responses: dict[str, str | int] = {"Marco": "Polo", "answer": 42}
```

## –°–ª–∞–π–¥ 20

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ç–æ, —á—Ç–æ –≤ Python —Å—Ç—Ä–æ–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Å –ø–æ–¥—Å–∫–∞–∑–∫–æ–π —Ç–∏–ø–∞ —è–≤–ª—è–µ—Ç—Å—è –≤–µ—Ä–Ω–æ–π, –∞ –ø—Ä–æ—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π - –Ω–µ—Ç:

```py
>>> thing0
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'thing0' is not defined

>>> thing0: str
>>> thing1: str = "yeti"
>>> thing1 = 47
```

–ù–æ —Ç–∞–∫–∏–µ –æ—à–∏–±–∫–∏ –±—É–¥—É—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã mypy.

–ï—Å–ª–∏ —É –≤–∞—Å –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —ç—Ç–æ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä, –Ω–∞–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:

```bash
pip install mypy
```

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –¥–≤–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å—Ç—Ä–æ–∫–∏ –≤ —Ñ–∞–π–ª–µ `stuff.py`, –∞ –∑–∞—Ç–µ–º –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã:

```bash
mypy stuff.py
```

## –°–ª–∞–π–¥ 21

–í –ø–æ–¥—Å–∫–∞–∑–∫–µ —Ç–∏–ø–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –≤–º–µ—Å—Ç–æ –¥–≤–æ–µ—Ç–æ—á–∏—è –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Å—Ç—Ä–µ–ª–∫–∞:

```
function(args) -> type:
```

–í–æ—Ç –ø—Ä–∏–º–µ—Ä –≤–æ–∑–≤—Ä–∞—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ Pydantic:

```py
def get_thing() -> str:
    return "yeti"
```

–ú–æ–∂–Ω–æ –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –ª—é–±–æ–π —Ç–∏–ø, –≤–∫–ª—é—á–∞—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã –∏–ª–∏ –∏—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏.

## –°–ª–∞–π–¥ 22

### –ú–µ—Ç–æ–¥—ã FastAPI

–û–¥–Ω–∏–º –∏–∑ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ FastAPI —è–≤–ª—è–µ—Ç—Å—è —Ç–æ, —á—Ç–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –∏ –ª–µ–≥–∫–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –≤–µ–±-—Å–µ—Ä–≤–∏—Å –≤ —Å—Ç–∏–ª–µ REST. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ REST –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–∏—Ö –º–µ—Ç–æ–¥–æ–≤ –∏–ª–∏ —Ç–∏–ø–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤ HTTP –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º, –≥–¥–µ –∫–∞–∂–¥—ã–π —Ç–∏–ø –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ:

- **GET** (–ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö)
- **POST** (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö)
- **PUT** (–∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö)
- **DELETE** (—É–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö)

–ö—Ä–æ–º–µ —ç—Ç–∏—Ö —Ç–∏–ø–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤ HTTP –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –µ—â–µ —Ä—è–¥, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏:

- **OPTIONS** (–ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –º–µ—Ç–æ–¥–∞—Ö)
- **HEAD** (–ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –±–µ–∑ —Ç–µ–ª–∞ –æ—Ç–≤–µ—Ç–∞)
- **PATCH** (—á–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞)
- **TRACE** (–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞, –æ—Ç–ª–∞–¥–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤)

## –°–ª–∞–π–¥ 23

–í –∫–ª–∞—Å—Å–µ FastAPI –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ —ç—Ç–∏—Ö —Ç–∏–ø–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –æ–¥–Ω–æ–∏–º–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã:

- **get()** - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (—á—Ç–µ–Ω–∏–µ)
- **post()** - —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **put()** - –ø–æ–ª–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (–∑–∞–º–µ–Ω–∞)
- **delete()** - —É–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- **options()** - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –º–µ—Ç–æ–¥–∞—Ö (CORS)
- **head()** - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –æ—Ç–≤–µ—Ç–∞
- **patch()** - —á–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- **trace()** - –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (—Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

–í—Å–µ —ç—Ç–∏ –º–µ—Ç–æ–¥—ã –∏–º–µ—é—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –Ω–æ –≤—Å–µ –æ–Ω–∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –ø—Ä–∏–Ω–∏–º–∞—é—Ç –ø—É—Ç—å, –∑–∞–ø—Ä–æ—Å –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è.

–ú–µ—Ç–æ–¥—ã —Å–∞–º –∑–∞–ø—Ä–æ—Å –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç - –æ–Ω–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞ –∫ —Ñ—É–Ω–∫—Ü–∏—è–º, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –∑–∞–ø—Ä–æ—Å.

–ù–∞–ø—Ä–∏–º–µ—Ä:

```py
from fastapi import FastAPI

app = FastAPI()

@app.get("/")
def root():
    return {"message": "Hello –ü—É—à–∫–∏–Ω.COM"}
```

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –º–µ—Ç–æ–¥ app.get() –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞ –∫ —Ñ—É–Ω–∫—Ü–∏–∏ root() (—Å–∏–º–≤–æ–ª @ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞). –≠—Ç–æ—Ç –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—É—Ç—å, –∑–∞–ø—Ä–æ—Å—ã –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –±—É–¥–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—è root().

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ø—É—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å—Ç—Ä–æ–∫—É "/", —Ç–æ –µ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ –∫–æ—Ä–Ω—é –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ –∞–¥—Ä–µ—Å—É http://127.0.0.1:8000/).

–§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –û–±—ã—á–Ω–æ —ç—Ç–æ —Å–ª–æ–≤–∞—Ä—å (–æ–±—ä–µ–∫—Ç dict). –ó–¥–µ—Å—å —Å–ª–æ–≤–∞—Ä—å —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç "message". –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–µ—Ä–∏–∞–ª–∏–∑—É—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç JSON - –ø–æ–ø—É–ª—è—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º. –ê —É –æ—Ç–≤–µ—Ç–∞ –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ content-type —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ application/json. –í–æ–æ–±—â–µ —Ñ—É–Ω–∫—Ü–∏—è –º–æ–∂–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ - —Å–ª–æ–≤–∞—Ä–∏ (dict), —Å–ø–∏—Å–∫–∏ (list), –æ–¥–∏–Ω–æ—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ç–∏–ø–∞ —Å—Ç—Ä–æ–∫, —á–∏—Å–µ–ª –∏ —Ç.–¥., –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—Ç–µ–º —Å–µ—Ä–∏–∞–ª–∏–∑—É—é—Ç—Å—è –≤ json.

## –°–ª–∞–π–¥ 24

–ü–æ–¥–æ–±–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –∏ –¥—Ä—É–≥–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –ø–æ –¥—Ä—É–≥–∏–º –ø—É—Ç—è–º. –ù–∞–ø—Ä–∏–º–µ—Ä:

```py
from fastapi import FastAPI

app = FastAPI()

@app.get("/")
def root():
    return {"message": "Hello –ü—É—à–∫–∏–Ω.COM"}

@app.get("/about")
def about():
    return {"message": "–û —Å–∞–π—Ç–µ"}
```

## –°–ª–∞–π–¥ 25

### Response

–ö–ª–∞—Å—Å fastapi.Response —è–≤–ª—è–µ—Ç—Å—è –±–∞–∑–æ–≤—ã–º –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ –æ—Ç–≤–µ—Ç–∞. –ï–≥–æ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ–º —è–≤–ª—è–µ—Ç—Å—è —Ç–æ, —á—Ç–æ –æ–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–∞–∫–∂–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ –∫–ª–∞—Å—Å–∞–º–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –∫–∞–∫–æ–º-—Ç–æ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ. –î–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–ª–∞—Å—Å–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

- **content**: –∑–∞–¥–∞–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
- **status_code**: –∑–∞–¥–∞–µ—Ç —Å—Ç–∞—Ç—É—Å–Ω—ã–π –∫–æ–¥ –æ—Ç–≤–µ—Ç–∞
- **media_type**: –∑–∞–¥–∞–µ—Ç MIME-—Ç–∏–ø –æ—Ç–≤–µ—Ç–∞
- **headers**: –∑–∞–¥–∞–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞

```py
from fastapi import FastAPI, Response

app = FastAPI()

@app.get("/")
def root():
    data = "Hello –ü—É—à–∫–∏–Ω.COM"
    return Response(content=data, media_type="text/plain")
```

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –∫–ª–∏–µ–Ω—Ç—É –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –æ–±—ã—á–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ "Hello –ü—É—à–∫–∏–Ω.COM". –ê MIME-—Ç–∏–ø "text/plain" —É–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —Ç–∏–ø –æ—Ç–≤–µ—Ç–∞ - –ø—Ä–æ—Å—Ç–æ–π —Ç–µ–∫—Å—Ç.

## –°–ª–∞–π–¥ 26

### PlainTextResponse

–î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–æ—Å—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ —Ç–∞–∫–∂–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–ª–∞—Å—Å-–Ω–∞—Å–ª–µ–¥–Ω–∏–∫ PlainTextResponse:

```py
from fastapi import FastAPI
from fastapi.responses import PlainTextResponse

app = FastAPI()

@app.get("/")
def root():
    data = "Hello –ü—É—à–∫–∏–Ω.COM"
    return PlainTextResponse(content=data)
```

## –°–ª–∞–π–¥ 27

### HTMLResponse

–î–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–æ–¥–∞ HTML –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –∫–ª–∞—Å—Å HTMLResponse. –û–Ω —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ Content-Type –∑–Ω–∞—á–µ–Ω–∏–µ text/html:

```py
from fastapi import FastAPI
from fastapi.responses import HTMLResponse

app = FastAPI()

@app.get("/")
def root():
    data = "<h2>Hello –ü—É—à–∫–∏–Ω.COM</h2>"
    return HTMLResponse(content=data)
```

## –°–ª–∞–π–¥ 28

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–∏–ø–∞ –æ—Ç–≤–µ—Ç–∞ —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥—ã FastAPI

–ú–µ—Ç–æ–¥—ã FastAPI —Ç–∞–∫–∏–µ –∫–∞–∫ get(), post() –∏ —Ç.–¥. –ø–æ–∑–≤–æ–ª—è—é—Ç –∑–∞–¥–∞—Ç—å —Ç–∏–ø –æ—Ç–≤–µ—Ç–∞ —Å –ø–æ–º–æ—â—å—é –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ response_class:

```py
from fastapi import FastAPI
from fastapi.responses import PlainTextResponse, JSONResponse, HTMLResponse

app = FastAPI()

@app.get("/text", response_class=PlainTextResponse)
def root_text():
    return "Hello –ü—É—à–∫–∏–Ω.COM"

@app.get("/html", response_class=HTMLResponse)
def root_html():
    return "<h2>Hello –ü—É—à–∫–∏–Ω.COM</h2>"
```

## –°–ª–∞–π–¥ 29

### FileResponse

–ü—É—Å—Ç—å –≤ –ø—Ä–æ–µ–∫—Ç–µ –≤ –ø–∞–ø–∫–µ public –µ—Å—Ç—å —Ñ–∞–π–ª index.html —Å–æ —Å–ª–µ–¥—É—é—â–∏–º –∫–æ–¥–æ–º:

```html
<!DOCTYPE html>
<html>
<head>
    <title>–ü—É—à–∫–∏–Ω.COM</title>
    <meta charset="utf-8" />
</head>
<body>
    <h2>Hello –ü—É—à–∫–∏–Ω.COM</h2>
</body>
</html>
```

–í —Ñ–∞–π–ª–µ main.py –æ–ø—Ä–µ–¥–µ–ª–∏–º –∫–æ–¥ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ –∫–ª–∏–µ–Ω—Ç—É:

```py
from fastapi import FastAPI
from fastapi.responses import FileResponse

app = FastAPI()

@app.get("/")
def root():
    return FileResponse("public/index.html")

# –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
@app.get("/file", response_class=FileResponse)
def root_html():
    return "public/index.html"
```

## –°–ª–∞–π–¥ 30

### –û—á–µ—Ä–µ–¥–Ω–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—É—Ç–µ–π

–ü—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ —à–∞–±–ª–æ–Ω–æ–≤ –ø—É—Ç–µ–π —Å–ª–µ–¥—É–µ—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å, —á—Ç–æ –º–µ–∂–¥—É —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —à–∞–±–ª–æ–Ω–∞–º–∏ –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –¥–≤–æ–π—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å, –∫–æ–≥–¥–∞ –∑–∞–ø—Ä–æ—Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º —à–∞–±–ª–æ–Ω–∞–º. –ò –≤ —ç—Ç–æ–π —Å–≤—è–∑–∏ —Å–ª–µ–¥—É–µ—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å –æ—á–µ—Ä–µ–¥–Ω–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —à–∞–±–ª–æ–Ω–æ–≤ –ø—É—Ç–µ–π.

–ù–∞–ø—Ä–∏–º–µ—Ä:

```py
@app.get("/users/{name}")
def users(name):
    return {"user_name": name}

@app.get("/users/admin")
def admin():
    return {"message": "Hello admin"}
```

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –º—ã —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã –∑–∞–ø—Ä–æ—Å—ã –ø–æ –ø—É—Ç–∏ "/users/admin" –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∞ —Ñ—É–Ω–∫—Ü–∏—è admin(). –ê –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—É—Ç–∏ –ø–æ —à–∞–±–ª–æ–Ω—É "/users/{name}", –≥–¥–µ –≤—Ç–æ—Ä–æ–π —Å–µ–≥–º–µ–Ω—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä name, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∞ –±—ã —Ñ—É–Ω–∫—Ü–∏—è users().

–û–¥–Ω–∞–∫–æ –µ—Å–ª–∏ –º—ã –æ–±—Ä–∞—Ç–∏–º—Å—è –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é —Å –∑–∞–ø—Ä–æ—Å–æ–º http://127.0.0.1:8000/users/admin, —Ç–æ –º—ã —É–≤–∏–¥–∏–º, —á—Ç–æ –∑–∞–ø—Ä–æ—Å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è users(), –∞ –Ω–µ admin():

![1761900504278](image/lect/1761900504278.png)

–ü–æ—Ç–æ–º—É —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è users –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –¥–æ —Ñ—É–Ω–∫—Ü–∏–∏ admin, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ —Ñ—É–Ω–∫—Ü–∏—è users –∏ –±—É–¥–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å. –ß—Ç–æ–±—ã –¥–æ–±–∏—Ç—å—Å—è –Ω—É–∂–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞, –Ω–∞–º –Ω–∞–¥–æ –ø–æ–º–µ–Ω—è—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –º–µ—Å—Ç–∞–º–∏.

## –°–ª–∞–π–¥ 31

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ç–∏–ø–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

FastAPI –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ç–∏–ø –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –Ω–∞–±–æ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π. –ù–∞–ø—Ä–∏–º–µ—Ä, –º—ã —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã –ø–∞—Ä–∞–º–µ—Ç—Ä id –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–ª —Ç–æ–ª—å–∫–æ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ:

```py
@app.get("/users/{id}")
def users(id: int):
    return {"user_id": id}
```

–ß—Ç–æ–±—ã —É–∫–∞–∑–∞—Ç—å, —á—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä - —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ, —É –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Ñ—É–Ω–∫—Ü–∏–∏ —è–≤–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –∑–∞–¥–∞–µ—Ç—Å—è —Ç–∏–ø int. –ò –µ—Å–ª–∏ –º—ã –ø–æ–ø—Ä–æ–±—É–µ–º –ø–µ—Ä–µ–¥–∞—Ç—å —ç—Ç–æ–º—É –ø–∞—Ä–∞–º–µ—Ç—Ä—É –Ω–µ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, —Ç–æ —Å–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ:

![1761900594446](image/lect/1761900594446.png)

![1761900601254](image/lect/1761900601254.png)

## –°–ª–∞–π–¥ 32

### Path

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø—É—Ç–∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ FastAPI –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–ª–∞—Å—Å Path –∏–∑ –ø–∞–∫–µ—Ç–∞ fastapi. –ö–ª–∞—Å—Å Path –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä Path –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∑–Ω–∞—á–µ–Ω–∏–π:

- **min_length**: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ –≤ –∑–Ω–∞—á–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
- **max_length**: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ –≤ –∑–Ω–∞—á–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
- **pattern**: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–º—É –¥–æ–ª–∂–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
- **lt**: –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–µ–Ω—å—à–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
- **le**: –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é
- **gt**: –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–æ–ª—å—à–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
- **ge**: –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é

```py
@app.get("/users/{name}")
def users(name:str = Path(min_length=3, max_length=20)):
    return {"name": name}
```

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ø–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä name. –ü—Ä–∏—á–µ–º –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –∏–º–µ—Ç—å –Ω–µ –º–µ–Ω—å—à–µ 3 –∏ –Ω–µ –±–æ–ª—å—à–µ 20 —Å–∏–º–≤–æ–ª–æ–≤.

![1761900680765](image/lect/1761900680765.png)

![1761900690545](image/lect/1761900690545.png)

## –°–ª–∞–π–¥ 33

### –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–ü–æ–¥–æ–±–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏:

```py
@app.get("/users/{name}/{age}")
def users(name:str = Path(min_length=3, max_length=20), 
          age: int = Path(ge=18, lt=111)):
    return {"name": name, "age": age}
```

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä "age", –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å —á–∏—Å–ª–æ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 18 (–≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ) –¥–æ 111 (–Ω–µ –≤–∫–ª—é—á–∞—è).

–í–∞–ª–∏–¥–∞—Ü–∏—è —Å –ø–æ–º–æ—â—å—é —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è:

```py
@app.get("/users/{phone}")
def users(phone:str = Path(pattern=r"^\d{11}$")):
    return {"phone": phone}
```

–ó–¥–µ—Å—å –ø–∞—Ä–∞–º–µ—Ç—Ä phone –¥–æ–ª–∂–µ–Ω —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ 11 —Ü–∏—Ñ—Ä.

## –°–ª–∞–π–¥ 34

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø—Ä–æ—Å–∞

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –µ—â–µ –æ–¥–∏–Ω —Å–ø–æ—Å–æ–± –ø–µ—Ä–µ–¥–∞—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∑–∞–ø—Ä–æ—Å–µ —Ç–∏–ø–∞ GET.

–ù–∞–ø—Ä–∏–º–µ—Ä, –≤–æ–∑—å–º–µ–º —Å–ª–µ–¥—É—é—â–∏–π –∞–¥—Ä–µ—Å:

```
http://127.0.0.1:8000/users/add?name=Tom&age=38
```

–ó–¥–µ—Å—å —Ç–∞ —á–∞—Å—Ç—å, –∫–æ—Ç–æ—Ä–∞—è –∏–¥–µ—Ç –ø–æ—Å–ª–µ –∞–¥—Ä–µ—Å–∞ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –ø–æ—Ä—Ç–∞ –∏ –¥–æ –≤–æ–ø—Ä–æ—Å–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∑–Ω–∞–∫–∞ ?, —Ç–æ –µ—Å—Ç—å users/add, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø—É—Ç—å –∑–∞–ø—Ä–æ—Å–∞ (path). –ê —Ç–∞ —á–∞—Å—Ç—å, –∫–æ—Ç–æ—Ä–∞—è –∏–¥–µ—Ç –ø–æ—Å–ª–µ –≤–æ–ø—Ä–æ—Å–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∑–Ω–∞–∫–∞, —Ç–æ –µ—Å—Ç—å name=Tom&age=38, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å—Ç—Ä–æ–∫—É –∑–∞–ø—Ä–æ—Å–∞ (query string). –í –¥–∞–Ω–Ω–æ–π —Å—Ç–∞—Ç—å–µ –Ω–∞—Å –±—É–¥–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞—Ç—å –ø—Ä–µ–∂–¥–µ –≤—Å–µ–≥–æ —Å—Ç—Ä–æ–∫–∞ –∑–∞–ø—Ä–æ—Å–∞.

–°—Ç—Ä–æ–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –ö–∞–∂–¥—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤ —Ñ–æ—Ä–º–µ:

```
–∏–º—è_–ø–∞—Ä–∞–º–µ—Ç—Ä–∞=–∑–Ω–∞—á–µ–Ω–∏–µ_–ø–∞—Ä–∞–º–µ—Ç—Ä–∞
```

## –°–ª–∞–π–¥ 35

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø—Ä–æ—Å–∞

–ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, —Ç–æ –æ–Ω–∏ –æ—Ç–¥–µ–ª—è—é—Ç—Å—è –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞ –∑–Ω–∞–∫–æ–º –∞–º–ø–µ—Ä—Å–∞–Ω–¥–∞ &.

–¢–∞–∫, –≤ –ø—Ä–∏–º–µ—Ä–µ —Å –∞–¥—Ä–µ—Å–æ–º http://127.0.0.1:8000/users/add?name=Tom&age=38 —Å—Ç—Ä–æ–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: –ø–∞—Ä–∞–º–µ—Ç—Ä name –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ "Tom", –∞ –ø–∞—Ä–∞–º–µ—Ç—Ä age –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 38.

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –º—ã –º–æ–∂–µ–º –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –æ–¥–Ω–æ–∏–º–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```py
@app.get("/users")
def get_model(name, age):
    return {"user_name": name, "user_age": age}
```

![1761900845557](image/lect/1761900845557.png)

## –°–ª–∞–π–¥ 36

### –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

–í–ø–æ–ª–Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å, —á—Ç–æ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø–µ—Ä–µ–¥–∞—Å—Ç –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –∫–∞–∫–æ–≥–æ-–ª–∏–±–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –∏–ª–∏ –¥–∞–∂–µ –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø—Ä–æ—Å–∞. –í –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ —è–≤–ª—è—é—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏. –ò –µ—Å–ª–∏ –º—ã –Ω–µ –ø–µ—Ä–µ–¥–∞–¥–∏–º —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, —Ç–æ –º—ã –ø–æ–ª—É—á–∏–º –æ—à–∏–±–∫—É.

–ß—Ç–æ–±—ã –æ—à–∏–±–∫–∏ –Ω–µ –±—ã–ª–æ, –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:

```py
@app.get("/users")
def get_model(name = "Undefined", age = 18):
    return {"user_name": name, "user_age": age}
```

## –°–ª–∞–π–¥ 37

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Ç–∏–ø—É

–¢–∞–∫–∂–µ –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Ç–∏–ø—É:

```py
@app.get("/users")
def get_model(name: str, age: int = 18):
    return {"user_name": name, "user_age": age}
```

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ø–∞—Ä–∞–º–µ—Ç—Ä name –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å —Ç–∏–ø str, —Ç–æ –µ—Å—Ç—å —Å—Ç—Ä–æ–∫—É, –∞ –ø–∞—Ä–∞–º–µ—Ç—Ä age - —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ. –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—É age –ø–µ—Ä–µ–¥–∞—Ç—å –Ω–µ—á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, —Ç–æ –º—ã –ø–æ–ª—É—á–∏–º –æ—à–∏–±–∫—É.

## –°–ª–∞–π–¥ 38

### Query

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–ª–∞—Å—Å Query –∏–∑ –ø–∞–∫–µ—Ç–∞ fastapi. –ö–ª–∞—Å—Å Query –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–µ–∂–¥–µ –≤—Å–µ–≥–æ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø—Ä–æ—Å–∞. –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä Query –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∑–Ω–∞—á–µ–Ω–∏–π:

- **min_length**: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ –≤ –∑–Ω–∞—á–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
- **max_length**: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ –≤ –∑–Ω–∞—á–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
- **pattern**: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–º—É –¥–æ–ª–∂–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
- **lt**: –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–µ–Ω—å—à–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
- **le**: –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é
- **gt**: –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–æ–ª—å—à–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
- **ge**: –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é

```py
@app.get("/users")
def users(name:str = Query(min_length=3, max_length=20)):
    return {"name": name}
```

![1761900964176](image/lect/1761900964176.png)

![1761900977617](image/lect/1761900977617.png)

## –°–ª–∞–π–¥ 39

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ Query

–ü–æ–¥–æ–±–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏:

```py
@app.get("/users")
def users(name:str = Query(min_length=3, max_length=20), 
          age: int = Query(ge=18, lt=111)):
    return {"name": name, "age": age}
```

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä "age", –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å —á–∏—Å–ª–æ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 18 (–≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ) –¥–æ 111 (–Ω–µ –≤–∫–ª—é—á–∞—è).

–í–∞–ª–∏–¥–∞—Ü–∏—è —Å –ø–æ–º–æ—â—å—é —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è:

```py
@app.get("/users")
def users(phone:str = Query(pattern=r"^\d{11}$")):
    return {"phone": phone}
```

–ó–¥–µ—Å—å –ø–∞—Ä–∞–º–µ—Ç—Ä phone –¥–æ–ª–∂–µ–Ω —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ 11 —Ü–∏—Ñ—Ä.

Query –ø–æ–∑–≤–æ–ª—è–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å –ø–æ–º–æ—â—å—é –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ default:

```py
@app.get("/users")
def users(name: str = Query(default="Undefined", min_length=2)):
    return {"name": name}
```

–ó–¥–µ—Å—å, –µ—Å–ª–∏ –≤ –∑–∞–ø—Ä–æ—à–µ–Ω–Ω–æ–º –∞–¥—Ä–µ—Å–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä name, —Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ–Ω –±—É–¥–µ—Ç —Ä–∞–≤–µ–Ω —Å—Ç—Ä–æ–∫–µ "Undefined".

–ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏, —Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—É default –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ None:

```py
@app.get("/users")
def users(name:str | None = Query(default=None, min_length=2)):
    if name == None:
        return {"name": "Undefined"}
    else:
        return {"name": name}
```

## –°–ª–∞–π–¥ 40

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤ –∑–Ω–∞—á–µ–Ω–∏–π

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞ Query –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å —á–µ—Ä–µ–∑ —Å—Ç—Ä–æ–∫—É –∑–∞–ø—Ä–æ—Å–∞ —Å–ø–∏—Å–∫–∏. –í –æ–±—â–µ–º —Å–ª—É—á–∞–µ —Å–ø–∏—Å–∫–∏ –∑–Ω–∞—á–µ–Ω–∏–π –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è, –∫–æ–≥–¥–∞ –≤ —Å—Ç—Ä–æ–∫–µ –∑–∞–ø—Ä–æ—Å–∞ –æ–¥–Ω–æ–º—É –ø–∞—Ä–∞–º–µ—Ç—Ä—É –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Ä–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.

–ù–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∫ –≤ –∑–∞–ø—Ä–æ—Å–µ –ø–æ —Å–ª–µ–¥—É—é—â–µ–º—É –∞–¥—Ä–µ—Å—É:

```
http://127.0.0.1:8000/users?people=tom&people=Sam&people=Bob
```

–ó–¥–µ—Å—å –ø–∞—Ä–∞–º–µ—Ç—Ä—É people –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Ç—Ä–∏ —Ä–∞–∑–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –º—ã –æ–∂–∏–¥–∞–µ–º, —á—Ç–æ —Å–ø–∏—Å–æ–∫ people –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç—Ä–∏ —ç–ª–µ–º–µ–Ω—Ç–∞.

–û–ø—Ä–µ–¥–µ–ª–∏–º —Å–ª–µ–¥—É—é—â–µ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

```py
@app.get("/users")
def users(people: list[str] = Query()):
    return {"people": people}
```

–ó–¥–µ—Å—å —Ñ—É–Ω–∫—Ü–∏—è users –∏–º–µ–µ—Ç –æ–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä - people, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–æ–∫ - —Ç–∏–ø list[str].

–ü–µ—Ä–µ–¥–∞–¥–∏–º —á–µ—Ä–µ–∑ —Å—Ç—Ä–æ–∫—É –∑–∞–ø—Ä–æ—Å–∞ —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π –≤ –≤–∏–¥–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ people, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å –ø–æ–º–æ—â—å—é –∑–∞–ø—Ä–æ—Å–∞ http://127.0.0.1:8000/users?people=tom&people=Sam:

![1761901138470](image/lect/1761901138470.png)

## –°–ª–∞–π–¥ 41

### –°–æ—á–µ—Ç–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø—É—Ç–∏ –∏ —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø—Ä–æ—Å–∞

```py
@app.get("/users/{name}")
def users(name:str = Path(min_length=3, max_length=20), 
          age: int = Query(ge=18, lt=111)):
    return {"name": name, "age": age}
```

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ø–∞—Ä–∞–º–µ—Ç—Ä name –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –ø—É—Ç–∏, –∞ age - –ø–∞—Ä–∞–º–µ—Ç—Ä —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø—Ä–æ—Å–∞. –ò –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –º—ã –º–æ–≥–ª–∏ –±—ã –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ —Ñ—É–Ω–∫—Ü–∏–∏ users, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º –∞–¥—Ä–µ—Å–∞ http://127.0.0.1:8000/users/Tom?age=38

## –°–ª–∞–π–¥ 42

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–Ω–æ–≥–æ –∫–æ–¥–∞ –≤ –æ—Ç–≤–µ—Ç–µ

```py
@app.get("/notfound")
def notfound():
    return JSONResponse(content={"message": "Resource Not Found"}, status_code=404)
```

–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–Ω–æ–≥–æ –∫–æ–¥–∞:

```py
@app.get("/users/{id}", status_code=200)
def users(response: Response, id: int = Path()):
    if id < 1:
        response.status_code = 400
        return {"message": "Incorrect Data"}
    return {"message": f"Id = {id}"}
```

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –µ—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä –ø—É—Ç–∏ –º–µ–Ω—å—à–µ 1, —Ç–æ —É—Å–ª–æ–≤–Ω–æ —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ –ø–µ—Ä–µ–¥–∞–Ω—ã –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ –æ—Ç–≤–µ—Ç —Å—Ç–∞—Ç—É—Å–Ω—ã–π –∫–æ–¥ 400 (Bad Request).
